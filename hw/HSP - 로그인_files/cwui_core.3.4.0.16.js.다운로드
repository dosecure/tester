!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cwui_core=t():e.cwui_core=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist",t(t.s=126)}({0:function(e,t,r){var n,o;/*!
 * jQuery JavaScript Library v3.3.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2018-01-20T17:24Z
 */
!function(t,r){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?r(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return r(e)}:r(t)}("undefined"!=typeof window?window:this,function(r,i){"use strict";function a(e,t,r){t=t||fe;var n,o=t.createElement("script");if(o.text=e,r)for(n in he)r[n]&&(o[n]=r[n]);t.head.appendChild(o).parentNode.removeChild(o)}function s(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?pe[_e.call(e)]||"object":typeof e}function c(e){var t=!!e&&"length"in e&&e.length,r=s(e);return!Te(e)&&!Se(e)&&("array"===r||0===t||"number"==typeof t&&t>0&&t-1 in e)}function u(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function f(e,t,r){return Te(t)?Pe.grep(e,function(e,n){return!!t.call(e,n,e)!==r}):t.nodeType?Pe.grep(e,function(e){return e===t!==r}):"string"!=typeof t?Pe.grep(e,function(e){return Ie.call(t,e)>-1!==r}):Pe.filter(t,e,r)}function l(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function d(e){var t={};return Pe.each(e.match(Fe)||[],function(e,r){t[r]=!0}),t}function E(e){return e}function g(e){throw e}function I(e,t,r,n){var o;try{e&&Te(o=e.promise)?o.call(e).done(t).fail(r):e&&Te(o=e.then)?o.call(e,t,r):t.apply(void 0,[e].slice(n))}catch(e){r.apply(void 0,[e])}}function p(){fe.removeEventListener("DOMContentLoaded",p),r.removeEventListener("load",p),Pe.ready()}function _(e,t){return t.toUpperCase()}function C(e){return e.replace(Ge,"ms-").replace(Ye,_)}function v(){this.expando=Pe.expando+v.uid++}function R(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Ve.test(e)?JSON.parse(e):e)}function m(e,t,r){var n;if(void 0===r&&1===e.nodeType)if(n="data-"+t.replace(qe,"-$&").toLowerCase(),"string"==typeof(r=e.getAttribute(n))){try{r=R(r)}catch(e){}He.set(e,t,r)}else r=void 0;return r}function T(e,t,r,n){var o,i,a=20,s=n?function(){return n.cur()}:function(){return Pe.css(e,t,"")},c=s(),u=r&&r[3]||(Pe.cssNumber[t]?"":"px"),f=(Pe.cssNumber[t]||"px"!==u&&+c)&&Xe.exec(Pe.css(e,t));if(f&&f[3]!==u){for(c/=2,u=u||f[3],f=+c||1;a--;)Pe.style(e,t,f+u),(1-i)*(1-(i=s()/c||.5))<=0&&(a=0),f/=i;f*=2,Pe.style(e,t,f+u),r=r||[]}return r&&(f=+f||+c||0,o=r[1]?f+(r[1]+1)*r[2]:+r[2],n&&(n.unit=u,n.start=f,n.end=o)),o}function S(e){var t,r=e.ownerDocument,n=e.nodeName,o=Qe[n];return o||(t=r.body.appendChild(r.createElement(n)),o=Pe.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),Qe[n]=o,o)}function h(e,t){for(var r,n,o=[],i=0,a=e.length;i<a;i++)n=e[i],n.style&&(r=n.style.display,t?("none"===r&&(o[i]=Be.get(n,"display")||null,o[i]||(n.style.display="")),""===n.style.display&&Je(n)&&(o[i]=S(n))):"none"!==r&&(o[i]="none",Be.set(n,"display",r)));for(i=0;i<a;i++)null!=o[i]&&(e[i].style.display=o[i]);return e}function P(e,t){var r;return r=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&u(e,t)?Pe.merge([e],r):r}function N(e,t){for(var r=0,n=e.length;r<n;r++)Be.set(e[r],"globalEval",!t||Be.get(t[r],"globalEval"))}function y(e,t,r,n,o){for(var i,a,c,u,f,l,d=t.createDocumentFragment(),E=[],g=0,I=e.length;g<I;g++)if((i=e[g])||0===i)if("object"===s(i))Pe.merge(E,i.nodeType?[i]:i);else if(nt.test(i)){for(a=a||d.appendChild(t.createElement("div")),c=(et.exec(i)||["",""])[1].toLowerCase(),u=rt[c]||rt._default,a.innerHTML=u[1]+Pe.htmlPrefilter(i)+u[2],l=u[0];l--;)a=a.lastChild;Pe.merge(E,a.childNodes),a=d.firstChild,a.textContent=""}else E.push(t.createTextNode(i));for(d.textContent="",g=0;i=E[g++];)if(n&&Pe.inArray(i,n)>-1)o&&o.push(i);else if(f=Pe.contains(i.ownerDocument,i),a=P(d.appendChild(i),"script"),f&&N(a),r)for(l=0;i=a[l++];)tt.test(i.type||"")&&r.push(i);return d}function A(){return!0}function O(){return!1}function b(){try{return fe.activeElement}catch(e){}}function D(e,t,r,n,o,i){var a,s;if("object"==typeof t){"string"!=typeof r&&(n=n||r,r=void 0);for(s in t)D(e,s,r,n,t[s],i);return e}if(null==n&&null==o?(o=r,n=r=void 0):null==o&&("string"==typeof r?(o=n,n=void 0):(o=n,n=r,r=void 0)),!1===o)o=O;else if(!o)return e;return 1===i&&(a=o,o=function(e){return Pe().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=Pe.guid++)),e.each(function(){Pe.event.add(this,t,o,n,r)})}function U(e,t){return u(e,"table")&&u(11!==t.nodeType?t:t.firstChild,"tr")?Pe(e).children("tbody")[0]||e:e}function L(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function w(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function x(e,t){var r,n,o,i,a,s,c,u;if(1===t.nodeType){if(Be.hasData(e)&&(i=Be.access(e),a=Be.set(t,i),u=i.events)){delete a.handle,a.events={};for(o in u)for(r=0,n=u[o].length;r<n;r++)Pe.event.add(t,o,u[o][r])}He.hasData(e)&&(s=He.access(e),c=Pe.extend({},s),He.set(t,c))}}function F(e,t){var r=t.nodeName.toLowerCase();"input"===r&&Ze.test(e.type)?t.checked=e.checked:"input"!==r&&"textarea"!==r||(t.defaultValue=e.defaultValue)}function k(e,t,r,n){t=Ee.apply([],t);var o,i,s,c,u,f,l=0,d=e.length,E=d-1,g=t[0],I=Te(g);if(I||d>1&&"string"==typeof g&&!me.checkClone&&ft.test(g))return e.each(function(o){var i=e.eq(o);I&&(t[0]=g.call(this,o,i.html())),k(i,t,r,n)});if(d&&(o=y(t,e[0].ownerDocument,!1,e,n),i=o.firstChild,1===o.childNodes.length&&(o=i),i||n)){for(s=Pe.map(P(o,"script"),L),c=s.length;l<d;l++)u=o,l!==E&&(u=Pe.clone(u,!0,!0),c&&Pe.merge(s,P(u,"script"))),r.call(e[l],u,l);if(c)for(f=s[s.length-1].ownerDocument,Pe.map(s,w),l=0;l<c;l++)u=s[l],tt.test(u.type||"")&&!Be.access(u,"globalEval")&&Pe.contains(f,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?Pe._evalUrl&&Pe._evalUrl(u.src):a(u.textContent.replace(lt,""),f,u))}return e}function M(e,t,r){for(var n,o=t?Pe.filter(t,e):e,i=0;null!=(n=o[i]);i++)r||1!==n.nodeType||Pe.cleanData(P(n)),n.parentNode&&(r&&Pe.contains(n.ownerDocument,n)&&N(P(n,"script")),n.parentNode.removeChild(n));return e}function K(e,t,r){var n,o,i,a,s=e.style;return r=r||Et(e),r&&(a=r.getPropertyValue(t)||r[t],""!==a||Pe.contains(e.ownerDocument,e)||(a=Pe.style(e,t)),!me.pixelBoxStyles()&&dt.test(a)&&gt.test(t)&&(n=s.width,o=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=r.width,s.width=n,s.minWidth=o,s.maxWidth=i)),void 0!==a?a+"":a}function G(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function Y(e){if(e in Rt)return e;for(var t=e[0].toUpperCase()+e.slice(1),r=vt.length;r--;)if((e=vt[r]+t)in Rt)return e}function W(e){var t=Pe.cssProps[e];return t||(t=Pe.cssProps[e]=Y(e)||e),t}function B(e,t,r){var n=Xe.exec(t);return n?Math.max(0,n[2]-(r||0))+(n[3]||"px"):t}function H(e,t,r,n,o,i){var a="width"===t?1:0,s=0,c=0;if(r===(n?"border":"content"))return 0;for(;a<4;a+=2)"margin"===r&&(c+=Pe.css(e,r+$e[a],!0,o)),n?("content"===r&&(c-=Pe.css(e,"padding"+$e[a],!0,o)),"margin"!==r&&(c-=Pe.css(e,"border"+$e[a]+"Width",!0,o))):(c+=Pe.css(e,"padding"+$e[a],!0,o),"padding"!==r?c+=Pe.css(e,"border"+$e[a]+"Width",!0,o):s+=Pe.css(e,"border"+$e[a]+"Width",!0,o));return!n&&i>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-i-c-s-.5))),c}function V(e,t,r){var n=Et(e),o=K(e,t,n),i="border-box"===Pe.css(e,"boxSizing",!1,n),a=i;if(dt.test(o)){if(!r)return o;o="auto"}return a=a&&(me.boxSizingReliable()||o===e.style[t]),("auto"===o||!parseFloat(o)&&"inline"===Pe.css(e,"display",!1,n))&&(o=e["offset"+t[0].toUpperCase()+t.slice(1)],a=!0),(o=parseFloat(o)||0)+H(e,t,r||(i?"border":"content"),a,n,o)+"px"}function q(e,t,r,n,o){return new q.prototype.init(e,t,r,n,o)}function j(){Tt&&(!1===fe.hidden&&r.requestAnimationFrame?r.requestAnimationFrame(j):r.setTimeout(j,Pe.fx.interval),Pe.fx.tick())}function X(){return r.setTimeout(function(){mt=void 0}),mt=Date.now()}function $(e,t){var r,n=0,o={height:e};for(t=t?1:0;n<4;n+=2-t)r=$e[n],o["margin"+r]=o["padding"+r]=e;return t&&(o.opacity=o.width=e),o}function J(e,t,r){for(var n,o=(Z.tweeners[t]||[]).concat(Z.tweeners["*"]),i=0,a=o.length;i<a;i++)if(n=o[i].call(r,t,e))return n}function z(e,t,r){var n,o,i,a,s,c,u,f,l="width"in t||"height"in t,d=this,E={},g=e.style,I=e.nodeType&&Je(e),p=Be.get(e,"fxshow");r.queue||(a=Pe._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,Pe.queue(e,"fx").length||a.empty.fire()})}));for(n in t)if(o=t[n],St.test(o)){if(delete t[n],i=i||"toggle"===o,o===(I?"hide":"show")){if("show"!==o||!p||void 0===p[n])continue;I=!0}E[n]=p&&p[n]||Pe.style(e,n)}if((c=!Pe.isEmptyObject(t))||!Pe.isEmptyObject(E)){l&&1===e.nodeType&&(r.overflow=[g.overflow,g.overflowX,g.overflowY],u=p&&p.display,null==u&&(u=Be.get(e,"display")),f=Pe.css(e,"display"),"none"===f&&(u?f=u:(h([e],!0),u=e.style.display||u,f=Pe.css(e,"display"),h([e]))),("inline"===f||"inline-block"===f&&null!=u)&&"none"===Pe.css(e,"float")&&(c||(d.done(function(){g.display=u}),null==u&&(f=g.display,u="none"===f?"":f)),g.display="inline-block")),r.overflow&&(g.overflow="hidden",d.always(function(){g.overflow=r.overflow[0],g.overflowX=r.overflow[1],g.overflowY=r.overflow[2]})),c=!1;for(n in E)c||(p?"hidden"in p&&(I=p.hidden):p=Be.access(e,"fxshow",{display:u}),i&&(p.hidden=!I),I&&h([e],!0),d.done(function(){I||h([e]),Be.remove(e,"fxshow");for(n in E)Pe.style(e,n,E[n])})),c=J(I?p[n]:0,n,d),n in p||(p[n]=c.start,I&&(c.end=c.start,c.start=0))}}function Q(e,t){var r,n,o,i,a;for(r in e)if(n=C(r),o=t[n],i=e[r],Array.isArray(i)&&(o=i[1],i=e[r]=i[0]),r!==n&&(e[n]=i,delete e[r]),(a=Pe.cssHooks[n])&&"expand"in a){i=a.expand(i),delete e[n];for(r in i)r in e||(e[r]=i[r],t[r]=o)}else t[n]=o}function Z(e,t,r){var n,o,i=0,a=Z.prefilters.length,s=Pe.Deferred().always(function(){delete c.elem}),c=function(){if(o)return!1;for(var t=mt||X(),r=Math.max(0,u.startTime+u.duration-t),n=r/u.duration||0,i=1-n,a=0,c=u.tweens.length;a<c;a++)u.tweens[a].run(i);return s.notifyWith(e,[u,i,r]),i<1&&c?r:(c||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:Pe.extend({},t),opts:Pe.extend(!0,{specialEasing:{},easing:Pe.easing._default},r),originalProperties:t,originalOptions:r,startTime:mt||X(),duration:r.duration,tweens:[],createTween:function(t,r){var n=Pe.Tween(e,u.opts,t,r,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(n),n},stop:function(t){var r=0,n=t?u.tweens.length:0;if(o)return this;for(o=!0;r<n;r++)u.tweens[r].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),f=u.props;for(Q(f,u.opts.specialEasing);i<a;i++)if(n=Z.prefilters[i].call(u,e,f,u.opts))return Te(n.stop)&&(Pe._queueHooks(u.elem,u.opts.queue).stop=n.stop.bind(n)),n;return Pe.map(f,J,u),Te(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),Pe.fx.timer(Pe.extend(c,{elem:e,anim:u,queue:u.opts.queue})),u}function ee(e){return(e.match(Fe)||[]).join(" ")}function te(e){return e.getAttribute&&e.getAttribute("class")||""}function re(e){return Array.isArray(e)?e:"string"==typeof e?e.match(Fe)||[]:[]}function ne(e,t,r,n){var o;if(Array.isArray(t))Pe.each(t,function(t,o){r||xt.test(e)?n(e,o):ne(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,r,n)});else if(r||"object"!==s(t))n(e,t);else for(o in t)ne(e+"["+o+"]",t[o],r,n)}function oe(e){return function(t,r){"string"!=typeof t&&(r=t,t="*");var n,o=0,i=t.toLowerCase().match(Fe)||[];if(Te(r))for(;n=i[o++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(r)):(e[n]=e[n]||[]).push(r)}}function ie(e,t,r,n){function o(s){var c;return i[s]=!0,Pe.each(e[s]||[],function(e,s){var u=s(t,r,n);return"string"!=typeof u||a||i[u]?a?!(c=u):void 0:(t.dataTypes.unshift(u),o(u),!1)}),c}var i={},a=e===jt;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ae(e,t){var r,n,o=Pe.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((o[r]?e:n||(n={}))[r]=t[r]);return n&&Pe.extend(!0,e,n),e}function se(e,t,r){for(var n,o,i,a,s=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(o in s)if(s[o]&&s[o].test(n)){c.unshift(o);break}if(c[0]in r)i=c[0];else{for(o in r){if(!c[0]||e.converters[o+" "+c[0]]){i=o;break}a||(a=o)}i=i||a}if(i)return i!==c[0]&&c.unshift(i),r[i]}function ce(e,t,r,n){var o,i,a,s,c,u={},f=e.dataTypes.slice();if(f[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];for(i=f.shift();i;)if(e.responseFields[i]&&(r[e.responseFields[i]]=t),!c&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=i,i=f.shift())if("*"===i)i=c;else if("*"!==c&&c!==i){if(!(a=u[c+" "+i]||u["* "+i]))for(o in u)if(s=o.split(" "),s[1]===i&&(a=u[c+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[o]:!0!==u[o]&&(i=s[0],f.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+c+" to "+i}}}return{state:"success",data:t}}var ue=[],fe=r.document,le=Object.getPrototypeOf,de=ue.slice,Ee=ue.concat,ge=ue.push,Ie=ue.indexOf,pe={},_e=pe.toString,Ce=pe.hasOwnProperty,ve=Ce.toString,Re=ve.call(Object),me={},Te=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},Se=function(e){return null!=e&&e===e.window},he={type:!0,src:!0,noModule:!0},Pe=function(e,t){return new Pe.fn.init(e,t)},Ne=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;Pe.fn=Pe.prototype={jquery:"3.3.1",constructor:Pe,length:0,toArray:function(){return de.call(this)},get:function(e){return null==e?de.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=Pe.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return Pe.each(this,e)},map:function(e){return this.pushStack(Pe.map(this,function(t,r){return e.call(t,r,t)}))},slice:function(){return this.pushStack(de.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(r>=0&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:ge,sort:ue.sort,splice:ue.splice},Pe.extend=Pe.fn.extend=function(){var e,t,r,n,o,i,a=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||Te(a)||(a={}),s===c&&(a=this,s--);s<c;s++)if(null!=(e=arguments[s]))for(t in e)r=a[t],n=e[t],a!==n&&(u&&n&&(Pe.isPlainObject(n)||(o=Array.isArray(n)))?(o?(o=!1,i=r&&Array.isArray(r)?r:[]):i=r&&Pe.isPlainObject(r)?r:{},a[t]=Pe.extend(u,i,n)):void 0!==n&&(a[t]=n));return a},Pe.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,r;return!(!e||"[object Object]"!==_e.call(e))&&(!(t=le(e))||"function"==typeof(r=Ce.call(t,"constructor")&&t.constructor)&&ve.call(r)===Re)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){a(e)},each:function(e,t){var r,n=0;if(c(e))for(r=e.length;n<r&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(Ne,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(c(Object(e))?Pe.merge(r,"string"==typeof e?[e]:e):ge.call(r,e)),r},inArray:function(e,t,r){return null==t?-1:Ie.call(t,e,r)},merge:function(e,t){for(var r=+t.length,n=0,o=e.length;n<r;n++)e[o++]=t[n];return e.length=o,e},grep:function(e,t,r){for(var n=[],o=0,i=e.length,a=!r;o<i;o++)!t(e[o],o)!==a&&n.push(e[o]);return n},map:function(e,t,r){var n,o,i=0,a=[];if(c(e))for(n=e.length;i<n;i++)null!=(o=t(e[i],i,r))&&a.push(o);else for(i in e)null!=(o=t(e[i],i,r))&&a.push(o);return Ee.apply([],a)},guid:1,support:me}),"function"==typeof Symbol&&(Pe.fn[Symbol.iterator]=ue[Symbol.iterator]),Pe.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){pe["[object "+t+"]"]=t.toLowerCase()});var ye=/*!
 * Sizzle CSS Selector Engine v2.3.3
 * https://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-08-08
 */
function(e){function t(e,t,r,n){var o,i,a,s,c,f,d,E=t&&t.ownerDocument,g=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==g&&9!==g&&11!==g)return r;if(!n&&((t?t.ownerDocument||t:K)!==D&&b(t),t=t||D,L)){if(11!==g&&(c=Ie.exec(e)))if(o=c[1]){if(9===g){if(!(a=t.getElementById(o)))return r;if(a.id===o)return r.push(a),r}else if(E&&(a=E.getElementById(o))&&k(t,a)&&a.id===o)return r.push(a),r}else{if(c[2])return J.apply(r,t.getElementsByTagName(e)),r;if((o=c[3])&&R.getElementsByClassName&&t.getElementsByClassName)return J.apply(r,t.getElementsByClassName(o)),r}if(R.qsa&&!H[e+" "]&&(!w||!w.test(e))){if(1!==g)E=t,d=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(ve,Re):t.setAttribute("id",s=M),f=h(e),i=f.length;i--;)f[i]="#"+s+" "+l(f[i]);d=f.join(","),E=pe.test(e)&&u(t.parentNode)||t}if(d)try{return J.apply(r,E.querySelectorAll(d)),r}catch(e){}finally{s===M&&t.removeAttribute("id")}}}return N(e.replace(ie,"$1"),t,r,n)}function r(){function e(r,n){return t.push(r+" ")>m.cacheLength&&delete e[t.shift()],e[r+" "]=n}var t=[];return e}function n(e){return e[M]=!0,e}function o(e){var t=D.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function i(e,t){for(var r=e.split("|"),n=r.length;n--;)m.attrHandle[r[n]]=t}function a(e,t){var r=t&&e,n=r&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(r)for(;r=r.nextSibling;)if(r===t)return-1;return e?1:-1}function s(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Te(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function c(e){return n(function(t){return t=+t,n(function(r,n){for(var o,i=e([],r.length,t),a=i.length;a--;)r[o=i[a]]&&(r[o]=!(n[o]=r[o]))})})}function u(e){return e&&void 0!==e.getElementsByTagName&&e}function f(){}function l(e){for(var t=0,r=e.length,n="";t<r;t++)n+=e[t].value;return n}function d(e,t,r){var n=t.dir,o=t.next,i=o||n,a=r&&"parentNode"===i,s=Y++;return t.first?function(t,r,o){for(;t=t[n];)if(1===t.nodeType||a)return e(t,r,o);return!1}:function(t,r,c){var u,f,l,d=[G,s];if(c){for(;t=t[n];)if((1===t.nodeType||a)&&e(t,r,c))return!0}else for(;t=t[n];)if(1===t.nodeType||a)if(l=t[M]||(t[M]={}),f=l[t.uniqueID]||(l[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[n]||t;else{if((u=f[i])&&u[0]===G&&u[1]===s)return d[2]=u[2];if(f[i]=d,d[2]=e(t,r,c))return!0}return!1}}function E(e){return e.length>1?function(t,r,n){for(var o=e.length;o--;)if(!e[o](t,r,n))return!1;return!0}:e[0]}function g(e,r,n){for(var o=0,i=r.length;o<i;o++)t(e,r[o],n);return n}function I(e,t,r,n,o){for(var i,a=[],s=0,c=e.length,u=null!=t;s<c;s++)(i=e[s])&&(r&&!r(i,n,o)||(a.push(i),u&&t.push(s)));return a}function p(e,t,r,o,i,a){return o&&!o[M]&&(o=p(o)),i&&!i[M]&&(i=p(i,a)),n(function(n,a,s,c){var u,f,l,d=[],E=[],p=a.length,_=n||g(t||"*",s.nodeType?[s]:s,[]),C=!e||!n&&t?_:I(_,d,e,s,c),v=r?i||(n?e:p||o)?[]:a:C;if(r&&r(C,v,s,c),o)for(u=I(v,E),o(u,[],s,c),f=u.length;f--;)(l=u[f])&&(v[E[f]]=!(C[E[f]]=l));if(n){if(i||e){if(i){for(u=[],f=v.length;f--;)(l=v[f])&&u.push(C[f]=l);i(null,v=[],u,c)}for(f=v.length;f--;)(l=v[f])&&(u=i?Q(n,l):d[f])>-1&&(n[u]=!(a[u]=l))}}else v=I(v===a?v.splice(p,v.length):v),i?i(null,a,v,c):J.apply(a,v)})}function _(e){for(var t,r,n,o=e.length,i=m.relative[e[0].type],a=i||m.relative[" "],s=i?1:0,c=d(function(e){return e===t},a,!0),u=d(function(e){return Q(t,e)>-1},a,!0),f=[function(e,r,n){var o=!i&&(n||r!==y)||((t=r).nodeType?c(e,r,n):u(e,r,n));return t=null,o}];s<o;s++)if(r=m.relative[e[s].type])f=[d(E(f),r)];else{if(r=m.filter[e[s].type].apply(null,e[s].matches),r[M]){for(n=++s;n<o&&!m.relative[e[n].type];n++);return p(s>1&&E(f),s>1&&l(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ie,"$1"),r,s<n&&_(e.slice(s,n)),n<o&&_(e=e.slice(n)),n<o&&l(e))}f.push(r)}return E(f)}function C(e,r){var o=r.length>0,i=e.length>0,a=function(n,a,s,c,u){var f,l,d,E=0,g="0",p=n&&[],_=[],C=y,v=n||i&&m.find.TAG("*",u),R=G+=null==C?1:Math.random()||.1,T=v.length;for(u&&(y=a===D||a||u);g!==T&&null!=(f=v[g]);g++){if(i&&f){for(l=0,a||f.ownerDocument===D||(b(f),s=!L);d=e[l++];)if(d(f,a||D,s)){c.push(f);break}u&&(G=R)}o&&((f=!d&&f)&&E--,n&&p.push(f))}if(E+=g,o&&g!==E){for(l=0;d=r[l++];)d(p,_,a,s);if(n){if(E>0)for(;g--;)p[g]||_[g]||(_[g]=X.call(c));_=I(_)}J.apply(c,_),u&&!n&&_.length>0&&E+r.length>1&&t.uniqueSort(c)}return u&&(G=R,y=C),p};return o?n(a):a}var v,R,m,T,S,h,P,N,y,A,O,b,D,U,L,w,x,F,k,M="sizzle"+1*new Date,K=e.document,G=0,Y=0,W=r(),B=r(),H=r(),V=function(e,t){return e===t&&(O=!0),0},q={}.hasOwnProperty,j=[],X=j.pop,$=j.push,J=j.push,z=j.slice,Q=function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1},Z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",re="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+te+"))|)"+ee+"*\\]",ne=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",oe=new RegExp(ee+"+","g"),ie=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),ae=new RegExp("^"+ee+"*,"+ee+"*"),se=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),ce=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),ue=new RegExp(ne),fe=new RegExp("^"+te+"$"),le={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te+"|[*])"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+ne),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+Z+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},de=/^(?:input|select|textarea|button)$/i,Ee=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,Ie=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,pe=/[+~]/,_e=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),Ce=function(e,t,r){var n="0x"+t-65536;return n!==n||r?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ve=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Re=function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},me=function(){b()},Te=d(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{J.apply(j=z.call(K.childNodes),K.childNodes),j[K.childNodes.length].nodeType}catch(e){J={apply:j.length?function(e,t){$.apply(e,z.call(t))}:function(e,t){for(var r=e.length,n=0;e[r++]=t[n++];);e.length=r-1}}}R=t.support={},S=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},b=t.setDocument=function(e){var t,r,n=e?e.ownerDocument||e:K;return n!==D&&9===n.nodeType&&n.documentElement?(D=n,U=D.documentElement,L=!S(D),K!==D&&(r=D.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",me,!1):r.attachEvent&&r.attachEvent("onunload",me)),R.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),R.getElementsByTagName=o(function(e){return e.appendChild(D.createComment("")),!e.getElementsByTagName("*").length}),R.getElementsByClassName=ge.test(D.getElementsByClassName),R.getById=o(function(e){return U.appendChild(e).id=M,!D.getElementsByName||!D.getElementsByName(M).length}),R.getById?(m.filter.ID=function(e){var t=e.replace(_e,Ce);return function(e){return e.getAttribute("id")===t}},m.find.ID=function(e,t){if(void 0!==t.getElementById&&L){var r=t.getElementById(e);return r?[r]:[]}}):(m.filter.ID=function(e){var t=e.replace(_e,Ce);return function(e){var r=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return r&&r.value===t}},m.find.ID=function(e,t){if(void 0!==t.getElementById&&L){var r,n,o,i=t.getElementById(e);if(i){if((r=i.getAttributeNode("id"))&&r.value===e)return[i];for(o=t.getElementsByName(e),n=0;i=o[n++];)if((r=i.getAttributeNode("id"))&&r.value===e)return[i]}return[]}}),m.find.TAG=R.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):R.qsa?t.querySelectorAll(e):void 0}:function(e,t){var r,n=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;r=i[o++];)1===r.nodeType&&n.push(r);return n}return i},m.find.CLASS=R.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&L)return t.getElementsByClassName(e)},x=[],w=[],(R.qsa=ge.test(D.querySelectorAll))&&(o(function(e){U.appendChild(e).innerHTML="<a id='"+M+"'></a><select id='"+M+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&w.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||w.push("\\["+ee+"*(?:value|"+Z+")"),e.querySelectorAll("[id~="+M+"-]").length||w.push("~="),e.querySelectorAll(":checked").length||w.push(":checked"),e.querySelectorAll("a#"+M+"+*").length||w.push(".#.+[+~]")}),o(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=D.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&w.push("name"+ee+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&w.push(":enabled",":disabled"),U.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&w.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),w.push(",.*:")})),(R.matchesSelector=ge.test(F=U.matches||U.webkitMatchesSelector||U.mozMatchesSelector||U.oMatchesSelector||U.msMatchesSelector))&&o(function(e){R.disconnectedMatch=F.call(e,"*"),F.call(e,"[s!='']:x"),x.push("!=",ne)}),w=w.length&&new RegExp(w.join("|")),x=x.length&&new RegExp(x.join("|")),t=ge.test(U.compareDocumentPosition),k=t||ge.test(U.contains)?function(e,t){var r=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(r.contains?r.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return O=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&r||!R.sortDetached&&t.compareDocumentPosition(e)===r?e===D||e.ownerDocument===K&&k(K,e)?-1:t===D||t.ownerDocument===K&&k(K,t)?1:A?Q(A,e)-Q(A,t):0:4&r?-1:1)}:function(e,t){if(e===t)return O=!0,0;var r,n=0,o=e.parentNode,i=t.parentNode,s=[e],c=[t];if(!o||!i)return e===D?-1:t===D?1:o?-1:i?1:A?Q(A,e)-Q(A,t):0;if(o===i)return a(e,t);for(r=e;r=r.parentNode;)s.unshift(r);for(r=t;r=r.parentNode;)c.unshift(r);for(;s[n]===c[n];)n++;return n?a(s[n],c[n]):s[n]===K?-1:c[n]===K?1:0},D):D},t.matches=function(e,r){return t(e,null,null,r)},t.matchesSelector=function(e,r){if((e.ownerDocument||e)!==D&&b(e),r=r.replace(ce,"='$1']"),R.matchesSelector&&L&&!H[r+" "]&&(!x||!x.test(r))&&(!w||!w.test(r)))try{var n=F.call(e,r);if(n||R.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return t(r,D,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==D&&b(e),k(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==D&&b(e);var r=m.attrHandle[t.toLowerCase()],n=r&&q.call(m.attrHandle,t.toLowerCase())?r(e,t,!L):void 0;return void 0!==n?n:R.attributes||!L?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.escape=function(e){return(e+"").replace(ve,Re)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,r=[],n=0,o=0;if(O=!R.detectDuplicates,A=!R.sortStable&&e.slice(0),e.sort(V),O){for(;t=e[o++];)t===e[o]&&(n=r.push(o));for(;n--;)e.splice(r[n],1)}return A=null,e},T=t.getText=function(e){var t,r="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=T(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)r+=T(t);return r},m=t.selectors={cacheLength:50,createPseudo:n,match:le,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_e,Ce),e[3]=(e[3]||e[4]||e[5]||"").replace(_e,Ce),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,r=!e[6]&&e[2];return le.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":r&&ue.test(r)&&(t=h(r,!0))&&(t=r.indexOf(")",r.length-t)-r.length)&&(e[0]=e[0].slice(0,t),e[2]=r.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_e,Ce).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=W[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&W(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,r,n){return function(o){var i=t.attr(o,e);return null==i?"!="===r:!r||(i+="","="===r?i===n:"!="===r?i!==n:"^="===r?n&&0===i.indexOf(n):"*="===r?n&&i.indexOf(n)>-1:"$="===r?n&&i.slice(-n.length)===n:"~="===r?(" "+i.replace(oe," ")+" ").indexOf(n)>-1:"|="===r&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,r,n,o){var i="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===n&&0===o?function(e){return!!e.parentNode}:function(t,r,c){var u,f,l,d,E,g,I=i!==a?"nextSibling":"previousSibling",p=t.parentNode,_=s&&t.nodeName.toLowerCase(),C=!c&&!s,v=!1;if(p){if(i){for(;I;){for(d=t;d=d[I];)if(s?d.nodeName.toLowerCase()===_:1===d.nodeType)return!1;g=I="only"===e&&!g&&"nextSibling"}return!0}if(g=[a?p.firstChild:p.lastChild],a&&C){for(d=p,l=d[M]||(d[M]={}),f=l[d.uniqueID]||(l[d.uniqueID]={}),u=f[e]||[],E=u[0]===G&&u[1],v=E&&u[2],d=E&&p.childNodes[E];d=++E&&d&&d[I]||(v=E=0)||g.pop();)if(1===d.nodeType&&++v&&d===t){f[e]=[G,E,v];break}}else if(C&&(d=t,l=d[M]||(d[M]={}),f=l[d.uniqueID]||(l[d.uniqueID]={}),u=f[e]||[],E=u[0]===G&&u[1],v=E),!1===v)for(;(d=++E&&d&&d[I]||(v=E=0)||g.pop())&&((s?d.nodeName.toLowerCase()!==_:1!==d.nodeType)||!++v||(C&&(l=d[M]||(d[M]={}),f=l[d.uniqueID]||(l[d.uniqueID]={}),f[e]=[G,v]),d!==t)););return(v-=o)===n||v%n==0&&v/n>=0}}},PSEUDO:function(e,r){var o,i=m.pseudos[e]||m.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return i[M]?i(r):i.length>1?(o=[e,e,"",r],m.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,o=i(e,r),a=o.length;a--;)n=Q(e,o[a]),e[n]=!(t[n]=o[a])}):function(e){return i(e,0,o)}):i}},pseudos:{not:n(function(e){var t=[],r=[],o=P(e.replace(ie,"$1"));return o[M]?n(function(e,t,r,n){for(var i,a=o(e,null,n,[]),s=e.length;s--;)(i=a[s])&&(e[s]=!(t[s]=i))}):function(e,n,i){return t[0]=e,o(t,null,i,r),t[0]=null,!r.pop()}}),has:n(function(e){return function(r){return t(e,r).length>0}}),contains:n(function(e){return e=e.replace(_e,Ce),function(t){return(t.textContent||t.innerText||T(t)).indexOf(e)>-1}}),lang:n(function(e){return fe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_e,Ce).toLowerCase(),function(t){var r;do{if(r=L?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(r=r.toLowerCase())===e||0===r.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var r=e.location&&e.location.hash;return r&&r.slice(1)===t.id},root:function(e){return e===U},focus:function(e){return e===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:s(!1),disabled:s(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!m.pseudos.empty(e)},header:function(e){return Ee.test(e.nodeName)},input:function(e){return de.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,r){return[r<0?r+t:r]}),even:c(function(e,t){for(var r=0;r<t;r+=2)e.push(r);return e}),odd:c(function(e,t){for(var r=1;r<t;r+=2)e.push(r);return e}),lt:c(function(e,t,r){for(var n=r<0?r+t:r;--n>=0;)e.push(n);return e}),gt:c(function(e,t,r){for(var n=r<0?r+t:r;++n<t;)e.push(n);return e})}},m.pseudos.nth=m.pseudos.eq;for(v in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})m.pseudos[v]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(v);for(v in{submit:!0,reset:!0})m.pseudos[v]=function(e){return function(t){var r=t.nodeName.toLowerCase();return("input"===r||"button"===r)&&t.type===e}}(v);return f.prototype=m.filters=m.pseudos,m.setFilters=new f,h=t.tokenize=function(e,r){var n,o,i,a,s,c,u,f=B[e+" "];if(f)return r?0:f.slice(0);for(s=e,c=[],u=m.preFilter;s;){n&&!(o=ae.exec(s))||(o&&(s=s.slice(o[0].length)||s),c.push(i=[])),n=!1,(o=se.exec(s))&&(n=o.shift(),i.push({value:n,type:o[0].replace(ie," ")}),s=s.slice(n.length));for(a in m.filter)!(o=le[a].exec(s))||u[a]&&!(o=u[a](o))||(n=o.shift(),i.push({value:n,type:a,matches:o}),s=s.slice(n.length));if(!n)break}return r?s.length:s?t.error(e):B(e,c).slice(0)},P=t.compile=function(e,t){var r,n=[],o=[],i=H[e+" "];if(!i){for(t||(t=h(e)),r=t.length;r--;)i=_(t[r]),i[M]?n.push(i):o.push(i);i=H(e,C(o,n)),i.selector=e}return i},N=t.select=function(e,t,r,n){var o,i,a,s,c,f="function"==typeof e&&e,d=!n&&h(e=f.selector||e);if(r=r||[],1===d.length){if(i=d[0]=d[0].slice(0),i.length>2&&"ID"===(a=i[0]).type&&9===t.nodeType&&L&&m.relative[i[1].type]){if(!(t=(m.find.ID(a.matches[0].replace(_e,Ce),t)||[])[0]))return r;f&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=le.needsContext.test(e)?0:i.length;o--&&(a=i[o],!m.relative[s=a.type]);)if((c=m.find[s])&&(n=c(a.matches[0].replace(_e,Ce),pe.test(i[0].type)&&u(t.parentNode)||t))){if(i.splice(o,1),!(e=n.length&&l(i)))return J.apply(r,n),r;break}}return(f||P(e,d))(n,t,!L,r,!t||pe.test(e)&&u(t.parentNode)||t),r},R.sortStable=M.split("").sort(V).join("")===M,R.detectDuplicates=!!O,b(),R.sortDetached=o(function(e){return 1&e.compareDocumentPosition(D.createElement("fieldset"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||i("type|href|height|width",function(e,t,r){if(!r)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),R.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||i("value",function(e,t,r){if(!r&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||i(Z,function(e,t,r){var n;if(!r)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(r);Pe.find=ye,Pe.expr=ye.selectors,Pe.expr[":"]=Pe.expr.pseudos,Pe.uniqueSort=Pe.unique=ye.uniqueSort,Pe.text=ye.getText,Pe.isXMLDoc=ye.isXML,Pe.contains=ye.contains,Pe.escapeSelector=ye.escape;var Ae=function(e,t,r){for(var n=[],o=void 0!==r;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&Pe(e).is(r))break;n.push(e)}return n},Oe=function(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r},be=Pe.expr.match.needsContext,De=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;Pe.filter=function(e,t,r){var n=t[0];return r&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?Pe.find.matchesSelector(n,e)?[n]:[]:Pe.find.matches(e,Pe.grep(t,function(e){return 1===e.nodeType}))},Pe.fn.extend({find:function(e){var t,r,n=this.length,o=this;if("string"!=typeof e)return this.pushStack(Pe(e).filter(function(){for(t=0;t<n;t++)if(Pe.contains(o[t],this))return!0}));for(r=this.pushStack([]),t=0;t<n;t++)Pe.find(e,o[t],r);return n>1?Pe.uniqueSort(r):r},filter:function(e){return this.pushStack(f(this,e||[],!1))},not:function(e){return this.pushStack(f(this,e||[],!0))},is:function(e){return!!f(this,"string"==typeof e&&be.test(e)?Pe(e):e||[],!1).length}});var Ue,Le=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(Pe.fn.init=function(e,t,r){var n,o;if(!e)return this;if(r=r||Ue,"string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:Le.exec(e))||!n[1]&&t)return!t||t.jquery?(t||r).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Pe?t[0]:t,Pe.merge(this,Pe.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:fe,!0)),De.test(n[1])&&Pe.isPlainObject(t))for(n in t)Te(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return o=fe.getElementById(n[2]),o&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):Te(e)?void 0!==r.ready?r.ready(e):e(Pe):Pe.makeArray(e,this)}).prototype=Pe.fn,Ue=Pe(fe);var we=/^(?:parents|prev(?:Until|All))/,xe={children:!0,contents:!0,next:!0,prev:!0};Pe.fn.extend({has:function(e){var t=Pe(e,this),r=t.length;return this.filter(function(){for(var e=0;e<r;e++)if(Pe.contains(this,t[e]))return!0})},closest:function(e,t){var r,n=0,o=this.length,i=[],a="string"!=typeof e&&Pe(e);if(!be.test(e))for(;n<o;n++)for(r=this[n];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(a?a.index(r)>-1:1===r.nodeType&&Pe.find.matchesSelector(r,e))){i.push(r);break}return this.pushStack(i.length>1?Pe.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?Ie.call(Pe(e),this[0]):Ie.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Pe.uniqueSort(Pe.merge(this.get(),Pe(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Pe.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Ae(e,"parentNode")},parentsUntil:function(e,t,r){return Ae(e,"parentNode",r)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return Ae(e,"nextSibling")},prevAll:function(e){return Ae(e,"previousSibling")},nextUntil:function(e,t,r){return Ae(e,"nextSibling",r)},prevUntil:function(e,t,r){return Ae(e,"previousSibling",r)},siblings:function(e){return Oe((e.parentNode||{}).firstChild,e)},children:function(e){return Oe(e.firstChild)},contents:function(e){return u(e,"iframe")?e.contentDocument:(u(e,"template")&&(e=e.content||e),Pe.merge([],e.childNodes))}},function(e,t){Pe.fn[e]=function(r,n){var o=Pe.map(this,t,r);return"Until"!==e.slice(-5)&&(n=r),n&&"string"==typeof n&&(o=Pe.filter(n,o)),this.length>1&&(xe[e]||Pe.uniqueSort(o),we.test(e)&&o.reverse()),this.pushStack(o)}});var Fe=/[^\x20\t\r\n\f]+/g;Pe.Callbacks=function(e){e="string"==typeof e?d(e):Pe.extend({},e);var t,r,n,o,i=[],a=[],c=-1,u=function(){for(o=o||e.once,n=t=!0;a.length;c=-1)for(r=a.shift();++c<i.length;)!1===i[c].apply(r[0],r[1])&&e.stopOnFalse&&(c=i.length,r=!1);e.memory||(r=!1),t=!1,o&&(i=r?[]:"")},f={add:function(){return i&&(r&&!t&&(c=i.length-1,a.push(r)),function t(r){Pe.each(r,function(r,n){Te(n)?e.unique&&f.has(n)||i.push(n):n&&n.length&&"string"!==s(n)&&t(n)})}(arguments),r&&!t&&u()),this},remove:function(){return Pe.each(arguments,function(e,t){for(var r;(r=Pe.inArray(t,i,r))>-1;)i.splice(r,1),r<=c&&c--}),this},has:function(e){return e?Pe.inArray(e,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return o=a=[],i=r="",this},disabled:function(){return!i},lock:function(){return o=a=[],r||t||(i=r=""),this},locked:function(){return!!o},fireWith:function(e,r){return o||(r=r||[],r=[e,r.slice?r.slice():r],a.push(r),t||u()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!n}};return f},Pe.extend({Deferred:function(e){var t=[["notify","progress",Pe.Callbacks("memory"),Pe.Callbacks("memory"),2],["resolve","done",Pe.Callbacks("once memory"),Pe.Callbacks("once memory"),0,"resolved"],["reject","fail",Pe.Callbacks("once memory"),Pe.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var e=arguments;return Pe.Deferred(function(r){Pe.each(t,function(t,n){var o=Te(e[n[4]])&&e[n[4]];i[n[1]](function(){var e=o&&o.apply(this,arguments);e&&Te(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[n[0]+"With"](this,o?[e]:arguments)})}),e=null}).promise()},then:function(e,n,o){function i(e,t,n,o){return function(){var s=this,c=arguments,u=function(){var r,u;if(!(e<a)){if((r=n.apply(s,c))===t.promise())throw new TypeError("Thenable self-resolution");u=r&&("object"==typeof r||"function"==typeof r)&&r.then,Te(u)?o?u.call(r,i(a,t,E,o),i(a,t,g,o)):(a++,u.call(r,i(a,t,E,o),i(a,t,g,o),i(a,t,E,t.notifyWith))):(n!==E&&(s=void 0,c=[r]),(o||t.resolveWith)(s,c))}},f=o?u:function(){try{u()}catch(r){Pe.Deferred.exceptionHook&&Pe.Deferred.exceptionHook(r,f.stackTrace),e+1>=a&&(n!==g&&(s=void 0,c=[r]),t.rejectWith(s,c))}};e?f():(Pe.Deferred.getStackHook&&(f.stackTrace=Pe.Deferred.getStackHook()),r.setTimeout(f))}}var a=0;return Pe.Deferred(function(r){t[0][3].add(i(0,r,Te(o)?o:E,r.notifyWith)),t[1][3].add(i(0,r,Te(e)?e:E)),t[2][3].add(i(0,r,Te(n)?n:g))}).promise()},promise:function(e){return null!=e?Pe.extend(e,o):o}},i={};return Pe.each(t,function(e,r){var a=r[2],s=r[5];o[r[1]]=a.add,s&&a.add(function(){n=s},t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),a.add(r[3].fire),i[r[0]]=function(){return i[r[0]+"With"](this===i?void 0:this,arguments),this},i[r[0]+"With"]=a.fireWith}),o.promise(i),e&&e.call(i,i),i},when:function(e){var t=arguments.length,r=t,n=Array(r),o=de.call(arguments),i=Pe.Deferred(),a=function(e){return function(r){n[e]=this,o[e]=arguments.length>1?de.call(arguments):r,--t||i.resolveWith(n,o)}};if(t<=1&&(I(e,i.done(a(r)).resolve,i.reject,!t),"pending"===i.state()||Te(o[r]&&o[r].then)))return i.then();for(;r--;)I(o[r],a(r),i.reject);return i.promise()}});var ke=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;Pe.Deferred.exceptionHook=function(e,t){r.console&&r.console.warn&&e&&ke.test(e.name)&&r.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},Pe.readyException=function(e){r.setTimeout(function(){throw e})};var Me=Pe.Deferred();Pe.fn.ready=function(e){return Me.then(e).catch(function(e){Pe.readyException(e)}),this},Pe.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--Pe.readyWait:Pe.isReady)||(Pe.isReady=!0,!0!==e&&--Pe.readyWait>0||Me.resolveWith(fe,[Pe]))}}),Pe.ready.then=Me.then,"complete"===fe.readyState||"loading"!==fe.readyState&&!fe.documentElement.doScroll?r.setTimeout(Pe.ready):(fe.addEventListener("DOMContentLoaded",p),r.addEventListener("load",p));var Ke=function(e,t,r,n,o,i,a){var c=0,u=e.length,f=null==r;if("object"===s(r)){o=!0;for(c in r)Ke(e,t,c,r[c],!0,i,a)}else if(void 0!==n&&(o=!0,Te(n)||(a=!0),f&&(a?(t.call(e,n),t=null):(f=t,t=function(e,t,r){return f.call(Pe(e),r)})),t))for(;c<u;c++)t(e[c],r,a?n:n.call(e[c],c,t(e[c],r)));return o?e:f?t.call(e):u?t(e[0],r):i},Ge=/^-ms-/,Ye=/-([a-z])/g,We=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};v.uid=1,v.prototype={cache:function(e){var t=e[this.expando];return t||(t={},We(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var n,o=this.cache(e);if("string"==typeof t)o[C(t)]=r;else for(n in t)o[C(n)]=t[n];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][C(t)]},access:function(e,t,r){return void 0===t||t&&"string"==typeof t&&void 0===r?this.get(e,t):(this.set(e,t,r),void 0!==r?r:t)},remove:function(e,t){var r,n=e[this.expando];if(void 0!==n){if(void 0!==t){Array.isArray(t)?t=t.map(C):(t=C(t),t=t in n?[t]:t.match(Fe)||[]),r=t.length;for(;r--;)delete n[t[r]]}(void 0===t||Pe.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!Pe.isEmptyObject(t)}};var Be=new v,He=new v,Ve=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,qe=/[A-Z]/g;Pe.extend({hasData:function(e){return He.hasData(e)||Be.hasData(e)},data:function(e,t,r){return He.access(e,t,r)},removeData:function(e,t){He.remove(e,t)},_data:function(e,t,r){return Be.access(e,t,r)},_removeData:function(e,t){Be.remove(e,t)}}),Pe.fn.extend({data:function(e,t){var r,n,o,i=this[0],a=i&&i.attributes;if(void 0===e){if(this.length&&(o=He.get(i),1===i.nodeType&&!Be.get(i,"hasDataAttrs"))){for(r=a.length;r--;)a[r]&&(n=a[r].name,0===n.indexOf("data-")&&(n=C(n.slice(5)),m(i,n,o[n])));Be.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){He.set(this,e)}):Ke(this,function(t){var r;if(i&&void 0===t){if(void 0!==(r=He.get(i,e)))return r;if(void 0!==(r=m(i,e)))return r}else this.each(function(){He.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){He.remove(this,e)})}}),Pe.extend({queue:function(e,t,r){var n;if(e)return t=(t||"fx")+"queue",n=Be.get(e,t),r&&(!n||Array.isArray(r)?n=Be.access(e,t,Pe.makeArray(r)):n.push(r)),n||[]},dequeue:function(e,t){t=t||"fx";var r=Pe.queue(e,t),n=r.length,o=r.shift(),i=Pe._queueHooks(e,t),a=function(){Pe.dequeue(e,t)};"inprogress"===o&&(o=r.shift(),n--),o&&("fx"===t&&r.unshift("inprogress"),delete i.stop,o.call(e,a,i)),!n&&i&&i.empty.fire()},_queueHooks:function(e,t){var r=t+"queueHooks";return Be.get(e,r)||Be.access(e,r,{empty:Pe.Callbacks("once memory").add(function(){Be.remove(e,[t+"queue",r])})})}}),Pe.fn.extend({queue:function(e,t){var r=2;return"string"!=typeof e&&(t=e,e="fx",r--),arguments.length<r?Pe.queue(this[0],e):void 0===t?this:this.each(function(){var r=Pe.queue(this,e,t);Pe._queueHooks(this,e),"fx"===e&&"inprogress"!==r[0]&&Pe.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Pe.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var r,n=1,o=Pe.Deferred(),i=this,a=this.length,s=function(){--n||o.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(r=Be.get(i[a],e+"queueHooks"))&&r.empty&&(n++,r.empty.add(s));return s(),o.promise(t)}});var je=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Xe=new RegExp("^(?:([+-])=|)("+je+")([a-z%]*)$","i"),$e=["Top","Right","Bottom","Left"],Je=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&Pe.contains(e.ownerDocument,e)&&"none"===Pe.css(e,"display")},ze=function(e,t,r,n){var o,i,a={};for(i in t)a[i]=e.style[i],e.style[i]=t[i];o=r.apply(e,n||[]);for(i in t)e.style[i]=a[i];return o},Qe={};Pe.fn.extend({show:function(){return h(this,!0)},hide:function(){return h(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Je(this)?Pe(this).show():Pe(this).hide()})}});var Ze=/^(?:checkbox|radio)$/i,et=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,tt=/^$|^module$|\/(?:java|ecma)script/i,rt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};rt.optgroup=rt.option,rt.tbody=rt.tfoot=rt.colgroup=rt.caption=rt.thead,rt.th=rt.td;var nt=/<|&#?\w+;/;!function(){var e=fe.createDocumentFragment(),t=e.appendChild(fe.createElement("div")),r=fe.createElement("input");r.setAttribute("type","radio"),r.setAttribute("checked","checked"),r.setAttribute("name","t"),t.appendChild(r),me.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",me.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var ot=fe.documentElement,it=/^key/,at=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,st=/^([^.]*)(?:\.(.+)|)/;Pe.event={global:{},add:function(e,t,r,n,o){var i,a,s,c,u,f,l,d,E,g,I,p=Be.get(e);if(p)for(r.handler&&(i=r,r=i.handler,o=i.selector),o&&Pe.find.matchesSelector(ot,o),r.guid||(r.guid=Pe.guid++),(c=p.events)||(c=p.events={}),(a=p.handle)||(a=p.handle=function(t){return void 0!==Pe&&Pe.event.triggered!==t.type?Pe.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Fe)||[""],u=t.length;u--;)s=st.exec(t[u])||[],E=I=s[1],g=(s[2]||"").split(".").sort(),E&&(l=Pe.event.special[E]||{},E=(o?l.delegateType:l.bindType)||E,l=Pe.event.special[E]||{},f=Pe.extend({type:E,origType:I,data:n,handler:r,guid:r.guid,selector:o,needsContext:o&&Pe.expr.match.needsContext.test(o),namespace:g.join(".")},i),(d=c[E])||(d=c[E]=[],d.delegateCount=0,l.setup&&!1!==l.setup.call(e,n,g,a)||e.addEventListener&&e.addEventListener(E,a)),l.add&&(l.add.call(e,f),f.handler.guid||(f.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,f):d.push(f),Pe.event.global[E]=!0)},remove:function(e,t,r,n,o){var i,a,s,c,u,f,l,d,E,g,I,p=Be.hasData(e)&&Be.get(e);if(p&&(c=p.events)){for(t=(t||"").match(Fe)||[""],u=t.length;u--;)if(s=st.exec(t[u])||[],E=I=s[1],g=(s[2]||"").split(".").sort(),E){for(l=Pe.event.special[E]||{},E=(n?l.delegateType:l.bindType)||E,d=c[E]||[],s=s[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=i=d.length;i--;)f=d[i],!o&&I!==f.origType||r&&r.guid!==f.guid||s&&!s.test(f.namespace)||n&&n!==f.selector&&("**"!==n||!f.selector)||(d.splice(i,1),f.selector&&d.delegateCount--,l.remove&&l.remove.call(e,f));a&&!d.length&&(l.teardown&&!1!==l.teardown.call(e,g,p.handle)||Pe.removeEvent(e,E,p.handle),delete c[E])}else for(E in c)Pe.event.remove(e,E+t[u],r,n,!0);Pe.isEmptyObject(c)&&Be.remove(e,"handle events")}},dispatch:function(e){var t,r,n,o,i,a,s=Pe.event.fix(e),c=new Array(arguments.length),u=(Be.get(this,"events")||{})[s.type]||[],f=Pe.event.special[s.type]||{};for(c[0]=s,t=1;t<arguments.length;t++)c[t]=arguments[t];if(s.delegateTarget=this,!f.preDispatch||!1!==f.preDispatch.call(this,s)){for(a=Pe.event.handlers.call(this,s,u),t=0;(o=a[t++])&&!s.isPropagationStopped();)for(s.currentTarget=o.elem,r=0;(i=o.handlers[r++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(i.namespace)||(s.handleObj=i,s.data=i.data,void 0!==(n=((Pe.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,c))&&!1===(s.result=n)&&(s.preventDefault(),s.stopPropagation()));return f.postDispatch&&f.postDispatch.call(this,s),s.result}},handlers:function(e,t){var r,n,o,i,a,s=[],c=t.delegateCount,u=e.target;if(c&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(i=[],a={},r=0;r<c;r++)n=t[r],o=n.selector+" ",void 0===a[o]&&(a[o]=n.needsContext?Pe(o,this).index(u)>-1:Pe.find(o,this,null,[u]).length),a[o]&&i.push(n);i.length&&s.push({elem:u,handlers:i})}return u=this,c<t.length&&s.push({elem:u,handlers:t.slice(c)}),s},addProp:function(e,t){Object.defineProperty(Pe.Event.prototype,e,{enumerable:!0,configurable:!0,get:Te(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[Pe.expando]?e:new Pe.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==b()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===b()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&u(this,"input"))return this.click(),!1},_default:function(e){return u(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},Pe.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)},Pe.Event=function(e,t){if(!(this instanceof Pe.Event))return new Pe.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?A:O,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&Pe.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[Pe.expando]=!0},Pe.Event.prototype={constructor:Pe.Event,isDefaultPrevented:O,isPropagationStopped:O,isImmediatePropagationStopped:O,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=A,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=A,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=A,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},Pe.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&it.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&at.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},Pe.event.addProp),Pe.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Pe.event.special[e]={delegateType:t,bindType:t,handle:function(e){var r,n=this,o=e.relatedTarget,i=e.handleObj;return o&&(o===n||Pe.contains(n,o))||(e.type=i.origType,r=i.handler.apply(this,arguments),e.type=t),r}}}),Pe.fn.extend({on:function(e,t,r,n){return D(this,e,t,r,n)},one:function(e,t,r,n){return D(this,e,t,r,n,1)},off:function(e,t,r){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Pe(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(r=t,t=void 0),!1===r&&(r=O),this.each(function(){Pe.event.remove(this,e,r,t)})}});var ct=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,ut=/<script|<style|<link/i,ft=/checked\s*(?:[^=]|=\s*.checked.)/i,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;Pe.extend({htmlPrefilter:function(e){return e.replace(ct,"<$1></$2>")},clone:function(e,t,r){var n,o,i,a,s=e.cloneNode(!0),c=Pe.contains(e.ownerDocument,e);if(!(me.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Pe.isXMLDoc(e)))for(a=P(s),i=P(e),n=0,o=i.length;n<o;n++)F(i[n],a[n]);if(t)if(r)for(i=i||P(e),a=a||P(s),n=0,o=i.length;n<o;n++)x(i[n],a[n]);else x(e,s);return a=P(s,"script"),a.length>0&&N(a,!c&&P(e,"script")),s},cleanData:function(e){for(var t,r,n,o=Pe.event.special,i=0;void 0!==(r=e[i]);i++)if(We(r)){if(t=r[Be.expando]){if(t.events)for(n in t.events)o[n]?Pe.event.remove(r,n):Pe.removeEvent(r,n,t.handle);r[Be.expando]=void 0}r[He.expando]&&(r[He.expando]=void 0)}}}),Pe.fn.extend({detach:function(e){return M(this,e,!0)},remove:function(e){return M(this,e)},text:function(e){return Ke(this,function(e){return void 0===e?Pe.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return k(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){U(this,e).appendChild(e)}})},prepend:function(){return k(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=U(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return k(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return k(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Pe.cleanData(P(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return Pe.clone(this,e,t)})},html:function(e){return Ke(this,function(e){var t=this[0]||{},r=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ut.test(e)&&!rt[(et.exec(e)||["",""])[1].toLowerCase()]){e=Pe.htmlPrefilter(e);try{for(;r<n;r++)t=this[r]||{},1===t.nodeType&&(Pe.cleanData(P(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return k(this,arguments,function(t){var r=this.parentNode;Pe.inArray(this,e)<0&&(Pe.cleanData(P(this)),r&&r.replaceChild(t,this))},e)}}),Pe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Pe.fn[e]=function(e){for(var r,n=[],o=Pe(e),i=o.length-1,a=0;a<=i;a++)r=a===i?this:this.clone(!0),Pe(o[a])[t](r),ge.apply(n,r.get());return this.pushStack(n)}});var dt=new RegExp("^("+je+")(?!px)[a-z%]+$","i"),Et=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=r),t.getComputedStyle(e)},gt=new RegExp($e.join("|"),"i");!function(){function e(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ot.appendChild(c).appendChild(u);var e=r.getComputedStyle(u);n="1%"!==e.top,s=12===t(e.marginLeft),u.style.right="60%",a=36===t(e.right),o=36===t(e.width),u.style.position="absolute",i=36===u.offsetWidth||"absolute",ot.removeChild(c),u=null}}function t(e){return Math.round(parseFloat(e))}var n,o,i,a,s,c=fe.createElement("div"),u=fe.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",me.clearCloneStyle="content-box"===u.style.backgroundClip,Pe.extend(me,{boxSizingReliable:function(){return e(),o},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i}}))}();var It=/^(none|table(?!-c[ea]).+)/,pt=/^--/,_t={position:"absolute",visibility:"hidden",display:"block"},Ct={letterSpacing:"0",fontWeight:"400"},vt=["Webkit","Moz","ms"],Rt=fe.createElement("div").style;Pe.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=K(e,"opacity");return""===r?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,i,a,s=C(t),c=pt.test(t),u=e.style;if(c||(t=W(s)),a=Pe.cssHooks[t]||Pe.cssHooks[s],void 0===r)return a&&"get"in a&&void 0!==(o=a.get(e,!1,n))?o:u[t];i=typeof r,"string"===i&&(o=Xe.exec(r))&&o[1]&&(r=T(e,t,o),i="number"),null!=r&&r===r&&("number"===i&&(r+=o&&o[3]||(Pe.cssNumber[s]?"":"px")),me.clearCloneStyle||""!==r||0!==t.indexOf("background")||(u[t]="inherit"),a&&"set"in a&&void 0===(r=a.set(e,r,n))||(c?u.setProperty(t,r):u[t]=r))}},css:function(e,t,r,n){var o,i,a,s=C(t);return pt.test(t)||(t=W(s)),a=Pe.cssHooks[t]||Pe.cssHooks[s],a&&"get"in a&&(o=a.get(e,!0,r)),void 0===o&&(o=K(e,t,n)),"normal"===o&&t in Ct&&(o=Ct[t]),""===r||r?(i=parseFloat(o),!0===r||isFinite(i)?i||0:o):o}}),Pe.each(["height","width"],function(e,t){Pe.cssHooks[t]={get:function(e,r,n){if(r)return!It.test(Pe.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?V(e,t,n):ze(e,_t,function(){return V(e,t,n)})},set:function(e,r,n){var o,i=Et(e),a="border-box"===Pe.css(e,"boxSizing",!1,i),s=n&&H(e,t,n,a,i);return a&&me.scrollboxSize()===i.position&&(s-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(i[t])-H(e,t,"border",!1,i)-.5)),s&&(o=Xe.exec(r))&&"px"!==(o[3]||"px")&&(e.style[t]=r,r=Pe.css(e,t)),B(e,r,s)}}}),Pe.cssHooks.marginLeft=G(me.reliableMarginLeft,function(e,t){if(t)return(parseFloat(K(e,"marginLeft"))||e.getBoundingClientRect().left-ze(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),Pe.each({margin:"",padding:"",border:"Width"},function(e,t){Pe.cssHooks[e+t]={expand:function(r){for(var n=0,o={},i="string"==typeof r?r.split(" "):[r];n<4;n++)o[e+$e[n]+t]=i[n]||i[n-2]||i[0];return o}},"margin"!==e&&(Pe.cssHooks[e+t].set=B)}),Pe.fn.extend({css:function(e,t){return Ke(this,function(e,t,r){var n,o,i={},a=0;if(Array.isArray(t)){for(n=Et(e),o=t.length;a<o;a++)i[t[a]]=Pe.css(e,t[a],!1,n);return i}return void 0!==r?Pe.style(e,t,r):Pe.css(e,t)},e,t,arguments.length>1)}}),Pe.Tween=q,q.prototype={constructor:q,init:function(e,t,r,n,o,i){this.elem=e,this.prop=r,this.easing=o||Pe.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=i||(Pe.cssNumber[r]?"":"px")},cur:function(){var e=q.propHooks[this.prop];return e&&e.get?e.get(this):q.propHooks._default.get(this)},run:function(e){var t,r=q.propHooks[this.prop];return this.options.duration?this.pos=t=Pe.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):q.propHooks._default.set(this),this}},q.prototype.init.prototype=q.prototype,q.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=Pe.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){Pe.fx.step[e.prop]?Pe.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[Pe.cssProps[e.prop]]&&!Pe.cssHooks[e.prop]?e.elem[e.prop]=e.now:Pe.style(e.elem,e.prop,e.now+e.unit)}}},q.propHooks.scrollTop=q.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Pe.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},Pe.fx=q.prototype.init,Pe.fx.step={};var mt,Tt,St=/^(?:toggle|show|hide)$/,ht=/queueHooks$/;Pe.Animation=Pe.extend(Z,{tweeners:{"*":[function(e,t){var r=this.createTween(e,t);return T(r.elem,e,Xe.exec(t),r),r}]},tweener:function(e,t){Te(e)?(t=e,e=["*"]):e=e.match(Fe);for(var r,n=0,o=e.length;n<o;n++)r=e[n],Z.tweeners[r]=Z.tweeners[r]||[],Z.tweeners[r].unshift(t)},prefilters:[z],prefilter:function(e,t){t?Z.prefilters.unshift(e):Z.prefilters.push(e)}}),Pe.speed=function(e,t,r){var n=e&&"object"==typeof e?Pe.extend({},e):{complete:r||!r&&t||Te(e)&&e,duration:e,easing:r&&t||t&&!Te(t)&&t};return Pe.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in Pe.fx.speeds?n.duration=Pe.fx.speeds[n.duration]:n.duration=Pe.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){Te(n.old)&&n.old.call(this),n.queue&&Pe.dequeue(this,n.queue)},n},Pe.fn.extend({fadeTo:function(e,t,r,n){return this.filter(Je).css("opacity",0).show().end().animate({opacity:t},e,r,n)},animate:function(e,t,r,n){var o=Pe.isEmptyObject(e),i=Pe.speed(t,r,n),a=function(){var t=Z(this,Pe.extend({},e),i);(o||Be.get(this,"finish"))&&t.stop(!0)};return a.finish=a,o||!1===i.queue?this.each(a):this.queue(i.queue,a)},stop:function(e,t,r){var n=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",i=Pe.timers,a=Be.get(this);if(o)a[o]&&a[o].stop&&n(a[o]);else for(o in a)a[o]&&a[o].stop&&ht.test(o)&&n(a[o]);for(o=i.length;o--;)i[o].elem!==this||null!=e&&i[o].queue!==e||(i[o].anim.stop(r),t=!1,i.splice(o,1));!t&&r||Pe.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,r=Be.get(this),n=r[e+"queue"],o=r[e+"queueHooks"],i=Pe.timers,a=n?n.length:0;for(r.finish=!0,Pe.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<a;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete r.finish})}}),Pe.each(["toggle","show","hide"],function(e,t){var r=Pe.fn[t];Pe.fn[t]=function(e,n,o){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate($(t,!0),e,n,o)}}),Pe.each({slideDown:$("show"),slideUp:$("hide"),slideToggle:$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Pe.fn[e]=function(e,r,n){return this.animate(t,e,r,n)}}),Pe.timers=[],Pe.fx.tick=function(){var e,t=0,r=Pe.timers;for(mt=Date.now();t<r.length;t++)(e=r[t])()||r[t]!==e||r.splice(t--,1);r.length||Pe.fx.stop(),mt=void 0},Pe.fx.timer=function(e){Pe.timers.push(e),Pe.fx.start()},Pe.fx.interval=13,Pe.fx.start=function(){Tt||(Tt=!0,j())},Pe.fx.stop=function(){Tt=null},Pe.fx.speeds={slow:600,fast:200,_default:400},Pe.fn.delay=function(e,t){return e=Pe.fx?Pe.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var o=r.setTimeout(t,e);n.stop=function(){r.clearTimeout(o)}})},function(){var e=fe.createElement("input"),t=fe.createElement("select"),r=t.appendChild(fe.createElement("option"));e.type="checkbox",me.checkOn=""!==e.value,me.optSelected=r.selected,e=fe.createElement("input"),e.value="t",e.type="radio",me.radioValue="t"===e.value}();var Pt,Nt=Pe.expr.attrHandle;Pe.fn.extend({attr:function(e,t){return Ke(this,Pe.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Pe.removeAttr(this,e)})}}),Pe.extend({attr:function(e,t,r){var n,o,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?Pe.prop(e,t,r):(1===i&&Pe.isXMLDoc(e)||(o=Pe.attrHooks[t.toLowerCase()]||(Pe.expr.match.bool.test(t)?Pt:void 0)),void 0!==r?null===r?void Pe.removeAttr(e,t):o&&"set"in o&&void 0!==(n=o.set(e,r,t))?n:(e.setAttribute(t,r+""),r):o&&"get"in o&&null!==(n=o.get(e,t))?n:(n=Pe.find.attr(e,t),null==n?void 0:n))},attrHooks:{type:{set:function(e,t){if(!me.radioValue&&"radio"===t&&u(e,"input")){var r=e.value;return e.setAttribute("type",t),r&&(e.value=r),t}}}},removeAttr:function(e,t){var r,n=0,o=t&&t.match(Fe);if(o&&1===e.nodeType)for(;r=o[n++];)e.removeAttribute(r)}}),Pt={set:function(e,t,r){return!1===t?Pe.removeAttr(e,r):e.setAttribute(r,r),r}},Pe.each(Pe.expr.match.bool.source.match(/\w+/g),function(e,t){var r=Nt[t]||Pe.find.attr;Nt[t]=function(e,t,n){var o,i,a=t.toLowerCase();return n||(i=Nt[a],Nt[a]=o,o=null!=r(e,t,n)?a:null,Nt[a]=i),o}});var yt=/^(?:input|select|textarea|button)$/i,At=/^(?:a|area)$/i;Pe.fn.extend({prop:function(e,t){return Ke(this,Pe.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Pe.propFix[e]||e]})}}),Pe.extend({prop:function(e,t,r){var n,o,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&Pe.isXMLDoc(e)||(t=Pe.propFix[t]||t,o=Pe.propHooks[t]),void 0!==r?o&&"set"in o&&void 0!==(n=o.set(e,r,t))?n:e[t]=r:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=Pe.find.attr(e,"tabindex");return t?parseInt(t,10):yt.test(e.nodeName)||At.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),me.optSelected||(Pe.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),Pe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Pe.propFix[this.toLowerCase()]=this}),Pe.fn.extend({addClass:function(e){var t,r,n,o,i,a,s,c=0;if(Te(e))return this.each(function(t){Pe(this).addClass(e.call(this,t,te(this)))});if(t=re(e),t.length)for(;r=this[c++];)if(o=te(r),n=1===r.nodeType&&" "+ee(o)+" "){for(a=0;i=t[a++];)n.indexOf(" "+i+" ")<0&&(n+=i+" ");s=ee(n),o!==s&&r.setAttribute("class",s)}return this},removeClass:function(e){var t,r,n,o,i,a,s,c=0;if(Te(e))return this.each(function(t){Pe(this).removeClass(e.call(this,t,te(this)))});if(!arguments.length)return this.attr("class","");if(t=re(e),t.length)for(;r=this[c++];)if(o=te(r),n=1===r.nodeType&&" "+ee(o)+" "){for(a=0;i=t[a++];)for(;n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");s=ee(n),o!==s&&r.setAttribute("class",s)}return this},toggleClass:function(e,t){var r=typeof e,n="string"===r||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):Te(e)?this.each(function(r){Pe(this).toggleClass(e.call(this,r,te(this),t),t)}):this.each(function(){var t,o,i,a;if(n)for(o=0,i=Pe(this),a=re(e);t=a[o++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==e&&"boolean"!==r||(t=te(this),t&&Be.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":Be.get(this,"__className__")||""))})},hasClass:function(e){var t,r,n=0;for(t=" "+e+" ";r=this[n++];)if(1===r.nodeType&&(" "+ee(te(r))+" ").indexOf(t)>-1)return!0;return!1}});var Ot=/\r/g;Pe.fn.extend({val:function(e){var t,r,n,o=this[0];{if(arguments.length)return n=Te(e),this.each(function(r){var o;1===this.nodeType&&(o=n?e.call(this,r,Pe(this).val()):e,null==o?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=Pe.map(o,function(e){return null==e?"":e+""})),(t=Pe.valHooks[this.type]||Pe.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return(t=Pe.valHooks[o.type]||Pe.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(r=t.get(o,"value"))?r:(r=o.value,"string"==typeof r?r.replace(Ot,""):null==r?"":r)}}}),Pe.extend({valHooks:{option:{get:function(e){var t=Pe.find.attr(e,"value");return null!=t?t:ee(Pe.text(e))}},select:{get:function(e){var t,r,n,o=e.options,i=e.selectedIndex,a="select-one"===e.type,s=a?null:[],c=a?i+1:o.length;for(n=i<0?c:a?i:0;n<c;n++)if(r=o[n],(r.selected||n===i)&&!r.disabled&&(!r.parentNode.disabled||!u(r.parentNode,"optgroup"))){if(t=Pe(r).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var r,n,o=e.options,i=Pe.makeArray(t),a=o.length;a--;)n=o[a],(n.selected=Pe.inArray(Pe.valHooks.option.get(n),i)>-1)&&(r=!0);return r||(e.selectedIndex=-1),i}}}}),Pe.each(["radio","checkbox"],function(){Pe.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=Pe.inArray(Pe(e).val(),t)>-1}},me.checkOn||(Pe.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),me.focusin="onfocusin"in r;var bt=/^(?:focusinfocus|focusoutblur)$/,Dt=function(e){e.stopPropagation()};Pe.extend(Pe.event,{trigger:function(e,t,n,o){var i,a,s,c,u,f,l,d,E=[n||fe],g=Ce.call(e,"type")?e.type:e,I=Ce.call(e,"namespace")?e.namespace.split("."):[];if(a=d=s=n=n||fe,3!==n.nodeType&&8!==n.nodeType&&!bt.test(g+Pe.event.triggered)&&(g.indexOf(".")>-1&&(I=g.split("."),g=I.shift(),I.sort()),u=g.indexOf(":")<0&&"on"+g,e=e[Pe.expando]?e:new Pe.Event(g,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=I.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+I.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:Pe.makeArray(t,[e]),l=Pe.event.special[g]||{},o||!l.trigger||!1!==l.trigger.apply(n,t))){if(!o&&!l.noBubble&&!Se(n)){for(c=l.delegateType||g,bt.test(c+g)||(a=a.parentNode);a;a=a.parentNode)E.push(a),s=a;s===(n.ownerDocument||fe)&&E.push(s.defaultView||s.parentWindow||r)}for(i=0;(a=E[i++])&&!e.isPropagationStopped();)d=a,e.type=i>1?c:l.bindType||g,f=(Be.get(a,"events")||{})[e.type]&&Be.get(a,"handle"),f&&f.apply(a,t),(f=u&&a[u])&&f.apply&&We(a)&&(e.result=f.apply(a,t),!1===e.result&&e.preventDefault());return e.type=g,o||e.isDefaultPrevented()||l._default&&!1!==l._default.apply(E.pop(),t)||!We(n)||u&&Te(n[g])&&!Se(n)&&(s=n[u],s&&(n[u]=null),Pe.event.triggered=g,e.isPropagationStopped()&&d.addEventListener(g,Dt),n[g](),e.isPropagationStopped()&&d.removeEventListener(g,Dt),Pe.event.triggered=void 0,s&&(n[u]=s)),e.result}},simulate:function(e,t,r){var n=Pe.extend(new Pe.Event,r,{type:e,isSimulated:!0});Pe.event.trigger(n,null,t)}}),Pe.fn.extend({trigger:function(e,t){return this.each(function(){Pe.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r)return Pe.event.trigger(e,t,r,!0)}}),me.focusin||Pe.each({focus:"focusin",blur:"focusout"},function(e,t){var r=function(e){Pe.event.simulate(t,e.target,Pe.event.fix(e))};Pe.event.special[t]={setup:function(){var n=this.ownerDocument||this,o=Be.access(n,t);o||n.addEventListener(e,r,!0),Be.access(n,t,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=Be.access(n,t)-1;o?Be.access(n,t,o):(n.removeEventListener(e,r,!0),Be.remove(n,t))}}});var Ut=r.location,Lt=Date.now(),wt=/\?/;Pe.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new r.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||Pe.error("Invalid XML: "+e),t};var xt=/\[\]$/,Ft=/\r?\n/g,kt=/^(?:submit|button|image|reset|file)$/i,Mt=/^(?:input|select|textarea|keygen)/i;Pe.param=function(e,t){var r,n=[],o=function(e,t){var r=Te(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==r?"":r)};if(Array.isArray(e)||e.jquery&&!Pe.isPlainObject(e))Pe.each(e,function(){o(this.name,this.value)});else for(r in e)ne(r,e[r],t,o);return n.join("&")},Pe.fn.extend({serialize:function(){return Pe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Pe.prop(this,"elements");return e?Pe.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Pe(this).is(":disabled")&&Mt.test(this.nodeName)&&!kt.test(e)&&(this.checked||!Ze.test(e))}).map(function(e,t){var r=Pe(this).val();return null==r?null:Array.isArray(r)?Pe.map(r,function(e){return{name:t.name,value:e.replace(Ft,"\r\n")}}):{name:t.name,value:r.replace(Ft,"\r\n")}}).get()}});var Kt=/%20/g,Gt=/#.*$/,Yt=/([?&])_=[^&]*/,Wt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Bt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ht=/^(?:GET|HEAD)$/,Vt=/^\/\//,qt={},jt={},Xt="*/".concat("*"),$t=fe.createElement("a");$t.href=Ut.href,Pe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut.href,type:"GET",isLocal:Bt.test(Ut.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":Pe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ae(ae(e,Pe.ajaxSettings),t):ae(Pe.ajaxSettings,e)},ajaxPrefilter:oe(qt),ajaxTransport:oe(jt),ajax:function(e,t){function n(e,t,n,s){var u,d,E,R,m,T=t;f||(f=!0,c&&r.clearTimeout(c),o=void 0,a=s||"",S.readyState=e>0?4:0,u=e>=200&&e<300||304===e,n&&(R=se(g,S,n)),R=ce(g,R,S,u),u?(g.ifModified&&(m=S.getResponseHeader("Last-Modified"),m&&(Pe.lastModified[i]=m),(m=S.getResponseHeader("etag"))&&(Pe.etag[i]=m)),204===e||"HEAD"===g.type?T="nocontent":304===e?T="notmodified":(T=R.state,d=R.data,E=R.error,u=!E)):(E=T,!e&&T||(T="error",e<0&&(e=0))),S.status=e,S.statusText=(t||T)+"",u?_.resolveWith(I,[d,T,S]):_.rejectWith(I,[S,T,E]),S.statusCode(v),v=void 0,l&&p.trigger(u?"ajaxSuccess":"ajaxError",[S,g,u?d:E]),C.fireWith(I,[S,T]),l&&(p.trigger("ajaxComplete",[S,g]),--Pe.active||Pe.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var o,i,a,s,c,u,f,l,d,E,g=Pe.ajaxSetup({},t),I=g.context||g,p=g.context&&(I.nodeType||I.jquery)?Pe(I):Pe.event,_=Pe.Deferred(),C=Pe.Callbacks("once memory"),v=g.statusCode||{},R={},m={},T="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(f){if(!s)for(s={};t=Wt.exec(a);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return f?a:null},setRequestHeader:function(e,t){return null==f&&(e=m[e.toLowerCase()]=m[e.toLowerCase()]||e,R[e]=t),this},overrideMimeType:function(e){return null==f&&(g.mimeType=e),this},statusCode:function(e){var t;if(e)if(f)S.always(e[S.status]);else for(t in e)v[t]=[v[t],e[t]];return this},abort:function(e){var t=e||T;return o&&o.abort(t),n(0,t),this}};if(_.promise(S),g.url=((e||g.url||Ut.href)+"").replace(Vt,Ut.protocol+"//"),g.type=t.method||t.type||g.method||g.type,g.dataTypes=(g.dataType||"*").toLowerCase().match(Fe)||[""],null==g.crossDomain){u=fe.createElement("a");try{u.href=g.url,u.href=u.href,g.crossDomain=$t.protocol+"//"+$t.host!=u.protocol+"//"+u.host}catch(e){g.crossDomain=!0}}if(g.data&&g.processData&&"string"!=typeof g.data&&(g.data=Pe.param(g.data,g.traditional)),ie(qt,g,t,S),f)return S;l=Pe.event&&g.global,l&&0==Pe.active++&&Pe.event.trigger("ajaxStart"),g.type=g.type.toUpperCase(),g.hasContent=!Ht.test(g.type),i=g.url.replace(Gt,""),g.hasContent?g.data&&g.processData&&0===(g.contentType||"").indexOf("application/x-www-form-urlencoded")&&(g.data=g.data.replace(Kt,"+")):(E=g.url.slice(i.length),g.data&&(g.processData||"string"==typeof g.data)&&(i+=(wt.test(i)?"&":"?")+g.data,delete g.data),!1===g.cache&&(i=i.replace(Yt,"$1"),E=(wt.test(i)?"&":"?")+"_="+Lt+++E),g.url=i+E),g.ifModified&&(Pe.lastModified[i]&&S.setRequestHeader("If-Modified-Since",Pe.lastModified[i]),Pe.etag[i]&&S.setRequestHeader("If-None-Match",Pe.etag[i])),(g.data&&g.hasContent&&!1!==g.contentType||t.contentType)&&S.setRequestHeader("Content-Type",g.contentType),S.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+Xt+"; q=0.01":""):g.accepts["*"]);for(d in g.headers)S.setRequestHeader(d,g.headers[d]);if(g.beforeSend&&(!1===g.beforeSend.call(I,S,g)||f))return S.abort();if(T="abort",C.add(g.complete),S.done(g.success),S.fail(g.error),o=ie(jt,g,t,S)){if(S.readyState=1,l&&p.trigger("ajaxSend",[S,g]),f)return S;g.async&&g.timeout>0&&(c=r.setTimeout(function(){S.abort("timeout")},g.timeout));try{f=!1,o.send(R,n)}catch(e){if(f)throw e;n(-1,e)}}else n(-1,"No Transport");return S},getJSON:function(e,t,r){return Pe.get(e,t,r,"json")},getScript:function(e,t){return Pe.get(e,void 0,t,"script")}}),Pe.each(["get","post"],function(e,t){Pe[t]=function(e,r,n,o){return Te(r)&&(o=o||n,n=r,r=void 0),Pe.ajax(Pe.extend({url:e,type:t,dataType:o,data:r,success:n},Pe.isPlainObject(e)&&e))}}),Pe._evalUrl=function(e){return Pe.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},Pe.fn.extend({wrapAll:function(e){var t;return this[0]&&(Te(e)&&(e=e.call(this[0])),t=Pe(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return Te(e)?this.each(function(t){Pe(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Pe(this),r=t.contents();r.length?r.wrapAll(e):t.append(e)})},wrap:function(e){var t=Te(e);return this.each(function(r){Pe(this).wrapAll(t?e.call(this,r):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){Pe(this).replaceWith(this.childNodes)}),this}}),Pe.expr.pseudos.hidden=function(e){return!Pe.expr.pseudos.visible(e)},Pe.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},Pe.ajaxSettings.xhr=function(){try{return new r.XMLHttpRequest}catch(e){}};var Jt={0:200,1223:204},zt=Pe.ajaxSettings.xhr();me.cors=!!zt&&"withCredentials"in zt,me.ajax=zt=!!zt,Pe.ajaxTransport(function(e){var t,n;if(me.cors||zt&&!e.crossDomain)return{send:function(o,i){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(a in o)s.setRequestHeader(a,o[a]);t=function(e){return function(){t&&(t=n=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?i(0,"error"):i(s.status,s.statusText):i(Jt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=t(),n=s.onerror=s.ontimeout=t("error"),void 0!==s.onabort?s.onabort=n:s.onreadystatechange=function(){4===s.readyState&&r.setTimeout(function(){t&&n()})},t=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),Pe.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),Pe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return Pe.globalEval(e),e}}}),Pe.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Pe.ajaxTransport("script",function(e){if(e.crossDomain){var t,r;return{send:function(n,o){t=Pe("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",r=function(e){t.remove(),r=null,e&&o("error"===e.type?404:200,e.type)}),fe.head.appendChild(t[0])},abort:function(){r&&r()}}}});var Qt=[],Zt=/(=)\?(?=&|$)|\?\?/;Pe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Qt.pop()||Pe.expando+"_"+Lt++;return this[e]=!0,e}}),Pe.ajaxPrefilter("json jsonp",function(e,t,n){var o,i,a,s=!1!==e.jsonp&&(Zt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return o=e.jsonpCallback=Te(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Zt,"$1"+o):!1!==e.jsonp&&(e.url+=(wt.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return a||Pe.error(o+" was not called"),a[0]},e.dataTypes[0]="json",i=r[o],r[o]=function(){a=arguments},n.always(function(){void 0===i?Pe(r).removeProp(o):r[o]=i,e[o]&&(e.jsonpCallback=t.jsonpCallback,Qt.push(o)),a&&Te(i)&&i(a[0]),a=i=void 0}),"script"}),me.createHTMLDocument=function(){var e=fe.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),Pe.parseHTML=function(e,t,r){if("string"!=typeof e)return[];"boolean"==typeof t&&(r=t,t=!1);var n,o,i;return t||(me.createHTMLDocument?(t=fe.implementation.createHTMLDocument(""),n=t.createElement("base"),n.href=fe.location.href,t.head.appendChild(n)):t=fe),o=De.exec(e),i=!r&&[],o?[t.createElement(o[1])]:(o=y([e],t,i),i&&i.length&&Pe(i).remove(),Pe.merge([],o.childNodes))},Pe.fn.load=function(e,t,r){var n,o,i,a=this,s=e.indexOf(" ");return s>-1&&(n=ee(e.slice(s)),e=e.slice(0,s)),Te(t)?(r=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&Pe.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){i=arguments,a.html(n?Pe("<div>").append(Pe.parseHTML(e)).find(n):e)}).always(r&&function(e,t){a.each(function(){r.apply(this,i||[e.responseText,t,e])})}),this},Pe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Pe.fn[t]=function(e){return this.on(t,e)}}),Pe.expr.pseudos.animated=function(e){return Pe.grep(Pe.timers,function(t){return e===t.elem}).length},Pe.offset={setOffset:function(e,t,r){var n,o,i,a,s,c,u,f=Pe.css(e,"position"),l=Pe(e),d={};"static"===f&&(e.style.position="relative"),s=l.offset(),i=Pe.css(e,"top"),c=Pe.css(e,"left"),u=("absolute"===f||"fixed"===f)&&(i+c).indexOf("auto")>-1,u?(n=l.position(),a=n.top,o=n.left):(a=parseFloat(i)||0,o=parseFloat(c)||0),Te(t)&&(t=t.call(e,r,Pe.extend({},s))),null!=t.top&&(d.top=t.top-s.top+a),null!=t.left&&(d.left=t.left-s.left+o),"using"in t?t.using.call(e,d):l.css(d)}},Pe.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Pe.offset.setOffset(this,e,t)});var t,r,n=this[0];if(n)return n.getClientRects().length?(t=n.getBoundingClientRect(),r=n.ownerDocument.defaultView,{top:t.top+r.pageYOffset,left:t.left+r.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,r,n=this[0],o={top:0,left:0};if("fixed"===Pe.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),r=n.ownerDocument,e=n.offsetParent||r.documentElement;e&&(e===r.body||e===r.documentElement)&&"static"===Pe.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&(o=Pe(e).offset(),o.top+=Pe.css(e,"borderTopWidth",!0),o.left+=Pe.css(e,"borderLeftWidth",!0))}return{top:t.top-o.top-Pe.css(n,"marginTop",!0),left:t.left-o.left-Pe.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===Pe.css(e,"position");)e=e.offsetParent;return e||ot})}}),Pe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var r="pageYOffset"===t;Pe.fn[e]=function(n){return Ke(this,function(e,n,o){var i;if(Se(e)?i=e:9===e.nodeType&&(i=e.defaultView),void 0===o)return i?i[t]:e[n];i?i.scrollTo(r?i.pageXOffset:o,r?o:i.pageYOffset):e[n]=o},e,n,arguments.length)}}),Pe.each(["top","left"],function(e,t){Pe.cssHooks[t]=G(me.pixelPosition,function(e,r){if(r)return r=K(e,t),dt.test(r)?Pe(e).position()[t]+"px":r})}),Pe.each({Height:"height",Width:"width"},function(e,t){Pe.each({padding:"inner"+e,content:t,"":"outer"+e},function(r,n){Pe.fn[n]=function(o,i){var a=arguments.length&&(r||"boolean"!=typeof o),s=r||(!0===o||!0===i?"margin":"border");return Ke(this,function(t,r,o){var i;return Se(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===o?Pe.css(t,r,s):Pe.style(t,r,o,s)},t,a?o:void 0,a)}})}),Pe.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){Pe.fn[t]=function(e,r){return arguments.length>0?this.on(t,null,e,r):this.trigger(t)}}),Pe.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Pe.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,n){return this.on(t,e,r,n)},undelegate:function(e,t,r){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",r)}}),Pe.proxy=function(e,t){var r,n,o;if("string"==typeof t&&(r=e[t],t=e,e=r),Te(e))return n=de.call(arguments,2),o=function(){return e.apply(t||this,n.concat(de.call(arguments)))},o.guid=e.guid=e.guid||Pe.guid++,o},Pe.holdReady=function(e){e?Pe.readyWait++:Pe.ready(!0)},Pe.isArray=Array.isArray,Pe.parseJSON=JSON.parse,Pe.nodeName=u,Pe.isFunction=Te,Pe.isWindow=Se,Pe.camelCase=C,Pe.type=s,Pe.now=Date.now,Pe.isNumeric=function(e){var t=Pe.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},n=[],void 0!==(o=function(){return Pe}.apply(t,n))&&(e.exports=o);var er=r.jQuery,tr=r.$;return Pe.noConflict=function(e){return r.$===Pe&&(r.$=tr),e&&r.jQuery===Pe&&(r.jQuery=er),Pe},i||(r.jQuery=r.$=Pe),Pe})},10:function(e,t,r){var n,o;n=[],void 0!==(o=function(){var e=cwui_conf.utils,t=cwui_conf.constants,r=cwui_conf.msgFactory;return{Error:function(){return{newThrow:function(n,o,i,a){throw null!==n&&void 0!==n.type?n:(null!==n&&e.Log.error(o,n),{type:t.System.EXCEPTION_ERROR,name:o,message:r.getMessageFactory().Error[o].replace(t.System.REPLACE_CHAR,a),extra:null===n?"":n.message,param:i})}}}(),Warn:function(){return{newThrow:function(n,o,i,a){if(null!==n&&void 0!==n.type)throw n;null!==n&&e.Log.warn(o,n);var s=r.getMessageFactory().Warn[o];throw s=r.getMessageFactory().Warn[o]?r.getMessageFactory().Warn[o].replace(t.System.REPLACE_CHAR,a):r.getMessageFactory().Warn.WARN_1000,{type:t.System.EXCEPTION_WARN,name:o,message:s,extra:null===n?"":n.message,param:i}}}}(),Info:function(){return{newThrow:function(e,n,o,i){throw null!==e&&void 0!==e.type?e:{type:t.System.EXCEPTION_INFO,name:n,message:r.getMessageFactory().Info[n].replace(t.System.REPLACE_CHAR,i),param:o}}}}()}}.apply(t,n))&&(e.exports=o)},126:function(e,t,r){var n,o;n=[],void 0!==(o=function(){function e(e){if(sessionStorage){parseInt(sessionStorage.CWEX_LOGLEVEL)>=5&&console.log(e)}}var t={isReady:!1};return function(){var n=3e4,o=function(){var t=!0;return"undefined"==typeof INIforgeCrypto&&(e("cwui_core : INIforgeCrypto is not loaded."),t=!1),"undefined"==typeof cwui_conf&&(e("cwui_core : cwui_conf is not loaded."),t=!1),t},i=function(){t.webStorageConverter=r(65),t.transferForm=r(66),t.privateStorage=r(67),t.openStorage=r(34),t.middleChannel=r(69),t.iniException=r(10),t.forgeCore=r(25),t.certificates=r(70),t.coreFactory=r(8),t.externalResponseFactory=r(130),t.barosignCore=r(131),t.certRelay=r(132),t.crossStorage=r(68),t.handleManager=r(133),t.isReady=!0,e("cwui_core : complete module load.")},a=function(){if(!0===o())i();else{if((n-=5)<=0)return void alert("cwui_core : error sub script load fail.");setTimeout(a,5)}};setTimeout(a,0)}(),t}.apply(t,n))&&(e.exports=o)},127:function(e,t,r){/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */
!function(t,n,o){void 0!==e&&e.exports?e.exports=o():r(128)("bowser",o)}(0,0,function(){function e(e){function t(t){var r=e.match(t);return r&&r.length>1&&r[1]||""}function r(t){var r=e.match(t);return r&&r.length>1&&r[2]||""}var n,o=t(/(ipod|iphone|ipad)/i).toLowerCase(),i=/like android/i.test(e),s=!i&&/android/i.test(e),c=/nexus\s*[0-6]\s*/i.test(e),u=!c&&/nexus\s*[0-9]+/i.test(e),f=/CrOS/.test(e),l=/silk/i.test(e),d=/sailfish/i.test(e),E=/tizen/i.test(e),g=/(web|hpw)os/i.test(e),I=/windows phone/i.test(e),p=(/SamsungBrowser/i.test(e),!I&&/windows/i.test(e)),_=!o&&!l&&/macintosh/i.test(e),C=!s&&!d&&!E&&!g&&/linux/i.test(e),v=r(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),R=t(/version\/(\d+(\.\d+)?)/i),m=/tablet/i.test(e)&&!/tablet pc/i.test(e),T=!m&&/[^-]mobi/i.test(e),S=/xbox/i.test(e);/opera/i.test(e)?n={name:"Opera",opera:a,version:R||t(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(e)?n={name:"Opera",opera:a,version:t(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||R}:/SamsungBrowser/i.test(e)?n={name:"Samsung Internet for Android",samsungBrowser:a,version:R||t(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(e)?n={name:"Opera Coast",coast:a,version:R||t(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?n={name:"Yandex Browser",yandexbrowser:a,version:R||t(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?n={name:"UC Browser",ucbrowser:a,version:t(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?n={name:"Maxthon",maxthon:a,version:t(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?n={name:"Epiphany",epiphany:a,version:t(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?n={name:"Puffin",puffin:a,version:t(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?n={name:"Sleipnir",sleipnir:a,version:t(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?n={name:"K-Meleon",kMeleon:a,version:t(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:I?(n={name:"Windows Phone",osname:"Windows Phone",windowsphone:a},v?(n.msedge=a,n.version=v):(n.msie=a,n.version=t(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?n={name:"Internet Explorer",msie:a,version:t(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:f?n={name:"Chrome",osname:"Chrome OS",chromeos:a,chromeBook:a,chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(e)?n={name:"Microsoft Edge",msedge:a,version:v}:/vivaldi/i.test(e)?n={name:"Vivaldi",vivaldi:a,version:t(/vivaldi\/(\d+(\.\d+)?)/i)||R}:d?n={name:"Sailfish",osname:"Sailfish OS",sailfish:a,version:t(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?n={name:"SeaMonkey",seamonkey:a,version:t(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(n={name:"Firefox",firefox:a,version:t(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(n.firefoxos=a,n.osname="Firefox OS")):l?n={name:"Amazon Silk",silk:a,version:t(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?n={name:"PhantomJS",phantom:a,version:t(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?n={name:"SlimerJS",slimer:a,version:t(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?n={name:"BlackBerry",osname:"BlackBerry OS",blackberry:a,version:R||t(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:g?(n={name:"WebOS",osname:"WebOS",webos:a,version:R||t(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(n.touchpad=a)):/bada/i.test(e)?n={name:"Bada",osname:"Bada",bada:a,version:t(/dolfin\/(\d+(\.\d+)?)/i)}:E?n={name:"Tizen",osname:"Tizen",tizen:a,version:t(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||R}:/qupzilla/i.test(e)?n={name:"QupZilla",qupzilla:a,version:t(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||R}:/chromium/i.test(e)?n={name:"Chromium",chromium:a,version:t(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||R}:/chrome|crios|crmo/i.test(e)?n={name:"Chrome",chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?n={name:"Android",version:R}:/safari|applewebkit/i.test(e)?(n={name:"Safari",safari:a},R&&(n.version=R)):o?(n={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},R&&(n.version=R)):n=/googlebot/i.test(e)?{name:"Googlebot",googlebot:a,version:t(/googlebot\/(\d+(\.\d+))/i)||R}:{name:t(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!n.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(n.name=n.name||"Blink",n.blink=a):(n.name=n.name||"Webkit",n.webkit=a),!n.version&&R&&(n.version=R)):!n.opera&&/gecko\//i.test(e)&&(n.name=n.name||"Gecko",n.gecko=a,n.version=n.version||t(/gecko\/(\d+(\.\d+)?)/i)),n.windowsphone||!s&&!n.silk?!n.windowsphone&&o?(n[o]=a,n.ios=a,n.osname="iOS"):_?(n.mac=a,n.osname="macOS"):S?(n.xbox=a,n.osname="Xbox"):p?(n.windows=a,n.osname="Windows"):C&&(n.linux=a,n.osname="Linux"):(n.android=a,n.osname="Android");var h="";n.windows?h=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(t(/Windows ((NT|XP)( \d\d?.\d)?)/i)):n.windowsphone?h=t(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):n.mac?(h=t(/Mac OS X (\d+([_\.\s]\d+)*)/i),h=h.replace(/[_\s]/g,".")):o?(h=t(/os (\d+([_\s]\d+)*) like mac os x/i),h=h.replace(/[_\s]/g,".")):s?h=t(/android[ \/-](\d+(\.\d+)*)/i):n.webos?h=t(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):n.blackberry?h=t(/rim\stablet\sos\s(\d+(\.\d+)*)/i):n.bada?h=t(/bada\/(\d+(\.\d+)*)/i):n.tizen&&(h=t(/tizen[\/\s](\d+(\.\d+)*)/i)),h&&(n.osversion=h);var P=!n.windows&&h.split(".")[0];return m||u||"ipad"==o||s&&(3==P||P>=4&&!T)||n.silk?n.tablet=a:(T||"iphone"==o||"ipod"==o||s||c||n.blackberry||n.webos||n.bada)&&(n.mobile=a),n.msedge||n.msie&&n.version>=10||n.yandexbrowser&&n.version>=15||n.vivaldi&&n.version>=1||n.chrome&&n.version>=20||n.samsungBrowser&&n.version>=4||n.firefox&&n.version>=20||n.safari&&n.version>=6||n.opera&&n.version>=10||n.ios&&n.osversion&&n.osversion.split(".")[0]>=6||n.blackberry&&n.version>=10.1||n.chromium&&n.version>=20?n.a=a:n.msie&&n.version<10||n.chrome&&n.version<20||n.firefox&&n.version<20||n.safari&&n.version<6||n.opera&&n.version<10||n.ios&&n.osversion&&n.osversion.split(".")[0]<6||n.chromium&&n.version<20?n.c=a:n.x=a,n}function t(e){return e.split(".").length}function r(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function n(e){for(var n=Math.max(t(e[0]),t(e[1])),o=r(e,function(e){var o=n-t(e);return e+=new Array(o+1).join(".0"),r(e.split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--n>=0;){if(o[0][n]>o[1][n])return 1;if(o[0][n]!==o[1][n])return-1;if(0===n)return 0}}function o(t,r,o){var i=s;"string"==typeof r&&(o=r,r=void 0),void 0===r&&(r=!1),o&&(i=e(o));var a=""+i.version;for(var c in t)if(t.hasOwnProperty(c)&&i[c]){if("string"!=typeof t[c])throw new Error("Browser version in the minVersion map should be a string: "+c+": "+String(t));return n([a,t[c]])<0}return r}function i(e,t,r){return!o(e,t,r)}var a=!0,s=e("undefined"!=typeof navigator?navigator.userAgent||"":"");return s.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if("string"==typeof r&&r in s)return!0}return!1},s.isUnsupportedBrowser=o,s.compareVersions=n,s.check=i,s._detect=e,s.detect=e,s})},128:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},129:function(e,t,r){var n,o;!function(i,a,s){void 0!==e&&e.exports?e.exports=s():(n=s,void 0!==(o="function"==typeof n?n.call(t,r,t,e):n)&&(e.exports=o))}(0,0,function(){"use strict";var e=function(e){var t,r;t=Array.prototype.forEach,r=Array.prototype.map,this.each=function(e,r,n){if(null!==e)if(t&&e.forEach===t)e.forEach(r,n);else if(e.length===+e.length){for(var o=0,i=e.length;o<i;o++)if(r.call(n,e[o],o,e)==={})return}else for(var a in e)if(e.hasOwnProperty(a)&&r.call(n,e[a],a,e)==={})return},this.map=function(e,t,n){var o=[];return null==e?o:r&&e.map===r?e.map(t,n):(this.each(e,function(e,r,i){o[o.length]=t.call(n,e,r,i)}),o)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)};return e.prototype={get:function(){var e=[];if(e.push(navigator.userAgent),e.push(navigator.language),e.push(screen.colorDepth),this.screen_resolution){var t=this.getScreenResolution();void 0!==t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(this.hasIndexDb()),document.body?e.push(typeof document.body.addBehavior):e.push("undefined"),e.push(typeof window.openDatabase),e.push(navigator.cpuClass),e.push(navigator.platform),e.push(navigator.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},murmurhash3_32_gc:function(e,t){var r,n,o,i,a,s,c,u;for(r=3&e.length,n=e.length-r,o=t,a=3432918353,s=461845907,u=0;u<n;)c=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,c=(65535&c)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*s+(((c>>>16)*s&65535)<<16)&4294967295,o^=c,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=27492+(65535&i)+((58964+(i>>>16)&65535)<<16);switch(c=0,r){case 3:c^=(255&e.charCodeAt(u+2))<<16;case 2:c^=(255&e.charCodeAt(u+1))<<8;case 1:c^=255&e.charCodeAt(u),c=(65535&c)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*s+(((c>>>16)*s&65535)<<16)&4294967295,o^=c}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(e){return!0}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(e){return!0}},hasIndexDb:function(){try{return!!window.indexedDB}catch(e){return!0}},isCanvasSupported:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},getPluginsString:function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},getRegularPluginsString:function(){return this.map(navigator.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{return new ActiveXObject(e),e}catch(e){return null}}).join(";")}return""},getScreenResolution:function(){return this.screen_orientation?screen.height>screen.width?[screen.height,screen.width]:[screen.width,screen.height]:[screen.height,screen.width]},getCanvasFingerprint:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),r="http://valve.github.io";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(r,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(r,4,17),e.toDataURL()}},e})},130:function(e,t,r){var n,o;n=[],void 0!==(o=function(){function e(e){switch(e.PARAMS.CODE){case"0507":case"0508":GINI_StandbyCallBack.getCallback(e.TRANS_SEQ)(e);break;case"1912":break;case"0608":GINI_StandbyCallBack.getExceptionCallback(e.TRANS_SEQ)&&GINI_StandbyCallBack.getExceptionCallback(e.TRANS_SEQ)(e);break;default:r.proc(e),GINI_StandbyCallBack.getExceptionCallback(e.TRANS_SEQ)&&GINI_StandbyCallBack.getExceptionCallback(e.TRANS_SEQ)(e)}}var t=cwui_conf.msgFactory,r=cwui_conf.errorCodeFactory,n=cwui_conf.utils;return{proc:function(r){try{if(r)if(r=decodeURIComponent(r),r=r.replace(/\+/g," "),r=JSON.parse(r),r.EXTERNAL&&"NOT_SUPPORT"===r.EXTERNAL)INI_HANDLE.infoMessage("This service is not supported.");else if(r.EXTERNAL&&"NOT_INSTALL"===r.EXTERNAL)"GET_VERSION"===r.COMMAND&&GINI_StandbyCallBack.getCallback(r.TRANS_SEQ)(r,!0),GINI_3rd_Party_Control.extensionPKI.showInstallPage();else{var o=decodeURIComponent(r.PARAMS.STATE);if("GET_PC_INFO"===r.COMMAND)GINI_StandbyCallBack.getCallback(r.TRANS_SEQ)(r);else if("SUCCEEDED"===o)if("EXPORT_FILE_CERT"===r.COMMAND){var i=GINI_StandbyCallBack.getCallback(r.TRANS_SEQ);i&&i(r)}else"CHECK_DEVICE_CONNECT"!==r.COMMAND&&GINI_StandbyCallBack.getCallback(r.TRANS_SEQ)(r);else"GET_DEVICE_LIST"==r.COMMAND&&"0402"==r.PARAMS.CODE?GINI_StandbyCallBack.getCallback(r.TRANS_SEQ)(r):"CHECK_DEVICE_CONNECT"==r.COMMAND&&"0506"==r.PARAMS.CODE?GINI_StandbyCallBack.getExceptionCallback(r.TRANS_SEQ)&&GINI_StandbyCallBack.getExceptionCallback(r.TRANS_SEQ)(r):("ISSUE_CERT"==r.COMMAND&&GINI_LoadingIndicatorStop("issuePubCA"),e(r))}}catch(e){if(n.Log.error("[ERROR] responseProc, exception : ",e),n.Log.error("[ERROR] responseProc, response : ",r),"ISSUE_CERT"===r.COMMAND){var a=t.getMessageFactory().Error.ERR_7001+"<br>"+t.getMessageFactory().Error.ERR_7015;INI_ALERT(a,"ERROR")}}}}}.apply(t,n))&&(e.exports=o)},131:function(e,t,r){(function(n){var o,a;o=[r(69)],void 0!==(a=function(e){function t(e){if(null==e)return null;var t=e.split("&"),r=t[0],n=t[1];return"success"==r.split("=")[1]?null!=n?decodeURIComponent(n):"success":(alert(decodeURIComponent(n.split("=")[1])),null)}function r(i){if(null==a||""==a||void 0==a)return void alert("request_id error");n.ajax({type:"post",url:c.BaroSign.BaroSign_Server,dataType:"TEXT",data:{action:"requestResult",rid:a},success:function(n,a,u){if(null!=(n=t(n))){if("success"==n)return;o(n)?(i===c.WebForm.ACTION_LOGIN&&e.Certs.setSelectedCertInfo(c.Certs.STORAGE_BAROSIGN,"","",s),window.barosignCallback()):setTimeout(function(){r(i)},2e3)}else f.Log.debug("[barosignCore] fail(2)")},tryCount:0,retryLimit:1,error:function(e,t,r){if(++this.tryCount<=this.retryLimit)return void n.ajax(this);f.Log.error("code:"+e.status+"\nmessage:"+e.responseText+"\nstatus:"+t+"\nerror:"+r)}})}function o(e){var t=e.split("&");for(i=0;i<t.length;i++){var r=t[i].split("=")[0].trim();if(f.Log.debug("[barosignCore] key: "+r),"ret"==r){var o=t[i].split("=")[1];if(f.Log.debug("[barosignCore] retcode: "+o),null==o||""==o||"1"!=o)return"2"!=o&&"3"==o}else if("retdata"==r)n("#barosign_securedata",window.document).val(t[i].split("=")[1]);else{if("clientPushId"!=r)return!1;s=t[i].split("=")[1]}}return!0}var a,s,c=cwui_conf.constants,u=cwui_conf.system,f=cwui_conf.utils,l=c.BaroSign.BaroSign_install_guide,d=function(o,i){n.ajax({type:"post",url:c.BaroSign.BaroSign_Server,dataType:"TEXT",data:o,success:function(n,o,s){if(null!=n){for(var u=t(n),d=new Map,p=u.split("&"),_=0;_<p.length;_++){var C=p[_].split("=")[0],v=p[_].substring(p[_].indexOf("=")+1,p[_].length);v=v.replace(/\n/g,""),d.put(C,v),f.Log.debug("[barosignCore]"+C+" : "+v)}for(var R=l+d.get("qrData").trim(),m="pc",T=new Array("iPhone","iPod","iPad","BlackBerry","Android","Windows CE","LG","MOT","SAMSUNG","SonyEricsson"),_=0;_<T.length;_++)if(null!=nAgt.match(T[_])){m="mobile";break}if("mobile"===m)E("qrcode",R),g(R);else if(i===c.WebForm.ACTION_LOGIN)E("qrcode",R);else if(i===c.WebForm.ACTION_SIGN){var S=e.Certs.getSelectedCertInfo();S&&S.clientPushId&&I(R,S.clientPushId),E("qrcode",R)}a=d.get("rid"),setTimeout(function(){r(i)},3e3)}else f.Log.debug("[barosignCore] fail")},tryCount:0,retryLimit:1,error:function(e,t,r){if(++this.tryCount<=this.retryLimit)return void n.ajax(this);f.Log.error("code:"+e.status+"\nmessage:"+e.responseText+"\nstatus:"+t+"\nerror:"+r)}})},E=function(e,t){var r=GINI_HTML5_BASE_PATH+"/res/form/pc/common/message/barosign_qr.html";n.ajax({url:r,global:!1,success:function(r,o,i){n("<div id='INI_barosign_qr_modal'>"+r+"</div>").dialog({modal:!0,width:"300px",height:"300px",resizable:!1,draggable:!0,closeOnEscape:!1,stack:!1,show:{effect:"puff",duration:400,complete:function(){}},position:{my:"top",at:"#INI_mainModalDialog",collision:"none"},open:function(e,t){n(".ini-ui-dialog-titlebar").hide(),n(".ini-ui-dialog").css("overflow","visible"),n("#INI_barosign_qr_modal").css("overflow","visible")},close:function(e,t){n(this).remove()}}),new QRCode(document.getElementById(e),{width:170,height:170,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.L}).makeCode(t)},tryCount:0,retryLimit:1,error:function(e,t,r){if(++this.tryCount<=this.retryLimit)return void n.ajax(this);f.Log.error("code:"+e.status+"\nmessage:"+e.responseText+"\nstatus:"+t+"\nerror:"+r),INI_HANDLE.infoMessage("ERROR : "+e),n(this).remove()}})},g=function(e){var t=u.Android.getAndroidVersion(),r=window.navigator.userAgent.toLowerCase(),n=e.trim();if(t>=4.4&&-1==r.indexOf("firefox")&&-1==r.indexOf("opera")&&-1==r.indexOf("opr"))window.location.href="intent://"+n+"/#Intent;scheme=barosign;package=com.initech.barosign.client;end";else if(-1!=r.indexOf("chrome")||-1!=r.indexOf("firefox")){var o=window.open(n);sleep(1e3),null!=o&&o.close()}},I=function(e,t){n.ajax({type:"post",url:GINI_HTML5_BASE_PATH+"/initech/barosign/barosign_push_service.jsp",dataType:"TEXT",data:{clientPushId:t,qrData:e},success:function(e,t,r){f.Log.debug("push send success")},tryCount:0,retryLimit:1,error:function(e,t,r){if(++this.tryCount<=this.retryLimit)return void n.ajax(this);f.Log.error("code:"+e.status+"\nmessage:"+e.responseText+"\nstatus:"+t+"\nerror:"+r)}})};return{makeBaroSignQRData:d,showQRBarcode:E,callBaroSignApp:g,pushSendQrdata:I}}.apply(t,o))&&(e.exports=a)}).call(t,r(0))},132:function(e,t,r){(function(n){var o,i;o=[r(8)],void 0!==(i=function(e){var t=cwui_conf.defaultConf,r=cwui_conf.utils,o=cwui_conf.constants;return{importCertPriV11:function(t,n){t=t.split("$")[1];var i=e.Factory.Cipher.doDigest(o.Cipher.HASH_SHA1,n),a=e.Factory.Cipher.doDigest(o.Cipher.HASH_SHA1,i);return a=e.Factory.Util.createBuffer(a),i=e.Factory.Util.createBuffer(i),a=a.data.slice(0,16),i=i.data.slice(0,16),r.Log.debug("key : "+e.Factory.Util.bytesToHex(a)),r.Log.debug("iv : "+e.Factory.Util.bytesToHex(i)),t=decodeURIComponent(t),t=e.Factory.Util.decode64(t),e.Factory.Cipher.symmetricDecrypt(o.Cipher.SYMM_SEED_CBC,a,i,e.Factory.Util.createBuffer(t)).data.split("||")},getImportAuthNum:function(e){var n="SVer=1.1&Action=REQ_AUTHCODE&Size=8";r.Log.debug("postdata : "+n);var i=t.System.UrlAddress[o.System.URL_CERT_RELAY_IMPORT_V11];r.Log.debug("Authnum url : "+i);var a=r.Transfer.xmlHttpRequest(i,n).trim();a=a.split("$"),a=a[1],e(a)},importCertV11:function(e,n){var i="AuthNum="+e.serviceInfo.getParameter("AUTH_NUM"),a="SVer=1.1&Action=IMPORT&"+i;r.Log.debug("postdata : "+a);var s=t.System.UrlAddress[o.System.URL_CERT_RELAY_IMPORT_V11],i=r.Transfer.xmlHttpRequest(s,a).trim();n(i)},exportCertV11:function(n,i){var a=n.serviceInfo.getParameter("AUTH_NUM"),s=e.Factory.Cipher.doDigest(o.Cipher.HASH_SHA1,a),c=e.Factory.Cipher.doDigest(o.Cipher.HASH_SHA1,s);c=e.Factory.Util.createBuffer(c),s=e.Factory.Util.createBuffer(s),c=c.data.slice(0,16),s=s.data.slice(0,16);var u=e.Factory.PriKey.extractP12PriCert(n.serviceInfo.getParameter("p12"),"NONCE"),f=u.certificate,l=e.Factory.Util.privateKeyPemTagRemove(u.privateKey),d=l.trim()+"||"+f.trim(),E=e.Factory.Cipher.symmetricEncrypt(o.Cipher.SYMM_SEED_CBC,c,s,e.Factory.Util.createBuffer(d));E=e.Factory.Util.encode64(E.getBytes());var g="Size="+(t.System.UseCertrelay12digitauthcode?12:8),a="AuthNum="+n.serviceInfo.getParameter("AUTH_NUM"),E="EncCert="+encodeURIComponent(E),I="SVer=1.1&Action=EXPORT&"+E+"&"+a+"&"+g;r.Log.debug("postdata : "+I);var p=t.System.UrlAddress[o.System.URL_CERT_RELAY_EXPORT_V11];i(r.Transfer.xmlHttpRequest(p,I).trim())},importCertV12:function(e,n){var i="AuthNum="+e.serviceInfo.getParameter("AUTH_NUM"),a="OpenStorage="+e.serviceInfo.getParameter("OPEN_STORAGE"),s="SVer=1.2&Action=IMPORT&"+i+"&"+a;r.Log.debug("postdata : "+s);var c=t.System.UrlAddress[o.System.URL_CERT_RELAY_IMPORT],u=r.Transfer.xmlHttpRequest(c,s).trim();u=u.split("$"),"OK"===u[0]?n(u[1]):INI_HANDLE.infoMessage(u[2])},exportCertV12:function(e,n){var i="Size="+(t.System.UseCertrelay12digitauthcode?12:8),a="EncCert="+encodeURIComponent(e.serviceInfo.getParameter("p12")),s="SVer=1.2&Action=EXPORT&"+a+"&"+i;r.Log.debug("postdata : "+s);var c=t.System.UrlAddress[o.System.URL_CERT_RELAY_EXPORT],u=r.Transfer.xmlHttpRequest(c,s).trim();u=u.split("$"),"OK"===u[0]?n(u[1]):INI_HANDLE.infoMessage(u[2])},getCertStatus:function(e,i,a){var e="AuthNum="+e,s="SVer=1.2&Action=GET_STATUS&"+e;r.Log.debug("postdata : "+s);var c=t.System.UrlAddress[o.System.URL_CERT_RELAY_IMPORT],u=r.Transfer.xmlHttpRequest(c,s).trim();u=u.split("$"),"OK"===u[0]?i(u):("ERROR"===u[0]&&("NO_STATUS"===u[1]?i(u):"14006"===u[1]&&i(u)),"00:00"===n("#INI_timer").text&&(INI_HANDLE.infoMessage(u[2]),a()))},setCertStatus:function(e){var n="AuthNum="+e.serviceInfo.getParameter("AUTH_NUM"),i="Status="+e.serviceInfo.getParameter("CERT_STATUS"),a="SVer=1.2&Action=SET_STATUS&"+n+"&"+i;r.Log.debug("postdata : "+a);var s=t.System.UrlAddress[o.System.URL_CERT_RELAY_IMPORT],c=r.Transfer.xmlHttpRequest(s,a).trim();c=c.split("$"),"OK"===c[0]?e.serviceInfo.getCallback()&&e.serviceInfo.getCallback()(c):INI_HANDLE.infoMessage(c[2])}}}.apply(t,o))&&(e.exports=i)}).call(t,r(0))},133:function(e,t,r){var n,o;n=[],void 0!==(o=function(){function e(e){var t,r,n,o,i,a=e;!function(){function e(){this._param={}}e.prototype.initialize=function(){for(key in this._param)this._param[key]=void 0},e.prototype.clear=function(){this._param={}},e.prototype.destroy=function(e){e?this._param[e]=0:this._param={}},e.prototype.setParameter=function(e,t){this._param[e]=t},e.prototype.getParameter=function(e){return e?this._param[e]:this._param},t=new e,t.init=function(){t.initialize(),this._callback=void 0,this._subCallback=void 0,this._isSub=!1},t.cls=function(){t.clear(),this._callback=void 0,this._subCallback=void 0,this._isSub=!1},t.setCallback=function(e){this._callback=e},t.setSubCallback=function(e){this._subCallback=e},t.getCallback=function(){return this._callback},t.getSubCallback=function(){return this._subCallback},t.setSelectedSubCallback=function(){this._isSub=!0},t.getSelectedSubCallback=function(){return this._isSub},r=new e,r.init=function(){r.initialize(),this._callback=null,this._exceptionCallback=null,this._deviceId=null,this._eventDeviceId=null,this._deviceSub=null,this._PrevdeviceId=null,this._PrevdeviceSubId=null,this._UseOpenStorage=!0,this._OpenStorage=null,this._OpenStorageDisplayMode=null,this._decryptedBrowserCert=null,this._certlist=null,this._readOnlyLocal=!1,this._readOnlyOpen=!1},r.clear=function(e){e&&r.clear(),this._callback=void 0,this._exceptionCallback=void 0,this._deviceId=void 0,this._eventDeviceId=void 0,this._deviceSub=void 0,this._PrevdeviceId=void 0,this._PrevdeviceSubId=void 0,this._UseOpenStorage=!1,this._OpenStorage=null,this._OpenStorageDisplayMode=null,this._decryptedBrowserCert=null,this._certlist=null,this._readOnlyLocal=!1,this._readOnlyOpen=!1},r.setAction=function(e){this._action=e},r.getAction=function(){return this._action},r.setBehavior=function(e){this._behavior=e},r.getBehavior=function(){return this._behavior},r.setEventDeviceId=function(e){switch(e){case"LOCAL_DISK":case"REMOVABLE_DISK":case"CLOUD":case"BAROSIGN":case"SECURITY_DEVICE":case"HSM":case"SECURITY_TOKEN":case"MOBILE":case"SMART_CARD":case"SMART_CERTIFY":break;default:this._deviceId=e}this._eventDeviceId=e},r.getEventDeviceId=function(){return this._eventDeviceId},r.setDeviceId=function(e){this._deviceId=e},r.getDeviceId=function(){return this._deviceId?this._deviceId:""},r.setPrevDeviceId=function(e){this._PrevdeviceId=e},r.getPrevDeviceId=function(){return this._PrevdeviceId?this._PrevdeviceId:""},r.setPrevDeviceSubId=function(e){this._PrevdeviceSubId=e},r.getPrevDeviceSubId=function(){return this._PrevdeviceSubId?this._PrevdeviceSubId:""},r.setUseOpenStorage=function(e){this._UseOpenStorage=e},r.getUseOpenStorage=function(){return this._UseOpenStorage},r.setOpenStorage=function(e){this._OpenStorage=e},r.getOpenStorage=function(){return this._OpenStorage},r.setDecryptedBrowserCert=function(e){this._decryptedBrowserCert=e},r.getDecryptedBrowserCert=function(){return this._decryptedBrowserCert},r.setOpenStorageDisplayMode=function(e){this._OpenStorageDisplayMode=e},r.getOpenStorageDisplayMode=function(){return this._OpenStorageDisplayMode},r.setDeviceSub=function(e){this._deviceSub=e,this._deviceId=this._eventDeviceId},r.getDeviceSub=function(){return this._deviceSub?this._deviceSub:""},r.setCallback=function(e){this._callback=e},r.getCallback=function(){return this._callback},r.setExceptionCallback=function(e){this._exceptionCallback=e},r.getExceptionCallback=function(){return this._exceptionCallback},r.setCertlist=function(e){this._certlist=e},r.getCertlist=function(){return this._certlist},r.setReadOnlyLocal=function(e){this._readOnlyLocal=e},r.getReadOnlyLocal=function(){return this._readOnlyLocal},r.setReadOnlyOpen=function(e){this._readOnlyOpen=e},r.getReadOnlyOpen=function(){return this._readOnlyOpen},n=new e,o=new e,i=function(){var e,t,r;return{initialize:function(){e=void 0,t=void 0,r=void 0},setResult:function(n,o,i){e=n,t=o,r=i},getResultCode:function(){return e},getResultMsg:function(){return t},getError:function(){return r}}}()}();var s=function(){return a},c=function(e){r.clear(e),i.initialize()};return{getTransactionId:s,initialize:function(){t.init(),r.init(),n.initialize(),o.initialize(),i.initialize()},clear:c,requestInfo:t,optionInfo:n,serviceInfo:r,responseInfo:o,stateInfo:i}}var t={},r=0;return{newHandleInfo:function(){++r;var n;try{var o=INIforgeCrypto;n=o.random.getBytesSync(64);for(var i=0;i<1e3;i++){var a=o.random.getBytesSync(64);if(n!=a){n=a+r;break}}}catch(e){n=Math.random()}var s=new e(n);return t[n]=s,s},getHandleInfo:function(e){return t[e]}}}.apply(t,n))&&(e.exports=o)},25:function(e,t,r){var n,o;n=[r(10)],void 0!==(o=function(e){var t=cwui_conf.defaultConf,r=cwui_conf.utils,n=cwui_conf.constants,o=cwui_conf.unihan,i=cwui_conf.msgFactory,a=INIforgeCrypto,s=function(){var e=a.pki.rsa.createKeyPairGenerationState(2048),o=function(){a.pki.rsa.stepKeyPairGenerationState(e,100)||setTimeout(o,100)};setTimeout(o,0);var i={};return{genernaeKeyPair:function(){if(e.keys&&e.keys.privateKey&&e.keys.publicKey)i.PRIVATE_KEY=e.keys.privateKey,i.PUBLIC_KEY=e.keys.publicKey;else try{if(i.PRIVATE_KEY&&i.PUBLIC_KEY)i.PRIVATE_KEY=i.PRIVATE_KEY,i.PUBLIC_KEY=i.PUBLIC_KEY;else{var o=t.System.UrlAddress[n.System.URL_KEY_PAIR],s=r.Transfer.xmlHttpRequest(o,"");s=decodeURIComponent(s),s=s.split("|"),i.PRIVATE_KEY=a.pki.privateKeyFromAsn1(a.asn1.fromDer(d.decode64(s[0]))),i.PUBLIC_KEY=a.pki.publicKeyFromAsn1(a.asn1.fromDer(d.decode64(s[1])))}}catch(e){var c=a.pki.rsa.generateKeyPair(2048);i.PRIVATE_KEY=c.privateKey,i.PUBLIC_KEY=c.publicKey}return i}}}(),c=function(){return{extractRsaPrivateKeyByPwd:function(t,r){try{if(t.indexOf("-----BEGIN RSA PRIVATE KEY-----")<0){t=d.privateKeyPemTagAdd(t);var n=a.pki.encryptedPrivateKeyFromPem(t),o=a.pki.decryptPrivateKeyInfo(n,r),i=a.pki.privateKeyFromAsn1(o);return i}var i=a.pki.decryptRsaPrivateKey(t,r);if(!i)throw new Error("Invalid password");return i}catch(t){new e.Warn.newThrow(t,"WARN_1001")}},extractRsaPrivateKey:function(e,t){return c.extractRsaPrivateKeyByPwd(e,GINI_ProtectMgr.extract(t))},extractP12Cert:function(t){try{var n=a.util.binary.base64.decode(t),o=new a.util.ByteStringBuffer(n),i=a.asn1.fromDer(o),s=a.pkcs12.certFromP12Asn1(i),c=s.getBags({bagType:a.pki.oids.certBag}),u=c[a.pki.oids.certBag][0];if(!u)return;return a.pki.certificateToPem(u.cert)}catch(t){r.Log.error("e :",t),new e.Warn.newThrow(t,"WARN_1001")}},extractP12PriCert:function(t,r){try{var n=a.util.binary.base64.decode(t),o=new a.util.ByteStringBuffer(n),i=a.asn1.fromDer(o),s=a.pkcs12.pkcs12FromAsn1(i,GINI_ProtectMgr.extract(r)),c=s.getBags({bagType:a.pki.oids.certBag}),u=c[a.pki.oids.certBag][0],f=c[a.pki.oids.certBag][1],l=s.getBags({bagType:a.pki.oids.pkcs8ShroudedKeyBag}),d=l[a.pki.oids.pkcs8ShroudedKeyBag][0],E=l[a.pki.oids.pkcs8ShroudedKeyBag][1];if(!d){var g=s.getBags({bagType:a.pki.oids.keyBag});d=g[a.pki.oids.keyBag][0],E=g[a.pki.oids.keyBag][1]}var I=a.pki.certificateToPem(u.cert),p=a.pki.encryptPrivateKey(d.key,GINI_ProtectMgr.extract(r)),_="",C="";return f&&(_=a.pki.certificateToPem(f.cert),C=a.pki.encryptPrivateKey(E.key,GINI_ProtectMgr.extract(r))),{privateKey:p,certificate:I,KMprivateKey:C,KMcertificate:_}}catch(t){new e.Warn.newThrow(t,"WARN_1001")}},makeCertPriP12:function(t,r){try{var n=a.util.binary.base64.decode(t),o=new a.util.ByteStringBuffer(n),i=a.asn1.fromDer(o),s=a.pkcs12.pkcs12FromAsn1(i,r),c=s.getBags({bagType:a.pki.oids.certBag}),u=c[a.pki.oids.certBag][0];u.cert||(u=c[a.pki.oids.certBag][1]);var f=s.getBags({bagType:a.pki.oids.pkcs8ShroudedKeyBag}),l=f[a.pki.oids.pkcs8ShroudedKeyBag][0];l||(f=s.getBags({bagType:a.pki.oids.keyBag}),l=f[a.pki.oids.keyBag][0]);var d;l.key?d=l.key:(l=f[a.pki.oids.keyBag][1],d=l.key);var E=a.pki.certificateToPem(u.cert);return{privateKey:a.pki.encryptPrivateKey(d,r),certificate:E}}catch(t){new e.Warn.newThrow(t,"WARN_1001")}},makeP12CertPri:function(e,t){var r=c.extractRsaPrivateKeyByPwd(e.privateKey,t),n=a.pkcs12.toPkcs12Asn1(r,e.certificate,t,{algorithm:"3des"}),o=a.asn1.toDer(n).getBytes();return a.util.encode64(o)},rebuildCertPriP12:function(e,t){var r=c.extractRsaPrivateKey(e.privateKey,t),n=[],o=[];n.push(e.certificate),o.push(r),e.kmCertificate&&e.kmPrivateKey&&(n.push(e.kmCertificate),o.push(c.extractRsaPrivateKey(e.kmPrivateKey,t)));var i=a.pkcs12.toPkcs12Asn1(o,n,GINI_ProtectMgr.extract(t),{algorithm:"3des"}),s=a.asn1.toDer(i).getBytes();return a.util.encode64(s)},publicKeyFromPem:function(e){return a.pki.publicKeyFromPem(e)},publicKeyToPem:function(e){return a.pki.publicKeyToPem(e)},publicKeyToRSAPublicKeyPem:function(e){return a.pki.publicKeyToRSAPublicKeyPem(e)},privateKeyToPem:function(e,t){return a.pki.privateKeyToPem(e,t)}}}(),u=function(){var o=function(o){try{o=d.certPemTagAdd(o);var i,s,c=a.pki.certificateFromPem(o),u=c.serialNumber,f=parseInt("0x"+c.serialNumber),l=a.pki.objToDN(c.subject),E=c.subject.getField("C")&&a.util.decodeUtf8(c.subject.getField("C").value),g=c.subject.getField("O")&&a.util.decodeUtf8(c.subject.getField("O").value),I=c.subject.getField("OU")&&a.util.decodeUtf8(c.subject.getField("OU").value),p=c.subject.getField("CN")&&a.util.decodeUtf8(c.subject.getField("CN").value),_=p.lastIndexOf(")"),C=_>0?p.substring(0,_+1):p,v=C,R=_>0&&p.length>=_+4?p.substring(_+3,_+5):"",m=c.issuer.getField("C")&&a.util.decodeUtf8(c.issuer.getField("C").value),T=c.issuer.getField("O")&&a.util.decodeUtf8(c.issuer.getField("O").value),S=c.issuer.getField("OU")&&a.util.decodeUtf8(c.issuer.getField("OU").value),h=c.issuer.getField("CN")&&a.util.decodeUtf8(c.issuer.getField("CN").value),P=c.validity.notAfter,N=c.getExtension("certificatePolicies"),y=a.pki.oids[c.signatureOid],A=y.substring(0,y.indexOf("With")),O=c.issuer.getField("O")&&c.issuer.getField("O").value;if(N){var b;n.System.LANGUAGE_ENG===t.System.Language?(s=a.pki.oids["ENG_"+N.oid],s=s||a.pki.oids.ENG_undefined,b=a.pki.bankCD["ENG_"+R]):(s=a.pki.oids[N.oid],s=s||a.pki.oids.undefined,b=a.pki.bankCD[R]);var D=c.subject.getField("OU")&&c.subject.getField("OU").value,U=d.setBrowserOU(D);s=U||s+(b?" - "+b:""),i=N.oid}var L={};return L.SERIAL=u,L.SERIAL_INT=f,L.SUBJECT=C,L.SUBJECT_DN=l,L.SUBJECT_C=E,L.SUBJECT_O=g,L.SUBJECT_OU=I,L.SUBJECT_CN=p,L.ISSUER=T,L.ISSUER_C=m,L.ISSUER_O=T,L.ISSUER_OU=S,L.ISSUER_CN=h,L.EXPIRE=r.String.dateTimeToString(P),L.EXPIRE_DATE=r.String.dateToString(P),L.EXPIRE_STATUS=n.Certs.CERT_EXPIRE_STATUS_VALID,L.OID=i,L.OID_NAME=s,L.ISSUER_HASH=c.issuer.hash,L.BEFORE_DT=r.String.dateTimeToString(c.validity.notBefore),L.AFTER_DT=r.String.dateTimeToString(c.validity.notAfter),L.HASH_ALG=A,L.SIMPLE_ISSUER=O,L.SIMPLE_SUBJECT=v,L.SIMPLE_OIDNAME=s,L.PUBLICKEY_OID=c.publicKeyOid,L}catch(t){new e.Error.newThrow(t,"ERR_3001")}},i=function(o){try{o=d.certPemTagAdd(o);var i=a.pki.certificateFromPem(o),s=i.version;s&&(s=s+1+"(0x"+s+")");var c=i.serialNumber;c&&(c="0x"+c),c=parseInt(c)+"("+c+")";var u,f=parseInt("0x"+i.serialNumber),l=a.pki.oids[i.signatureOid],E=l.substring(0,l.indexOf("Encryption")).replace("With",""),g=l.substring(0,l.indexOf("With")),I=a.pki.objToDN(i.issuer),p=i.issuer.getField("C")&&a.util.decodeUtf8(i.issuer.getField("C").value),_=i.issuer.getField("O")&&a.util.decodeUtf8(i.issuer.getField("O").value),C=i.issuer.getField("OU")&&a.util.decodeUtf8(i.issuer.getField("OU").value),v=i.issuer.getField("CN")&&a.util.decodeUtf8(i.issuer.getField("CN").value),R=i.issuer.getField("O")&&a.util.decodeUtf8(i.issuer.getField("O").value),m=i.validity.notBefore,T=i.validity.notAfter,S=a.pki.objToDN(i.subject),h=a.pki.objToDN(i.subject),P=i.subject.getField("C")&&a.util.decodeUtf8(i.subject.getField("C").value),N=i.subject.getField("O")&&a.util.decodeUtf8(i.subject.getField("O").value),y=i.subject.getField("OU")&&a.util.decodeUtf8(i.subject.getField("OU").value),A=i.subject.getField("CN")&&a.util.decodeUtf8(i.subject.getField("CN").value),O=A.lastIndexOf(")"),b=O>0?A.substring(0,O+1):A,D=O>0&&A.length>=O+4?A.substring(O+3,O+5):"",U=i.validity.notAfter,L=i.getExtension("certificatePolicies"),w=a.pki.ResolveExtension(i);if(L){var x;n.System.LANGUAGE_ENG===t.System.Language?(u=a.pki.oids["ENG_"+L.oid],u=u||a.pki.oids.ENG_undefined,x=a.pki.bankCD["ENG_"+D]):(u=a.pki.oids[L.oid],u=u||a.pki.oids.undefined,x=a.pki.bankCD[D]);var F=i.subject.getField("OU")&&i.subject.getField("OU").value,k=d.setBrowserOU(F);u=k||u+(x?" - "+x:"")}var M={};return M.VERSION=s,M.SERIAL=c,M.SERIAL_INT=f,M.SIGNATURE_ALG=E,M.HASH_ALG=g,M.ISSUER=I,M.ISSUER_C=p,M.ISSUER_O=_,M.ISSUER_OU=C,M.ISSUER_CN=v,M.BEFORE_DT=r.String.dateTimeToString(m),M.AFTER_DT=r.String.dateTimeToString(T),M.SUBJECT=S,M.SUBJECT_DN=h,M.SUBJECT_C=P,M.SUBJECT_O=N,M.SUBJECT_OU=y,M.SUBJECT_CN=A,M.AUTH_KEY_ID=w.authKeyId,M.SUBJECT_KEY_ID=w.subjectKeyId,M.KEY_USEAGE=w.keyUse,M.CERT_POLICY=w.certPolicy,M.SUBJECT_ALT_NAME=w.subjectAltName,M.CRL_DISTRIBUTION=w.crlDistribution,M.AUTH_INFO_ACCESS=w.authInfoAccess,M.EXPIRE=r.String.dateTimeToString(U),M.EXPIRE_DATE=r.String.dateToString(U),M.EXPIRE_STATUS=n.Certs.CERT_EXPIRE_STATUS_VALID,M.SIMPLE_SUBJECT=b,M.SIMPLE_ISSUER=R,M.SIMPLE_OIDNAME=u,M}catch(t){new e.Error.newThrow(t,"ERR_3002")}};return{parseCertAttributes:o,getKisaVid:function(t){try{t=d.certPemTagAdd(t);var r=a.pki.certificateFromPem(t);return a.pki.getKisaVid(r)}catch(t){new e.Error.newThrow(t,"ERR_3002")}},certificateFromPem:function(t){try{return t=d.certPemTagAdd(t),a.pki.certificateFromPem(t)}catch(t){new e.Error.newThrow(t,"ERR_3003")}},changePassword:function(t,r,n){try{var o=c.extractRsaPrivateKey(t.privateKey,r);return{privateKey:a.pki.encryptPrivateKey(o,GINI_ProtectMgr.extract(n)),certificate:t.certificate}}catch(t){new e.Error.newThrow(t,"ERR_3004")}},anotherChangePassword:function(t,r,n){try{var o=c.extractRsaPrivateKey(t.serviceInfo.getParameter("PRIVATE_KEY"),r);return{privateKey:a.pki.encryptPrivateKey(o,GINI_ProtectMgr.extract(n)),certificate:t.serviceInfo.getParameter("CERTIFICATE")}}catch(t){new e.Error.newThrow(t,"ERR_3004")}},checkPassword:function(t,r){try{if(void 0!=c.extractRsaPrivateKey(t.privateKey,r))return!0}catch(t){new e.Error.newThrow(t,"ERR_3012")}},certificateDetail:i,issueCertificate:function(e,o){var i=t.System.UrlAddress.CERT_CMP_GATE1,s=t.System.UrlAddress.CERT_CMP_GATE2,c=!1,u={};u.reqCMD="issue",u.caname=e.requestInfo.getParameter("CA_NAME"),u.caip=e.requestInfo.getParameter("CA_IP"),u.caport=e.requestInfo.getParameter("CA_PORT"),u.refCode=e.requestInfo.getParameter("REF_VALUE"),u.authKey=e.requestInfo.getParameter("AUTH_CODE"),u.certId=e.requestInfo.getParameter("CERT_ID"),"YESSIGN"===e.requestInfo.getParameter("CA_NAME")&&(u.certId!==n.Certs.POLICY_BROWSER_PERSONAL&&u.certId!==n.Certs.POLICY_BROWSER_ENTERPRISE||(c=!0,i=t.OpenStorage.WEB_CMP_URL,s=t.OpenStorage.WEB_CMP_URL)),u.cmp_gw_url=i,u.cmp_gw_url2=s,r.Log.debug("cmp url1 :",i),r.Log.debug("cmp url2 :",s),e.serviceInfo.getDeviceId()===n.Certs.STORAGE_SECURITY_TOKEN?(u.passKey=GINI_ProtectMgr.extract("SECURE"),u.passNewKey=GINI_ProtectMgr.extract("SECURE")):(u.passKey=GINI_ProtectMgr.extract("NEW_NONCE"),u.passNewKey=GINI_ProtectMgr.extract("NEW_NONCE_CNF")),c?setTimeout(function(){a.cmp.requestYessSignWebCert(u,o),u=0},10):(a.cmp.requestCert(u,o),u=0)},reIssueCertificate:function(e,o){var i=t.System.UrlAddress.CERT_CMP_GATE1,s=t.System.UrlAddress.CERT_CMP_GATE2,c=!1,u={};u.reqCMD="reissue",u.caname=e.requestInfo.getParameter("CA_NAME"),u.caip=e.requestInfo.getParameter("CA_IP"),u.caport=e.requestInfo.getParameter("CA_PORT"),u.refCode=e.requestInfo.getParameter("REF_VALUE"),u.authKey=e.requestInfo.getParameter("AUTH_CODE"),u.certId=e.requestInfo.getParameter("CERT_ID"),"YESSIGN"===e.requestInfo.getParameter("CA_NAME")&&(u.certId!==n.Certs.POLICY_BROWSER_PERSONAL&&u.certId!==n.Certs.POLICY_BROWSER_ENTERPRISE||(c=!0,i=t.OpenStorage.WEB_CMP_URL,s=t.OpenStorage.WEB_CMP_URL)),u.cmp_gw_url=i,u.cmp_gw_url2=s,r.Log.debug("cmp url1 :",i),r.Log.debug("cmp url2 :",s),e.serviceInfo.getDeviceId()===n.Certs.STORAGE_SECURITY_TOKEN?(u.passKey=GINI_ProtectMgr.extract("SECURE"),u.passNewKey=GINI_ProtectMgr.extract("SECURE")):(u.passKey=GINI_ProtectMgr.extract("NEW_NONCE"),u.passNewKey=GINI_ProtectMgr.extract("NEW_NONCE_CNF")),c?setTimeout(function(){a.cmp.requestYessSignWebCert(u,o),u=0},10):(a.cmp.requestCert(u,o),u=0)},updateCertificate:function(e,o,i){var s=t.System.UrlAddress.CERT_CMP_GATE1,c=t.System.UrlAddress.CERT_CMP_GATE2,u=!1,f={};f.reqCMD="renew",f.caname=e.requestInfo.getParameter("CA_NAME"),f.caip=e.requestInfo.getParameter("CA_IP"),f.caport=e.requestInfo.getParameter("CA_PORT"),f.signCertPem=o.certificate,f.signPriPem=o.privateKey,o.kmCertificate&&(f.kmCertPem=o.kmCertificate),o.kmPrivateKey&&(f.kmPriPem=o.kmPrivateKey),f.certId=e.requestInfo.getParameter("CERT_ID"),"YESSIGN"===e.requestInfo.getParameter("CA_NAME")&&(f.certId!==n.Certs.POLICY_BROWSER_PERSONAL&&f.certId!==n.Certs.POLICY_BROWSER_ENTERPRISE||(u=!0,s=t.OpenStorage.WEB_CMP_URL,c=t.OpenStorage.WEB_CMP_URL)),f.cmp_gw_url=s,f.cmp_gw_url2=c,r.Log.debug("cmp url1 :",s),r.Log.debug("cmp url2 :",c),e.serviceInfo.getDeviceId()===n.Certs.STORAGE_SECURITY_TOKEN?(f.passKey=GINI_ProtectMgr.extract("SECURE"),f.passNewKey=GINI_ProtectMgr.extract("SECURE")):(f.passKey=GINI_ProtectMgr.extract("NONCE"),f.passNewKey=GINI_ProtectMgr.extract("NEW_NONCE")),u?setTimeout(function(){a.cmp.requestYessSignWebCert(f,i),f=0},10):(a.cmp.requestCert(f,i),f=0)},isYessSignWebCert:function(t){if(!t)return!1;if(t.toString().indexOf("-----BEGIN CERTIFICATE-----")<0){var r=t.toLowerCase();return r.indexOf("ou=")>0&&(r.indexOf(n.Certs.BROWSER_PERSONAL_OU.toLowerCase())>0||r.indexOf(n.Certs.BROWSER_ENTERPRISE_OU.toLowerCase()))>0}try{t=d.certPemTagAdd(t);var o=a.pki.certificateFromPem(t);if(o.subject.getField("OU")){var i=o.subject.getField("OU").value;return!!d.setBrowserOU(i)}}catch(t){new e.Error.newThrow(t,"ERR_3002")}}}}(),f=function(){return{pkcs1Sign:function(t,o,i,s,f,d){try{var E=c.extractRsaPrivateKey(t.privateKey,o);if(!d){d=u.parseCertAttributes(t.certificate).HASH_ALG}var g=l.doDigestObj(d,i,f),I=a.util.encode64(E.sign(g));return r.String.isNull(s)||(s[n.Login.SIGNATURE]=I,s[n.Login.VID_RANDOM]=a.util.bytesToHex(E.vidRandom),s[n.Login.VID_CERTIFICATE]=t.certificate),I}catch(t){new e.Error.newThrow(t,"ERR_3005")}},pkcs7Sign:function(i,s,f,d,E,g){function I(e){return C.ORIGIRAL_URL_ENCODE&&(e=decodeURIComponent(e)),C.ORIGIRAL_CHAR_SET!==n.System.CHARACTER_UTF8&&"UTF-8"!==C.ORIGIRAL_CHAR_SET||C.SIGN_CHAR_SET!==n.System.CHARACTER_EUC_KR&&"EUC-KR"!==C.SIGN_CHAR_SET?C.ORIGIRAL_CHAR_SET!==n.System.CHARACTER_EUC_KR&&"EUC-KR"!==C.ORIGIRAL_CHAR_SET||C.SIGN_CHAR_SET!==n.System.CHARACTER_UTF8&&"UTF-8"!==C.SIGN_CHAR_SET?C.SIGN_URL_ENCODE&&(e=encodeURIComponent(e)):e=C.SIGN_URL_ENCODE?o.convertEucKrToUtf8(e,!0):o.convertEucKrToUtf8(e,!1):e=C.SIGN_URL_ENCODE?o.convertUtf8ToEucKr(e,!0):o.convertUtf8ToEucKr(e,!1),e}try{var p=u.parseCertAttributes(i.certificate);g.getParameter("HASH_ALG")||g.setParameter("HASH_ALG",p.HASH_ALG);var _;_=g.getParameter("HASH_ALG")===n.Cipher.HASH_SHA1?a.pki.oids.sha1:g.getParameter("HASH_ALG")===n.Cipher.HASH_SHA512?a.pki.oids.sha512:a.pki.oids.sha256;var C=g.getParameter("CONTENT_ENCODE"),v=c.extractRsaPrivateKey(i.privateKey,s),R=a.pki.oids.rsaEncryption;g.getParameter("RSA_PSS_SIGN")&&(R=a.pki.oids["RSASSA-PSS"]),p.PUBLICKEY_OID===a.pki.oids.kcdsa1&&(R=a.pki.oids.kcdsa1);var m=[];"TRUE"==g.getParameter("IN_VID")&&(m=[{type:a.pki.oids["initech-encrypted-random"]}]),"TRUE"===g.getParameter("YESSIGN_TYPE")||r.String.isNull(g.getParameter("REPLAY_ATTACK_CHECK_DATA"))||(0==m.length?m=[{type:a.pki.oids.replay_attack,data:g.getParameter("REPLAY_ATTACK_CHECK_DATA")}]:m.push({type:a.pki.oids.replay_attack,data:g.getParameter("REPLAY_ATTACK_CHECK_DATA")}));var T=a.pkcs7.createSignedData(),S="";if("TRUE"===g.getParameter("BASE64_DEC")){if(-1!==f.indexOf(t.Signature.MultiDelimiter))return void(E[n.Login.SIGNATURE]="When used base64 encoded binaries, Last element is empty.");var h=a.util.binary.base64.decode(f);f=new a.util.ByteStringBuffer(h).data}if(f.indexOf("&")>-1)for(var P=f.split("&"),N=P.length,y=0;y<N;y++){var A;if(P[y].indexOf("=")>-1){var O=P[y].split("=");A=I(O[0])+"="+I(O[1])}else A=I(P[y]);S=0==y?A:S+"&"+A}else S=I(f);T.content=S,T.addCertificate(u.certificateFromPem(i.certificate));var b=[];"FALSE"==g.getParameter("REMOVE_SIGNED_ATTRIBUTE")&&(b="FALSE"==g.getParameter("REMOVE_TIME_STAMP")?[{type:a.pki.oids.contentType,value:a.pki.oids.data},{type:a.pki.oids.signingTime,value:d},{type:a.pki.oids.messageDigest,value:g.getParameter("CONTENT_HASH")}]:[{type:a.pki.oids.contentType,value:a.pki.oids.data},{type:a.pki.oids.messageDigest,value:g.getParameter("CONTENT_HASH")}]),T.addSigner({key:v,certificate:i.certificate,digestAlgorithm:_,authenticatedAttributes:b,signatureAlgorithm:R,unauthenticatedAttributes:m}),T.sign(),"TRUE"==g.getParameter("REMOVE_CONTENT")&&(T.isRemoveContentInfo=!0),"TRUE"==g.getParameter("REMOVE_CERTIFICATE")&&(T.isRemoveCertificate=!0),"TRUE"==g.getParameter("YESSIGN_TYPE")&&(T.isRemoveContext=!0);var D=a.pkcs7.messageToPem(T);if(!r.String.isNull(E)&&(E[n.Login.SIGNATURE]=D,E[n.Login.VID_CERTIFICATE]=i.certificate,E[n.Login.VID_RANDOM]=a.util.bytesToHex(v.vidRandom),g.getParameter("ENC_SRVCERT"))){var U=a.pkcs7.createEnvelopedData(),L=a.pki.certificateFromPem(g.getParameter("ENC_SRVCERT"));U.addRecipient(L),U.content=a.util.createBuffer(v.vidRandom),U.encrypt();var w=a.asn1.toDer(U.toAsn1()).getBytes(),x=a.util.encode64(w);E[n.Login.VID_RANDOM]=x;var F=u.getKisaVid(i.certificate),k=a.pkcs7.createEnvelopedData(),L=a.pki.certificateFromPem(g.getParameter("ENC_SRVCERT"));k.addRecipient(L),k.content=a.util.createBuffer(F),k.encrypt();var M=a.asn1.toDer(k.toAsn1()).getBytes(),K=a.util.encode64(M);E[n.Login.KISA_VID]=K;var G=a.pki.pemToDer(i.certificate),Y=a.util.encode64(G.data);E[n.Login.VID_CERTIFICATE]=Y;var W=p.HASH_ALG,B=l.doDigestObj(W,f,"UTF-8"),H=a.util.encode64(v.sign(B));E[n.Login.PKCS1_SIGNATURE]=H}return D}catch(t){new e.Error.newThrow(t,"ERR_3006")}},pkcs7AddSign:function(t,o,i,s,f){try{var l=u.parseCertAttributes(t.certificate);s.getParameter("HASH_ALG")||s.setParameter("HASH_ALG",l.HASH_ALG);var d;d=s.getParameter("HASH_ALG")===n.Cipher.HASH_SHA1?a.pki.oids.sha1:s.getParameter("HASH_ALG")===n.Cipher.HASH_SHA512?a.pki.oids.sha512:a.pki.oids.sha256;var E=(s.getParameter("CONTENT_ENCODE"),c.extractRsaPrivateKey(t.privateKey,o)),g=a.pki.oids.rsaEncryption;s.getParameter("RSA_PSS_SIGN")&&(g=a.pki.oids["RSASSA-PSS"]),l.PUBLICKEY_OID===a.pki.oids.kcdsa1&&(g=a.pki.oids.kcdsa1);var I=[];"TRUE"==s.getParameter("IN_VID")&&(I=[{type:a.pki.oids["initech-encrypted-random"]}]),r.String.isNull(s.getParameter("REPLAY_ATTACK_CHECK_DATA"))||(0==I.length?I=[{type:a.pki.oids.replay_attack,data:s.getParameter("REPLAY_ATTACK_CHECK_DATA")}]:I.push({type:a.pki.oids.replay_attack,data:s.getParameter("REPLAY_ATTACK_CHECK_DATA")}));var p=s.getParameter("SIGNED_PKCS7_DATA");p.indexOf("-----BEGIN PKCS7-----")<0&&(p="-----BEGIN PKCS7-----"+p+"-----END PKCS7-----");var _=a.pkcs7.messageFromPem(p);_.addCertificate(u.certificateFromPem(t.certificate));var C=[{type:a.pki.oids.contentType,value:a.pki.oids.data},{type:a.pki.oids.signingTime,value:i},{type:a.pki.oids.messageDigest,value:s.getParameter("CONTENT_HASH")}];_.addSigner({key:E,certificate:t.certificate,digestAlgorithm:d,authenticatedAttributes:C,signatureAlgorithm:g,unauthenticatedAttributes:I}),_.sign(),"TRUE"==s.getParameter("REMOVE_CERTIFICATE")&&(_.isRemoveCertificate=!0),"TRUE"==s.getParameter("REMOVE_CONTENT")&&(_.isRemoveContentInfo=!0);var v=a.pkcs7.messageToPem(_);return r.String.isNull(f)||(f[n.Login.SIGNATURE]=v,f[n.Login.VID_CERTIFICATE]=t.certificate),v}catch(t){new e.Error.newThrow(t,"ERR_3006")}},Util:function(){var e=function(e){return a.pkcs7.messageFromPem(e)};return{messageToPem:function(e){return a.pkcs7.messageToPem(e)},messageFromPem:e}}()}}(),l=function(){function t(t,r,o,i){try{var s;o=o.toLowerCase(),s=o==n.Cipher.HASH_SHA1?a.md.sha1.create():o==n.Cipher.HASH_SHA256?a.md.sha256.create():o==n.Cipher.HASH_SHA384?a.md.sha384.create():o==n.Cipher.HASH_SHA512?a.md.sha512.create():o==n.Cipher.HASH_MD5?a.md.md5.create():a.md.sha256.create(),r="RSA15"==r?"RSAES-PKCS1-V1_5":"RSA-OAEP";return t.encrypt(i,r,{md:s,mgf1:{md:s}})}catch(t){new e.Error.newThrow(t,"ERR_4003")}}var o=function(t,r,n,o){try{var i=a.cipher.createCipher(t,r);return i.start({iv:n}),i.update(o),i.finish(),i.destory(),i.output}catch(t){new e.Error.newThrow(t,"ERR_4001")}},i=function(t,r,n,o){try{var i=a.cipher.createDecipher(t,r);return i.start({iv:n}),i.update(o),i.finish(),i.output}catch(t){new e.Error.newThrow(t,"ERR_4002")}},s=function(e,r,n,o){return t(a.pki.certificateFromPem(e).publicKey,r,n,o)},c=function(e,r,n,o){return t(a.pki.publicKeyFromPem(e),r,n,o)},u=function(t,r,o,i,s){try{var c;o=o.toLowerCase(),c=o==n.Cipher.HASH_SHA1?a.md.sha1.create():o==n.Cipher.HASH_SHA256?a.md.sha256.create():o==n.Cipher.HASH_SHA384?a.md.sha384.create():o==n.Cipher.HASH_SHA512?a.md.sha512.create():o==n.Cipher.HASH_MD5?a.md.md5.create():a.md.sha256.create();var u=a.util.binary.base64.decode(t),f=new a.util.ByteStringBuffer(u),l=a.asn1.fromDer(f),d=a.pki.decryptPrivateKeyInfo(l,s),E=a.pki.privateKeyFromAsn1(d);r="RSA15"==r?"RSAES-PKCS1-V1_5":"RSA-OAEP";return E.decrypt(i,r,{md:c,mgf1:{md:c}})}catch(t){new e.Error.newThrow(t,"ERR_4004")}},f=function(t,o,i){try{var s;return t=t.toLowerCase(),s=t==n.Cipher.HASH_SHA1?a.md.sha1.create():t==n.Cipher.HASH_SHA256?a.md.sha256.create():t==n.Cipher.HASH_SHA384?a.md.sha384.create():t==n.Cipher.HASH_SHA512?a.md.sha512.create():t==n.Cipher.HASH_MD5?a.md.md5.create():a.md.sha256.create(),r.String.isNull(i)?s.update(o):s.update(o,i),s}catch(t){new e.Error.newThrow(t,"ERR_4005")}};return{symmetricEncrypt:o,symmetricDecrypt:i,asymmetricCertEncrypt:s,asymmetricPubKeyEncrypt:c,asymmetricDecrypt:u,doDigest:function(t,r,n){try{return f(t,r,n).digest().getBytes()}catch(t){new e.Error.newThrow(t,"ERR_4006")}},doDigestObj:f,doMac:function(t,r,o){try{var i;return t=t.toLowerCase(),t==n.Cipher.HASH_SHA1?i=a.md.sha1.create():t==n.Cipher.HASH_SHA256?i=a.md.sha256.create():t==n.Cipher.HASH_MD5?i=a.md.md5.create():(t=n.Cipher.HASH_SHA256,i=a.md.sha256.create()),i.start(t,r),i.update(o),i.digest().getBytes()}catch(t){new e.Error.newThrow(t,"ERR_4007")}}}}(),d=function(){var t=function(t){try{return a.util.binary.base64.encode(t)}catch(t){new e.Error.newThrow(t,"ERR_5001")}},r=function(t){try{return a.util.binary.base64.decode(t)}catch(t){new e.Error.newThrow(t,"ERR_5002")}},o=function(t,r){try{return a.util.encode64(t,r)}catch(t){new e.Error.newThrow(t,"ERR_5003")}},s=function(t){try{return a.util.decode64(t)}catch(t){new e.Error.newThrow(t,"ERR_5004")}},c=function(t){try{return a.util.bytesToHex(t)}catch(t){new e.Error.newThrow(t,"ERR_5005")}},u=function(t){try{return a.util.hexToBytes(t)}catch(t){new e.Error.newThrow(t,"ERR_5006")}},f=function(t,r){try{return a.util.createBuffer(t,r)}catch(t){new e.Error.newThrow(t,"ERR_5007")}},l=function(){a.util.ByteStringBuffer.prototype.destory()};return{base64encode:t,base64decode:r,encode64:o,decode64:s,getBytes:function(t){try{return a.random.getBytes(t)}catch(t){new e.Error.newThrow(t,"ERR_5008")}},bytesToHex:c,hexToBytes:u,createBuffer:f,getRandomBytesSync:function(t){try{return a.random.getBytesSync(t)}catch(t){new e.Error.newThrow(t,"ERR_5009")}},pemToDer:function(e){return a.pki.pemToDer(e)},certPemTagAdd:function(e){return e.toString().indexOf("-----BEGIN CERTIFICATE-----")<0&&(e="-----BEGIN CERTIFICATE-----\r\n"+e+"\r\n-----END CERTIFICATE-----"),e},certPemTagRemove:function(e){return e.toString().replace("-----BEGIN CERTIFICATE-----","").replace("-----END CERTIFICATE-----","")},privateKeyPemTagAdd:function(e){return e.toString().indexOf("-----BEGIN ENCRYPTED PRIVATE KEY-----")<0&&e.toString().indexOf("-----BEGIN RSA PUBLIC KEY-----")<0&&(e="-----BEGIN ENCRYPTED PRIVATE KEY-----\r\n"+e+"\r\n-----END ENCRYPTED PRIVATE KEY-----"),e},privateKeyPemTagRemove:function(e){return e.toString().replace("-----BEGIN ENCRYPTED PRIVATE KEY-----","").replace("-----END ENCRYPTED PRIVATE KEY-----","")},rsaPublicKeyPemTagRemove:function(e){return e.toString().replace("-----BEGIN RSA PUBLIC KEY-----","").replace("-----END RSA PUBLIC KEY-----","")},encodeUtf8:function(t){try{return a.util.encodeUtf8(t)}catch(t){new e.Error.newThrow(t,"ERR_5003")}},decodeUtf8:function(t){try{return a.util.decodeUtf8(t)}catch(t){new e.Error.newThrow(t,"ERR_5003")}},arrayIndexOf:function(e,t){return a.util.arrayIndexOf(e,t)},dataDestory:l,parseUrl:function(e){return a.util.parseUrl(e)},getOid:function(e){return a.pki.oids[e]?a.pki.oids[e]:void 0},getBankCD:function(e){return a.pki.bankCD[e]?a.pki.bankCD[e]:void 0},setBrowserOU:function(e){var t;try{return e===n.Certs.BROWSER_PERSONAL_OU?t=i.getMessageFactory().WebForm().TEXT().CERT_DETAIL().W_T_C_D_041:e===n.Certs.BROWSER_ENTERPRISE_OU&&(t=i.getMessageFactory().WebForm().TEXT().CERT_DETAIL().W_T_C_D_042),t}catch(e){return t}}}}();return{PriKey:c,Certs:u,Signature:f,Cipher:l,Util:d,KeyPair:s,forge:a}}.apply(t,n))&&(e.exports=o)},34:function(e,t,r){(function(n){var o,i;o=[r(25),r(8)],void 0!==(i=function(e,t){function r(e,t,r){var n=c(e),i=I.util.createBuffer(n),a=o(t,r),s=i.data.slice(0,16),u=i.data.slice(16,i.data.byteLength),f=I.cipher.createDecipher("AES-CBC",a);f.start({iv:s}),f.update(I.util.createBuffer(u));f.finish();return f.output.bytes()}function o(e,t){var r=c(e),n=c(t),o=I.util.createBuffer(r);return o.putBytes(n),a(o.getBytes())}function i(e,t){var r=e+t,n=a(r);return I.util.bytesToHex(n)}function a(e){var t=0;do{var r=I.md.sha256.create();r.update(e),e=r.digest().getBytes(),t++}while(t<2048);return e}function s(e){for(var t=I.util.encode64(e),r="",n=0;n<t.length;n++){var o=t.charAt(n);r+="+"==o?"-":"/"==o?"_":o}return r}function c(e){for(var t="",r=0;r<e.length;r++){var n=e.charAt(r);t+="-"==n?"+":"_"==n?"/":n}return I.util.decode64(t)}function u(e){if(l.OpenStorage&&"Y"==l.OpenStorage.USE){if(sessionStorage.removeItem("LOAD_OPEN_CERT"),f)e&&e();else{!1===INI_getPlatformInfo().iOS&&GINI_LoadingIndicatorStart(void 0,void 0,"opencert");var t=new Date,r=t.getFullYear(),n=""+(t.getMonth()+1),o=""+t.getDate();n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),d.Log.debug(p,"load opencert.js: start"),d.Transfer.loadjs(l.OpenStorage.OPEN_CERT_URL+"?dt="+r+n+o+"&corp="+l.OpenStorage.CORP_CODE,function(t){if(t)d.Log.debug(p,"load opencert.js: succeeded"),!1===INI_getPlatformInfo().iOS?(d.Log.debug(p,"load relay.js: start"),d.Transfer.loadjs(l.OpenStorage.RELAY_CERT_URL+"?dt="+r+n+o+"&corp="+l.OpenStorage.CORP_CODE,function(t){if(t)d.Log.debug(p,"load relay.js: succeeded"),sessionStorage.setItem("LOAD_OPEN_CERT",t),e&&e();else{d.Log.debug(p,"load relay.js: failed");var r=[];r.OK=function(){e&&e()},sessionStorage.setItem("LOAD_OPEN_CERT",t),"Y"===l.OpenStorage.USE&&(l.OpenStorage.USE="N",l.OpenStorage.CLOUD="N"),INI_ALERT(g.getMessageFactory().Info.INFO_1016,"NOTI",r)}})):(sessionStorage.setItem("LOAD_OPEN_CERT",!0),e&&e());else{d.Log.debug(p,"load opencert.js: failed");var i=[];i.OK=function(){e&&e()},sessionStorage.setItem("LOAD_OPEN_CERT",t),"Y"===l.OpenStorage.USE&&(l.OpenStorage.USE="N",l.OpenStorage.CLOUD="N"),INI_ALERT(g.getMessageFactory().Info.INFO_1016,"NOTI",i)}})}}else e&&e()}var f,l=cwui_conf.defaultConf,d=cwui_conf.utils,E=cwui_conf.constants,g=cwui_conf.msgFactory,I=e.forge,p="[OPEN_STORAGE]",_=function(){this.opencert,this.serverNonce,this.isInit=!1,this.apikey=""};_.prototype.init=function(){return new Promise(function(e,t){if(!f.opencert&&window.OpenCert){f.opencert=window.OpenCert.getInstance(),d.Log.debug(p,"opencert.init: start");var r="blue";l.OpenStorage.CLOUD_UI_COLOR&&(r=l.OpenStorage.CLOUD_UI_COLOR),f.opencert.init(f.apikey,function(r){if(r.error)d.Log.debug(p,"opencert.init: failed:",r.error),t(r.error);else if(INI_getPlatformInfo().iOS){var o=n("#openOpenCertWindow").attr("id");if(void 0!==o)return d.Log.debug("Opencert window visible init fail"),void GINI_LoadingIndicatorStop("opencert");f.isInit=!0,d.Log.debug(p,"opencert.init: succeeded"),f.serverNonce=r.serverNonce,e(f)}else f.isInit=!0,d.Log.debug(p,"opencert.init: succeeded"),f.serverNonce=r.serverNonce,e(f)},r)}else GINI_LoadingIndicatorStop("opencert"),t("error")})},_.prototype.merge=function(e,t,r){var n=t.serviceInfo.getAction(),o=t.serviceInfo.getBehavior(),i=Date.now();return new Promise(function(t,a){var s=function(){if(f.isInit)d.Log.debug(p,"opencert.mergeCertInfos: start:",e),f.opencert.mergeCertInfos(e,function(e){e.error?(d.Log.debug(p,"opencert.mergeCertInfos: failed: code:",e.error.code,"msg:",e.error.message),a(e.error)):n==E.WebForm.ACTION_CERT_IMPORT_CLOUD&&f.opencert.cloudCertInfos&&"function"==typeof f.opencert.cloudCertInfos?f.opencert.cloudCertInfos(function(r){r.error?a(r.error):(d.Log.debug(p,"opencert.cloudCertInfos: succeeded:",r),e.certInfos=[],e.certInfos=r),t(e.certInfos)}):(d.Log.debug(p,"opencert.mergeCertInfos: succeeded:",e.certInfos),"CMP"===n&&"UPDATE"===o&&INI_getPlatformInfo().Mobile&&m(!1),t(e.certInfos))},{mode:r||"tray"});else{Date.now()-i>=5e3?a("error"):setTimeout(s,300)}};setTimeout(s,0)})},_.prototype.set=function(e,t,r,n){var o=t.fingerprint;return new Promise(function(a,s){var c=i(o,r);d.Log.debug(p,"opencert.setPKCS12: start:",e,t),f.opencert.setPKCS12(e,t,c,function(e){e.error?(d.Log.debug(p,"opencert.setPKCS12: failed:",e.error),s(e.error)):(d.Log.debug(p,"opencert.setPKCS12: succeeded:",e),a(e))},{mode:"tray"===n?"tray":"window"})})},_.prototype.get=function(e,t){var n=I.random.getBytes(20),o=f.serverNonce,a=s(n);return new Promise(function(n,s){var c=i(e,t);d.Log.debug(p,"opencert.getPKCS12: start:",e),f.opencert.getPKCS12(e,c,a,function(e){if(e.error)d.Log.debug(p,"opencert.getPKCS12: failed:",e.error),s(e.error);else{var t={};e.pkcs12?(t.pkcs12=r(e.pkcs12,a,o),t.isSave=!0):e.notSavePKCS12&&(t.pkcs12=r(e.notSavePKCS12,a,o),t.isSave=!1),d.Log.debug(p,"opencert.getPKCS12: succeeded",t),n(t)}})})},_.prototype.remove=function(e){return new Promise(function(t,r){d.Log.debug(p,"opencert.removePKCS12: start:",e),f.opencert.removePKCS12(e,function(e){e.error?(d.Log.debug(p,"opencert.removePKCS12: failed:",e.error),r(e.error)):(d.Log.debug(p,"opencert.removePKCS12: succeeded:",e),t(e))})})},_.prototype.close=function(){if(f.isInit)try{window.OpenCert.close&&"function"==typeof window.OpenCert.close&&(d.Log.debug(p,"opencert.close: start"),window.OpenCert.close(),d.Log.debug(p,"opencert.close: succeeded"))}catch(e){d.Log.debug(p,"opencert.close: failed")}};var C=function(){return new Promise(function(e,r){if(l.OpenStorage)if(f)GINI_LoadingIndicatorStop("opencert"),e(f);else{f=new _;var n=l.OpenStorage.API_KEY,o=t.Factory.Util.decode64(n),i=t.Factory.Util.createBuffer(o),a=t.Factory.Cipher.symmetricDecrypt(E.Cipher.SYMM_SEED_CBC,t.Factory.Util.hexToBytes("c22796b7a71f0eff826c19e622e15d86"),t.Factory.Util.hexToBytes("c1884976233ed84e5a65548046ce2c1a"),i);f.apikey=a.data,f.init().then(function(t){GINI_LoadingIndicatorStop("opencert"),e(t)}).catch(function(e){GINI_LoadingIndicatorStop("opencert"),r(e)})}else GINI_LoadingIndicatorStop("opencert"),e(f)})},v=function(){if(f)return f},R=function(e,t){if(f.isInit)try{f&&(d.Log.debug(p,"opencert.setEventListener: start",e),f.opencert.setEventListener(e,t),d.Log.debug(p,"opencert.setEventListener: succeeded"))}catch(e){d.Log.debug(p,"opencert.setEventListener: failed",e)}},m=function(e){try{f&&(d.Log.debug(p,"opencert.setTrayView: start",e),f.opencert.setTrayView(e),d.Log.debug(p,"opencert.setTrayView: succeeded"))}catch(e){d.Log.debug(p,"setTrayView: failed",e)}};return{getInstance:C,LoadOpenCert:u,getOpenstorageObject:v,setEventListener:R,setTrayView:m}}.apply(t,o))&&(e.exports=i)}).call(t,r(0))},65:function(e,t,r){var n,o;n=[r(8),r(10)],void 0!==(o=function(e,t){function n(e){return new Promise(function(t,r){try{if(e){var n=JSON.stringify(e);localStorage.setItem(d.System.INI_PRIVATE_STORAGE,n)}}catch(e){throw e}})}function o(){return new Promise(function(e,t){try{var r=localStorage.getItem(d.System.INI_PRIVATE_STORAGE);r?e(JSON.parse(r)):t()}catch(e){throw e}})}function i(e){return new Promise(function(t){try{for(certKey in e){var r=e[certKey];if(r&&r.INHERENT_C&&r.INHERENT_S){var n=e[certKey].INHERENT_V,o=a(r.INHERENT_C,r.INHERENT_S);e[certKey].INHERENT_V=o,l.Log.debug("check INHERENT_V["+n+"]:["+o+"]")}}t(e)}catch(e){throw e}})}function a(t,r){var n=e.Factory.Util.hexToBytes(t);try{return s(f("",r),n).toString(),"3.1.0.23"}catch(e){try{return s(f(u(),r),n).toString(),"3.1.0.22"}catch(e){try{return s(f(c(),r),n).toString(),"3.1.0.21"}catch(e){return}}}}function s(t,r){var n=t.slice(0,32),o=t.slice(32,64),i=e.Factory.Util.createBuffer(r);return e.Factory.Cipher.symmetricDecrypt(d.Cipher.SYMM_AES_CBC,n,o,i)}function c(){return g.chrome?e.Factory.Util.hexToBytes("b308e4c8654862189eb3152d54a5688c2fef46e8b2c20d0eea7cf330ce96b6da")+e.Factory.Util.hexToBytes("62e89c45f847c9cfe9fe42bdfdee17025a150264eb737b2cf3b8bbc906b02db3"):e.Factory.Util.hexToBytes("93f1a5a04cf7e4c8d728a9b15388c41f3b26a512e57c1ccf8636aca39e292ce8")+e.Factory.Util.hexToBytes("7ef29e358fac8b11bc7261e1d5282e308bfb5be0f67e08d6716b1b1885bf1a66")}function u(){return g.chrome?e.Factory.Util.hexToBytes("85d3afa16c1cff759dcffc80231b9c7eb9ac39f5e3aaf03b6f93cbd5c557207b")+e.Factory.Util.hexToBytes("23b167206a96e472202a936bcfe1fc8d97f24304c0b0a359a9fb18f1d7ca40d0"):e.Factory.Util.hexToBytes("9f84c4b154fd04b823c8da39abeff4c3ccb1077e08af6775ef158a4f836a0d32")+e.Factory.Util.hexToBytes("bb3e7d3a092c90b21fb13fbc6dd7a4ea7d323289955151ba55671f71c2aff66c")}function f(t,r,n){var o=t;l.String.isNull(r)||(o+=e.Factory.Cipher.doDigest(d.Cipher.HASH_SHA256,r));for(var i=0;i<7;i++)l.String.isNull(n)||(o+=e.Factory.Cipher.doDigest(d.Cipher.HASH_SHA256,n)),o=e.Factory.Cipher.doDigest(d.Cipher.HASH_SHA512,o);return o}var l=cwui_conf.utils,d=cwui_conf.constants,E=cwui_conf.msgFactory,g=r(127);!function(){o().then(i,function(){l.Log.debug("web storage is null")}).then(n,function(){l.Log.debug("web storage not save")}).catch(function(e){l.Log.error(e)})}();var I=function(t){var r=e.Factory.Util.createBuffer(e.Factory.Util.hexToBytes(t.INHERENT_C)),n=t.INHERENT_S,o=t.INHERENT_V;if(r){if("3.1.0.21"===o)return s(f(c(),n),r);if("3.1.0.22"===o)return s(f(u(),n),r);if("3.1.0.23"===o)return s(f("",n),r);INI_ALERT&&INI_ALERT(E.getMessageFactory().Warn.WARN_1063)}},p=function(t){var r=e.Factory.Util.createBuffer(e.Factory.Util.hexToBytes(t.INHERENT_KC)),n=t.INHERENT_S,o=t.INHERENT_V;if(r){if("3.1.0.21"===o)return s(f(c(),n),r);if("3.1.0.22"===o)return s(f(u(),n),r);if("3.1.0.23"===o)return s(f("",n),r);INI_ALERT&&INI_ALERT(E.getMessageFactory().Warn.WARN_1063)}},_=function(r,n){var o=e.Factory.Util.hexToBytes(r.INHERENT_F),i=r.INHERENT_V;if(o){if("3.1.0.21"===i)return s(f(c(),n),o).getBytes();if("3.1.0.22"===i)return s(f(u(),n),o).getBytes();if("3.1.0.23"===i)return s(f("",n),o).getBytes();new t.Warn.newThrow(null,"WARN_1063")}},C=function(r,n){var o=e.Factory.Util.hexToBytes(r.INHERENT_S),i=r.INHERENT_V;if(o){if("3.1.0.21"===i)return s(f(c(),n),o).getBytes();if("3.1.0.22"===i)return s(f(u(),n),o).getBytes();if("3.1.0.23"===i)return s(f("",n),o).getBytes();new t.Warn.newThrow(null,"WARN_1063")}},v=function(e,r,n){var o=e,i=n;if(o){if("3.1.0.21"===i)return s(f(c(),r),o).getBytes();if("3.1.0.22"===i)return s(f(u(),r),o).getBytes();if("3.1.0.23"===i)return s(f("",r),o).getBytes();new t.Warn.newThrow(null,"WARN_1063")}},R=function(r,n,o){var i=e.Factory.Util.hexToBytes(r.INHERENT_P),a=r.INHERENT_V,d=void 0;i&&("3.1.0.21"===a?d=s(f(c(),n,o),i):"3.1.0.22"===a?d=s(f(u(),n,o),i):"3.1.0.23"===a?d=s(f("",n,o),i):new t.Warn.newThrow(null,"WARN_1063"));try{d.toString()}catch(e){l.Log.error("Web Storage Certificate - NOT CORRECT PASSWORD"),d=void 0}finally{return d}},m=function(r,n,o){var i=e.Factory.Util.hexToBytes(r.INHERENT_KP),a=r.INHERENT_V,d=void 0;i&&("3.1.0.21"===a?d=s(f(c(),n,o),i):"3.1.0.22"===a?d=s(f(u(),n,o),i):"3.1.0.23"===a?d=s(f("",n,o),i):new t.Warn.newThrow(null,"WARN_1063"));try{d.toString()}catch(e){l.Log.error("Web Storage Certificate - NOT CORRECT PASSWORD"),d=void 0}finally{return d}},T=function(e){var t=localStorage.getItem(d.System.INI_PRIVATE_STORAGE);return null!==t?(t=JSON.parse(t),t[e]):null};return{version:"3.1.0.23",integrityDecryptCert:I,integrityDecryptPrivateKey:R,integrityDecryptfinger:_,integrityDecryptSalt:C,integrityDecryptSalt2:v,getPriCert:T,integrityDecryptKMCert:p,integrityDecryptKMPrivateKey:m}}.apply(t,n))&&(e.exports=o)},66:function(e,t,r){var n,o;n=[r(8)],void 0!==(o=function(e){var t=cwui_conf.defaultConf,r=cwui_conf.utils,n=cwui_conf.constants,o=cwui_conf.system;return{IniRequest:function(){function i(e,t){if(e.PROPERTY_LIST||(e.PROPERTY_LIST=[]),t.optionInfo.getParameter("PROPERTY_LIST"))for(var r=t.optionInfo.getParameter("PROPERTY_LIST"),n=0;n<r.length;n++){var o=r[n];"KEYBOARD_SECURITY_CLIENT"==o.PROPERTY_KEY&&e.PROPERTY_LIST.push({PROPERTY_KEY:o.PROPERTY_KEY,PROPERTY_VALUE:o.PROPERTY_VALUE})}}function a(e){var r="";return r+="type="+e,r+="&certtype=0",r+="&minlength="+t.WebForm.PasswordLimit[n.WebForm.LIMIT_MIN_LENGTH],r+="&maxlength="+t.WebForm.PasswordLimit[n.WebForm.LIMIT_MAX_LENGTH],r+="&specialcharlist=%60%20~!%40%23%24%25%5E%26*()-%3D_%2B%5B%5D%7B%7D%3B%3A%2C.%2F%3C%3E%3F",r+="&indecreasecount="+t.WebForm.PasswordLimit[n.WebForm.LIMIT_DENY_SERIAL_CHAR_LENGTH],r+="&repeatcount="+t.WebForm.PasswordLimit[n.WebForm.LIMIT_DENY_SAME_CHAR_LENGTH],r+="&musttype="+t.WebForm.PasswordLimit[n.WebForm.LIMIT_MIN_CHAR_TYPE],encodeURIComponent(r)}function s(){var e="URI_SESSIONID",t=sessionStorage.getItem(e);return t||(t=parseInt(999999*Math.random()%999999),sessionStorage.setItem(e,t)),t.toString()}function c(t,r,o,i,a,c){var u={};if(u.PROTOCOLVER=n.System.PROTOCOl,u.PRODUCTID=n.System.VERSION,u.DOMAIN=location.host,u.SESSIONID=a||s(),c&&c.isComplete&&(u.SESSION=e.Factory.Util.encode64(e.Factory.Cipher.asymmetricPubKeyEncrypt(c.publicKey,"RSA15","SHA256",e.Factory.Util.hexToBytes(c.sessionSeed)))),u.ENCRYPTED="FALSE"==i?"FALSE":"TRUE",u.COMMAND=t,u.TRANS_SEQ=o,u.OPTION={},void 0!==r)if(c&&c.sessionSeed){var f=c.sessionSeed.substring(0,32),l=c.sessionSeed.substring(32);u.PARAMS=e.Factory.Util.encode64(e.Factory.Cipher.symmetricEncrypt(n.Cipher.SYMM_SEED_CBC,e.Factory.Util.hexToBytes(f),e.Factory.Util.hexToBytes(l),e.Factory.Util.createBuffer(JSON.stringify(r))).data),e.Factory.Util.dataDestory()}else u.PARAMS=r;return r=0,u}function u(e,t){return"TRUE"==e.serviceInfo.getParameter("ENCRYPTED")?e.serviceInfo.getParameter(t)?e.serviceInfo.getParameter(t):"":"PWD"==t?GINI_ProtectMgr.extract("NONCE"):"PWD_CNF"==t?GINI_ProtectMgr.extract("NONCE_CNF"):"NEW_PWD"==t?GINI_ProtectMgr.extract("NEW_NONCE"):"NEW_PWD_CNF"==t?GINI_ProtectMgr.extract("NEW_NONCE_CNF"):"PIN"==t?GINI_ProtectMgr.extract("SECURE"):"TARGET_PIN"==t?GINI_ProtectMgr.extract("TARGET_SECURE"):"SOURCE_PIN"==t?GINI_ProtectMgr.extract("SOURCE_SECURE"):void 0}var f=function(){var n=t.Prop.get("certmanui_phone"),o=e.Factory.Util.parseUrl(n),i=t.Prop.get("certmanui_phone_prefix"),a=t.System.UrlAddress.URL;return null===o?i+a+n:r.String.isNull(o.scheme)?i+a+n:i+n},l=function(){var n=t.Prop.get("certmanui_phoneURL"),o=e.Factory.Util.parseUrl(n),i=t.System.UrlAddress.URL;return null===o?i+n:r.String.isNull(o.scheme)?i+n:n},d=function(){var e=t.Prop.get("certmanui_phoneVer");return r.String.isNull(e)?o.OS.getOSName()==n.OS.WINDOWS?t.Prop.get("certmanui_phoneVerWin"):o.OS.getOSName()==n.OS.MAC?t.Prop.get("certmanui_phoneVerMac"):o.OS.getOSName()==n.OS.Linux?t.Prop.get("certmanui_phoneVerLinux"):void 0:e},E=function(e,t){var r={},n=e.requestInfo.getParameter("SESSIONID"),o=e.serviceInfo.getParameter("ENCRYPTED"),i=c("GET_VERSION",r,t,o,n);return r=0,i},g=function(e,t){var r=e.optionInfo.getParameter("PROPERTIES"),n=[];for(var o in r){var i={};i.PROPERTY_KEY=o,i.PROPERTY_VALUE=encodeURIComponent(r[o]),n.push(i)}var a=c("SET_PROPERTY",{PROPERTY_LIST:n});return n=0,a},I=function(e,t){var r={};r.DEVICE=encodeURIComponent(e.serviceInfo.getEventDeviceId()),r.PROPERTY_LIST=[{PROPERTY_KEY:"UseCertMode",PROPERTY_VALUE:"1"},{PROPERTY_KEY:"USIMServiceCertViewToPhone",PROPERTY_VALUE:"1"},{PROPERTY_KEY:"USIMServiceDriverList",PROPERTY_VALUE:"USIM_0002|USIM_0001"},{PROPERTY_KEY:"USIMServiceDownloadURL",PROPERTY_VALUE:"driver^USIM_0002$url^http://download.smartcert.kr$width^520$height^650|driver^USIM_0001$url^http://www.usimcert.com/popup/pop_install.html$width^530$height^430"},{PROPERTY_KEY:"USIMServiceSiteCode",PROPERTY_VALUE:"307020002"},{PROPERTY_KEY:"USIMServiceUnsupportedMsgURL",PROPERTY_VALUE:"url^http:///popup/pop_install.html$width^300$height^400"},{PROPERTY_KEY:"USIMServiceServerInfo",PROPERTY_VALUE:"driver^USIM_0002$addr^service.smartcert.kr$port^443"},{PROPERTY_KEY:"USIMSiteDomainURL",PROPERTY_VALUE:"www.kjbank.com"},{PROPERTY_KEY:"certmanui_mobiVer",PROPERTY_VALUE:"5.0.2.14"},{PROPERTY_KEY:"certmanui_mobiURL",PROPERTY_VALUE:"http://www.mobisign.kr/mobisigndll.htm"},{PROPERTY_KEY:"certmanui_mobiClientCode",PROPERTY_VALUE:"0100001"},{PROPERTY_KEY:"certmanui_mobiOIDFilter",PROPERTY_VALUE:"2;yessignCA;1.2.410.200005.1.1.4;yessignCA;1.2.410.200005.1.1.2;"},{PROPERTY_KEY:"certmanui_phone",PROPERTY_VALUE:f()},{PROPERTY_KEY:"certmanui_phoneURL",PROPERTY_VALUE:l()},{PROPERTY_KEY:"certmanui_phoneVer",PROPERTY_VALUE:d()},{PROPERTY_KEY:"certmanui_language",PROPERTY_VALUE:""},{PROPERTY_KEY:"YessignCertPasswordPolicy",PROPERTY_VALUE:"0"},{PROPERTY_KEY:"CertPasswordPolicy",PROPERTY_VALUE:a("issue")}],i(r,e);var n=e.requestInfo.getParameter("SESSIONID"),o=e.serviceInfo.getParameter("ENCRYPTED"),s=c("GET_DEVICE_LIST",r,t,o,n);return r=0,s},p=function(e,t,r){var n={},o="";e.serviceInfo.getParameter("PIN")&&(o=u(e,"PIN")),n.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),n.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub()),n.DEVICE_PIN=encodeURIComponent(o),n.PROPERTY_LIST=e.optionInfo.getParameter("PROPERTY_LIST"),n.OPTION={},o&&e.serviceInfo.getParameter("CERT_ID")&&(n.OPTION.CERT_CACHE="TRUE");var i=e.requestInfo.getParameter("SESSIONID");return c("GET_CERT_LIST",n,t,e.serviceInfo.getParameter("ENCRYPTED"),i,r)},_=function(o,i,a){r.Log.debug("DIGITAL_SIGN");var s={};s.DEVICE_ID=encodeURIComponent(o.serviceInfo.getDeviceId()),r.Log.debug("DEVICE_ID: "+s.DEVICE_ID),s.DEVICE_SUB=encodeURIComponent(o.serviceInfo.getDeviceSub()),r.Log.debug("DEVICE_SUB: "+s.DEVICE_SUB);var f="";if(o.serviceInfo.getParameter("PIN")&&(f=u(o,"PIN")),s.DEVICE_PIN=encodeURIComponent(f),f=0,s.CERT_ID=encodeURIComponent(o.serviceInfo.getParameter("CERT_ID")),r.Log.debug("CERT_ID: "+s.CERT_ID),o.serviceInfo.getDeviceId()===n.Certs.STORAGE_BROWSER){var l=o.serviceInfo.getParameter("CERTIFICATE");l=e.Factory.Util.certPemTagAdd(l),s.CERT=encodeURIComponent(l);var d=o.serviceInfo.getParameter("PRIVATE_KEY");d=e.Factory.Util.privateKeyPemTagRemove(d).trim(),s.PRIVATE_KEY=encodeURIComponent(d)}else s.CERT="",s.PRIVATE_KEY="";var E=o.requestInfo.getParameter("ORG_DATA");if("TRUE"==o.requestInfo.getParameter("MULTI_SIGN")){var g=o.requestInfo.getParameter("MULTI_INDEX");E=o.requestInfo.getParameter("MULTI_ORG_DATA")[g],g++,o.requestInfo.setParameter("MULTI_INDEX",g)}if(s.ORIGINAL_DATA=encodeURIComponent(E),r.Log.debug("ORIGINAL_DATA: "+s.ORIGINAL_DATA),s.PASSWORD=encodeURIComponent(u(o,"PWD")),s.SIGN_KIND=encodeURIComponent(o.optionInfo.getParameter("SIGN_KIND")),r.Log.debug("SIGN_KIND: "+s.SIGN_KIND),o.optionInfo.getParameter("HASH_ALG")&&(s.SIGN_HASH=encodeURIComponent(o.optionInfo.getParameter("HASH_ALG").toUpperCase()),r.Log.debug("SIGN_HASH: "+s.SIGN_HASH)),s.OPTION={},s.OPTION.SHOW_PLAIN_TEXT=encodeURIComponent(o.optionInfo.getParameter("SHOW_PLAIN_TEXT")),r.Log.debug("OPTION > SHOW_PLAIN_TEXT: "+s.OPTION.SHOW_PLAIN_TEXT),"PKCS7"===o.optionInfo.getParameter("SIGN_KIND")){r.String.isNull(o.optionInfo.getParameter("REPLAY_ATTACK_CHECK_ORG_DATA"))?(s.OPTION.SERVER_TIME=encodeURIComponent(o.optionInfo.getParameter("SERVER_TIME")),r.Log.debug("OPTION > SERVER_TIME: "+s.OPTION.SERVER_TIME)):(s.OPTION.SERVER_TIME=encodeURIComponent(o.optionInfo.getParameter("REPLAY_ATTACK_CHECK_ORG_DATA")),r.Log.debug("OPTION > SERVER_TIME: "+s.OPTION.SERVER_TIME)),s.OPTION.YESSIGN_TYPE=encodeURIComponent(o.optionInfo.getParameter("YESSIGN_TYPE").toString().toUpperCase()),r.Log.debug("OPTION > YESSIGN_TYPE: "+s.OPTION.YESSIGN_TYPE),s.OPTION.IN_VID=encodeURIComponent(o.optionInfo.getParameter("IN_VID").toString().toUpperCase()),r.Log.debug("OPTION > IN_VID: "+s.OPTION.IN_VID),s.OPTION.BASE64_DEC=encodeURIComponent(o.optionInfo.getParameter("BASE64_DEC").toString().toUpperCase()),r.Log.debug("OPTION > BASE64_DEC: "+s.OPTION.BASE64_DEC),s.ORIGINAL_URL_ENCODING=encodeURIComponent(o.optionInfo.getParameter("CONTENT_ENCODE").ORIGIRAL_URL_ENCODE?"TRUE":"FALSE"),r.Log.debug("ORIGINAL_URL_ENCODING: "+s.ORIGINAL_URL_ENCODING);var I=o.optionInfo.getParameter("CONTENT_ENCODE").ORIGIRAL_CHAR_SET;s.ORIGINAL_ENCODING=encodeURIComponent("utf8"==I?"UTF-8":I),r.Log.debug("ORIGINAL_ENCODING: "+s.ORIGINAL_ENCODING),s.SIGN_URL_ENCODING=encodeURIComponent(o.optionInfo.getParameter("CONTENT_ENCODE").SIGN_URL_ENCODE?"TRUE":"FALSE"),r.Log.debug("SIGN_URL_ENCODING: "+s.SIGN_URL_ENCODING);var p=o.optionInfo.getParameter("CONTENT_ENCODE").SIGN_CHAR_SET;s.SIGN_ENCODING=encodeURIComponent("utf8"==p?"UTF-8":p),r.Log.debug("SIGN_ENCODING: "+s.SIGN_ENCODING),s.OPTION.PDF_SIGN_TYPE=encodeURIComponent(o.optionInfo.getParameter("PDF_SIGN_TYPE").toString().toUpperCase()),r.Log.debug("OPTION > PDF_SIGN_TYPE: "+s.OPTION.PDF_SIGN_TYPE),s.OPTION.REMOVE_TIME_STAMP=encodeURIComponent(o.optionInfo.getParameter("REMOVE_TIME_STAMP").toString().toUpperCase()),r.Log.debug("OPTION > REMOVE_TIME_STAMP: "+s.OPTION.REMOVE_TIME_STAMP),s.OPTION.REMOVE_CONTENT=encodeURIComponent(o.optionInfo.getParameter("REMOVE_CONTENT").toString().toUpperCase()),r.Log.debug("OPTION > REMOVE_CONTENT: "+s.OPTION.REMOVE_CONTENT),s.OPTION.REMOVE_SIGNED_ATTRIBUTE=encodeURIComponent(o.optionInfo.getParameter("REMOVE_SIGNED_ATTRIBUTE").toString().toUpperCase()),r.Log.debug("OPTION > REMOVE_SIGNED_ATTRIBUTE: "+s.OPTION.REMOVE_SIGNED_ATTRIBUTE),s.OPTION.SPLIT_URL_ENCODING=encodeURIComponent(t.Signature.SplitUrlEncode),r.Log.debug("OPTION > SPLIT_URL_ENCODING: "+s.OPTION.SPLIT_URL_ENCODING)}else{s.OPTION.YESSIGN_TYPE=encodeURIComponent(o.optionInfo.getParameter("YESSIGN_TYPE").toString().toUpperCase()),r.Log.debug("OPTION > YESSIGN_TYPE: "+s.OPTION.YESSIGN_TYPE),s.OPTION.IN_VID=encodeURIComponent(o.optionInfo.getParameter("IN_VID").toString().toUpperCase()),r.Log.debug("OPTION > IN_VID: "+s.OPTION.IN_VID),s.ORIGINAL_URL_ENCODING=encodeURIComponent(o.optionInfo.getParameter("CONTENT_ENCODE").ORIGIRAL_URL_ENCODE?"TRUE":"FALSE"),r.Log.debug("ORIGINAL_URL_ENCODING: "+s.ORIGINAL_URL_ENCODING);var I=o.optionInfo.getParameter("CONTENT_ENCODE").ORIGIRAL_CHAR_SET;s.ORIGINAL_ENCODING=encodeURIComponent("utf8"==I?"UTF-8":I),r.Log.debug("ORIGINAL_ENCODING: "+s.ORIGINAL_ENCODING),s.SIGN_URL_ENCODING=encodeURIComponent(o.optionInfo.getParameter("CONTENT_ENCODE").SIGN_URL_ENCODE?"TRUE":"FALSE"),r.Log.debug("SIGN_URL_ENCODING: "+s.SIGN_URL_ENCODING);var p=o.optionInfo.getParameter("CONTENT_ENCODE").SIGN_CHAR_SET;s.SIGN_ENCODING=encodeURIComponent("utf8"==p?"UTF-8":p),r.Log.debug("SIGN_ENCODING: "+s.SIGN_ENCODING)}s.PROPERTY_LIST=o.optionInfo.getParameter("PROPERTY_LIST");var _="PKCS1_15";o.optionInfo.getParameter("RSA_PSS_SIGN")&&(_="PSS"),s.OPTION.SIGN_PADDING=encodeURIComponent(_),r.Log.debug("OPTION > SIGN_PADDING: "+s.OPTION.SIGN_PADDING),void 0!==o.requestInfo.getParameter("ADD_PKCS1")&&(s.OPTION.SECURE_NONCE=encodeURIComponent(o.requestInfo.getParameter("ADD_PKCS1")));var C=o.requestInfo.getParameter("UNAUTH_ATTR_LIST");if(void 0!==C){var v=[];for(key in C){var R=C[key],m={};m.UNAUTH_ATTR_KEY=R.UNAUTH_ATTR_KEY,m.UNAUTH_ATTR_VALUE=R.UNAUTH_ATTR_VALUE,v.push(m)}s.UNAUTH_ATTR=v}o.serviceInfo.getDeviceId()===n.Certs.STORAGE_USIM&&(s.USIM_FILTER_INFO={},s.USIM_FILTER_INFO.USIM_FILTER_OID=o.optionInfo.getParameter("USIM_FILTER_OID"),s.USIM_FILTER_INFO.USIM_FILTER_ISSUERDN=o.optionInfo.getParameter("USIM_FILTER_ISSUERDN"),s.USIM_FILTER_INFO.USIM_FILTER_SUBJECTDN=o.optionInfo.getParameter("USIM_FILTER_SUBJECTDN"),s.USIM_FILTER_INFO.USIM_FILTER_SERIAL=o.optionInfo.getParameter("USIM_FILTER_SERIAL"),s.USIM_FILTER_INFO.USIM_FILTER_CA=o.optionInfo.getParameter("USIM_FILTER_CA"),s.USIM_FILTER_INFO.USIM_FILTER_EXPIRED=o.optionInfo.getParameter("USIM_FILTER_EXPIRED")),"TRUE"===o.optionInfo.getParameter("ADD_PKCS7_SIGN")&&(s.OPTION.ADD_PKCS7_SIGN="TRUE",s.OPTION.SIGNED_PKCS7_DATA=encodeURIComponent(o.optionInfo.getParameter("SIGNED_PKCS7_DATA")));var T=o.requestInfo.getParameter("SESSIONID"),S=o.serviceInfo.getParameter("ENCRYPTED"),h=c("DIGITAL_SIGN",s,i,S,T,a);return s=0,E="",h},C=function(e,t,r){var n={};n.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),n.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub());var o="";e.serviceInfo.getParameter("PIN")&&(o=u(e,"PIN")),n.DEVICE_PIN=encodeURIComponent(o),n.CERT_ID=encodeURIComponent(e.serviceInfo.getParameter("CERT_ID")),i(n,e);var a=e.requestInfo.getParameter("SESSIONID"),s=e.serviceInfo.getParameter("ENCRYPTED"),f=c("DELETE_CERT",n,t,s,a,r);return n=0,f},v=function(e,t,r){var n={};n.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),n.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub());var o="";e.serviceInfo.getParameter("PIN")&&(o=u(e,"PIN")),n.DEVICE_PIN=encodeURIComponent(o),o=0,n.CERT_ID=encodeURIComponent(e.serviceInfo.getParameter("CERT_ID")),n.PREV_PASSWORD=encodeURIComponent(u(e,"PWD")),n.NEW_PASSWORD=encodeURIComponent(u(e,"NEW_PWD")),n.CONFIRM_PASSWORD=encodeURIComponent(u(e,"NEW_PWD_CNF")),n.PROPERTY_LIST=[{PROPERTY_KEY:"YessignCertPasswordPolicy",PROPERTY_VALUE:"0"},{PROPERTY_KEY:"CertPasswordPolicy",PROPERTY_VALUE:a("chgpwd")}],i(n,e);var s=e.requestInfo.getParameter("SESSIONID"),f=e.serviceInfo.getParameter("ENCRYPTED"),l=c("CHANGE_PASSWORD",n,t,f,s,r);return n=0,l},R=function(t,r,o){var a={};if(a.SOURCE_DEVICE_ID=encodeURIComponent(t.serviceInfo.getParameter("SOURCE_DEVICE_ID")),a.SOURCE_DEVICE_SUB=encodeURIComponent(t.serviceInfo.getParameter("SOURCE_DEVICE_SUB")),a.SOURCE_DEVICE_PIN=encodeURIComponent(u(t,"PIN")),a.TARGET_DEVICE_ID=encodeURIComponent(t.serviceInfo.getParameter("TARGET_DEVICE_ID")),a.TARGET_DEVICE_SUB=encodeURIComponent(t.serviceInfo.getParameter("TARGET_DEVICE_SUB_ID")),a.TARGET_DEVICE_PIN=encodeURIComponent(u(t,"TARGET_PIN")),a.PASSWORD=encodeURIComponent(u(t,"PWD")),t.serviceInfo.getParameter("SOURCE_DEVICE_ID")===n.Certs.STORAGE_BROWSER){var s=t.serviceInfo.getParameter("CERTIFICATE");s=e.Factory.Util.certPemTagAdd(s),a.CERT=encodeURIComponent(s);var f=t.serviceInfo.getParameter("PRIVATE_KEY");f=e.Factory.Util.privateKeyPemTagRemove(f).trim(),a.PRIVATE_KEY=encodeURIComponent(f);var l=t.serviceInfo.getParameter("KM_CERTIFICATE");l&&(l=e.Factory.Util.certPemTagAdd(l),a.KM_CERT=encodeURIComponent(l));var d=t.serviceInfo.getParameter("KM_PRIVATE_KEY");d&&(d=e.Factory.Util.privateKeyPemTagRemove(d).trim(),a.KM_PRIVATE_KEY=encodeURIComponent(d))}else a.CERT_ID=encodeURIComponent(t.serviceInfo.getParameter("CERT_ID"));i(a,t);var E=t.requestInfo.getParameter("SESSIONID"),g=t.serviceInfo.getParameter("ENCRYPTED"),I=c("COPY_CERT",a,r,g,E,o);return a=0,I},m=function(e,r,o){var s={};s.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),s.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub());var f="";e.serviceInfo.getParameter("PIN")&&(f=u(e,"PIN")),s.DEVICE_PIN=encodeURIComponent(f),e.serviceInfo.getParameter("PIN")?(s.PASSWORD=encodeURIComponent(u(e,"PIN")),s.CONFIRM_PASSWORD=encodeURIComponent(u(e,"PIN"))):(s.PASSWORD=encodeURIComponent(u(e,"NEW_PWD")),s.CONFIRM_PASSWORD=encodeURIComponent(u(e,"NEW_PWD_CNF"))),s.PROPERTY_LIST=[{PROPERTY_KEY:"YessignCertPasswordPolicy",PROPERTY_VALUE:"0"},{PROPERTY_KEY:"CertPasswordPolicy",PROPERTY_VALUE:a("issue")},{PROPERTY_KEY:"SetBitPKCS10CertRequest",PROPERTY_VALUE:"2048"},{PROPERTY_KEY:"EvidCACertPKCS10CertRequest",PROPERTY_VALUE:window.location.protocol+"//"+window.location.host+t.System.UrlAddress.PRIVATE_EVID_CA_CERT}],void 0!==t.Certs.Issue&&void 0!==t.Certs.Issue.Private&&void 0!==t.Certs.Issue.Private.EVIDPaddingMode&&void 0!==t.Certs.Issue.Private.EVIDHashAlg&&s.PROPERTY_LIST.push({PROPERTY_KEY:"EvidEncryptInfoPKCS10CertRequest",PROPERTY_VALUE:t.Certs.Issue.Private.EVIDPaddingMode+"&"+t.Certs.Issue.Private.EVIDHashAlg}),"toss"===t.CustomerCode&&e.serviceInfo.getDeviceId()===n.Certs.STORAGE_SECURITY_TOKEN&&s.PROPERTY_LIST.push({PROPERTY_KEY:"LikeOnceFlowToSecureToken",PROPERTY_VALUE:"yes"}),s.CA_NAME=encodeURIComponent(e.requestInfo.getParameter("CA_NAME")),s.CA_IP=encodeURIComponent(e.requestInfo.getParameter("CA_IP")),s.CA_PORT=encodeURIComponent(e.requestInfo.getParameter("CA_PORT")),s.REF_VALUE=encodeURIComponent(e.requestInfo.getParameter("REF_VALUE")),s.AUTH_CODE=encodeURIComponent(e.requestInfo.getParameter("AUTH_CODE"));var l=e.requestInfo.getParameter("IS_ISSUE");void 0!=l&&(s.IS_ISSUE=encodeURIComponent(l.toString().toUpperCase())),i(s,e);var d=e.requestInfo.getParameter("SESSIONID"),E=e.serviceInfo.getParameter("ENCRYPTED"),g=c("ISSUE_CERT",s,r,E,d,o);return s=0,g},T=function(e,t,r){var n={};n.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),n.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub());var o="";e.serviceInfo.getParameter("PIN")&&(o=u(e,"PIN")),n.DEVICE_PIN=encodeURIComponent(o),e.serviceInfo.getParameter("PIN")?(n.PASSWORD=encodeURIComponent(u(e,"PIN")),n.CONFIRM_PASSWORD=encodeURIComponent(u(e,"PIN"))):(n.PASSWORD=encodeURIComponent(u(e,"NEW_PWD")),n.CONFIRM_PASSWORD=encodeURIComponent(u(e,"NEW_PWD_CNF"))),n.PROPERTY_LIST=[{PROPERTY_KEY:"YessignCertPasswordPolicy",PROPERTY_VALUE:"0"},{PROPERTY_KEY:"CertPasswordPolicy",PROPERTY_VALUE:a("issue")}],n.CA_NAME=encodeURIComponent(e.requestInfo.getParameter("CA_NAME")),n.CA_IP=encodeURIComponent(e.requestInfo.getParameter("CA_IP")),n.CA_PORT=encodeURIComponent(e.requestInfo.getParameter("CA_PORT")),n.REF_VALUE=encodeURIComponent(e.requestInfo.getParameter("REF_VALUE")),n.AUTH_CODE=encodeURIComponent(e.requestInfo.getParameter("AUTH_CODE")),i(n,e);var s=e.requestInfo.getParameter("SESSIONID"),f=e.serviceInfo.getParameter("ENCRYPTED"),l=c("REISSUE_CERT",n,t,f,s,r);return n=0,l},S=function(t,r,o){var s={};s.DEVICE_ID=encodeURIComponent(t.serviceInfo.getDeviceId()),s.DEVICE_SUB=encodeURIComponent(t.serviceInfo.getDeviceSub());var f="";if(t.serviceInfo.getParameter("PIN")&&(f=u(t,"PIN")),s.DEVICE_PIN=encodeURIComponent(f),s.CERT_ID=encodeURIComponent(t.serviceInfo.getParameter("CERT_ID")),s.CA_NAME=encodeURIComponent(t.requestInfo.getParameter("CA_NAME")),s.CA_IP=encodeURIComponent(t.requestInfo.getParameter("CA_IP")),s.CA_PORT=encodeURIComponent(t.requestInfo.getParameter("CA_PORT")),s.OLD_PASSWORD=encodeURIComponent(u(t,"PWD")),s.NEW_PASSWORD=encodeURIComponent(u(t,"NEW_PWD")),s.CONFIRM_PASSWORD=encodeURIComponent(u(t,"NEW_PWD_CNF")),s.PROPERTY_LIST=[{PROPERTY_KEY:"YessignCertPasswordPolicy",PROPERTY_VALUE:"0"},{PROPERTY_KEY:"CertPasswordPolicy",PROPERTY_VALUE:a("update")}],i(s,t),t.serviceInfo.getDeviceId()===n.Certs.STORAGE_BROWSER){var l=t.serviceInfo.getParameter("CERTIFICATE");l=e.Factory.Util.certPemTagAdd(l),s.CERT=encodeURIComponent(l);var d=t.serviceInfo.getParameter("PRIVATE_KEY");d=e.Factory.Util.privateKeyPemTagRemove(d).trim(),s.PRIVATE_KEY=encodeURIComponent(d)}else s.CERT="",s.PRIVATE_KEY="";var E=t.requestInfo.getParameter("SESSIONID"),g=t.serviceInfo.getParameter("ENCRYPTED"),I=c("UPDATE_CERT",s,r,g,E,o);return s=0,I},h=function(e,t,r){var n={};n.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),n.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub());var o="";e.serviceInfo.getParameter("PIN")&&(o=u(e,"PIN")),n.DEVICE_PIN=encodeURIComponent(o),n.CA_NAME=encodeURIComponent(e.requestInfo.getParameter("CA_NAME")),n.CERT_SERIAL=encodeURIComponent(e.requestInfo.getParameter("CERT_SERIAL")),n.ISSUER_DN=encodeURIComponent(e.requestInfo.getParameter("ISSUER_DN")),i(n,e);var a=e.requestInfo.getParameter("SESSIONID"),s=e.serviceInfo.getParameter("ENCRYPTED"),f=c("REVOKE_CERT",n,t,s,a,r);return n=0,f},P=function(t,r,o){var a={};a.DEVICE_ID=encodeURIComponent(t.serviceInfo.getDeviceId()),a.DEVICE_SUB=encodeURIComponent(t.serviceInfo.getDeviceSub());var s="";if(t.serviceInfo.getParameter("PIN")&&(s=t.serviceInfo.getParameter("PIN")),a.DEVICE_PIN=encodeURIComponent(s),a.CERT_ID=encodeURIComponent(t.serviceInfo.getParameter("CERT_ID")),a.PASSWORD=encodeURIComponent(u(t,"PWD")),t.serviceInfo.getDeviceId()===n.Certs.STORAGE_BROWSER){var f=t.serviceInfo.getParameter("CERTIFICATE");f=e.Factory.Util.certPemTagAdd(f),a.CERT=encodeURIComponent(f);var l=t.serviceInfo.getParameter("PRIVATE_KEY");l=e.Factory.Util.privateKeyPemTagRemove(l).trim(),a.PRIVATE_KEY=encodeURIComponent(l);var d=t.serviceInfo.getParameter("KM_CERTIFICATE");d&&(d=e.Factory.Util.certPemTagAdd(d),a.KM_CERT=encodeURIComponent(d));var E=t.serviceInfo.getParameter("KM_PRIVATE_KEY");E&&(E=e.Factory.Util.privateKeyPemTagRemove(E).trim(),a.KM_PRIVATE_KEY=encodeURIComponent(E))}else a.CERT="",a.PRIVATE_KEY="",a.KM_CERT="",a.KM_PRIVATE_KEY="";i(a,t);var g=t.requestInfo.getParameter("SESSIONID"),I=t.serviceInfo.getParameter("ENCRYPTED"),p=c("EXPORT_FILE_CERT",a,r,I,g,o);return a=0,p},N=function(t,r,o){var s={};s.DEVICE_ID=encodeURIComponent(t.serviceInfo.getDeviceId()),s.DEVICE_SUB=encodeURIComponent(t.serviceInfo.getDeviceSub());var E=t.serviceInfo.getDeviceId();t.serviceInfo.getEventDeviceId()===n.Certs.STORAGE_PHONE&&t.serviceInfo.getPrevDeviceSubId()===n.Certs.STORAGE_PHONE_INFOVINE&&(s.DEVICE_ID=encodeURIComponent(n.Certs.STORAGE_PHONE),s.DEVICE_SUB=encodeURIComponent(n.Certs.STORAGE_PHONE_INFOVINE)),t.serviceInfo.getParameter("PIN")?(s.DEVICE_PIN=encodeURIComponent(u(t,"PIN")),E===n.Certs.STORAGE_SECURITY_DEVICE||E===n.Certs.STORAGE_SECURITY_TOKEN?(s.PASSWORD=encodeURIComponent(u(t,"NEW_PWD")),s.CONFIRM_PASSWORD=encodeURIComponent(u(t,"NEW_PWD_CNF"))):(t.serviceInfo.getParameter("PWD")?s.PASSWORD=encodeURIComponent(u(t,"PWD")):s.PASSWORD=encodeURIComponent(u(t,"PIN")),t.serviceInfo.getParameter("PWD_CNF")?s.CONFIRM_PASSWORD=encodeURIComponent(u(t,"PWD_CNF")):s.CONFIRM_PASSWORD=encodeURIComponent(u(t,"PIN")))):t.serviceInfo.getParameter("IMPORT")?s.PASSWORD=encodeURIComponent(u(t,"PWD")):(s.DEVICE_PIN=encodeURIComponent(""),s.PASSWORD=encodeURIComponent(u(t,"NEW_PWD")),s.CONFIRM_PASSWORD=encodeURIComponent(u(t,"NEW_PWD_CNF"))),s.PROPERTY_LIST=[{PROPERTY_KEY:"UseCertMode",PROPERTY_VALUE:"1"},{PROPERTY_KEY:"USIMServiceCertViewToPhone",PROPERTY_VALUE:"1"},{PROPERTY_KEY:"USIMServiceDriverList",PROPERTY_VALUE:"USIM_0002|USIM_0001"},{PROPERTY_KEY:"USIMServiceDownloadURL",PROPERTY_VALUE:"driver^USIM_0002$url^http://download.smartcert.kr$width^520$height^650|driver^USIM_0001$url^http://www.usimcert.com/popup/pop_install.html$width^530$height^430"},{PROPERTY_KEY:"USIMServiceSiteCode",PROPERTY_VALUE:"307020002"},{PROPERTY_KEY:"USIMServiceUnsupportedMsgURL",PROPERTY_VALUE:"url^http:///popup/pop_install.html$width^300$height^400"},{PROPERTY_KEY:"USIMServiceServerInfo",PROPERTY_VALUE:"driver^USIM_0002$addr^service.smartcert.kr$port^443"},{PROPERTY_KEY:"USIMSiteDomainURL",PROPERTY_VALUE:"www.kjbank.com"},{PROPERTY_KEY:"certmanui_mobiVer",PROPERTY_VALUE:"5.0.2.14"},{PROPERTY_KEY:"certmanui_mobiURL",PROPERTY_VALUE:"http://www.mobisign.kr/mobisigndll.htm"},{PROPERTY_KEY:"certmanui_mobiClientCode",PROPERTY_VALUE:"0100001"},{PROPERTY_KEY:"certmanui_mobiOIDFilter",PROPERTY_VALUE:"2;yessignCA;1.2.410.200005.1.1.4;yessignCA;1.2.410.200005.1.1.2;"},{PROPERTY_KEY:"certmanui_phone",PROPERTY_VALUE:f()},{PROPERTY_KEY:"certmanui_phoneURL",PROPERTY_VALUE:l()},{PROPERTY_KEY:"certmanui_phoneVer",PROPERTY_VALUE:d()},{PROPERTY_KEY:"certmanui_language",PROPERTY_VALUE:""},{PROPERTY_KEY:"YessignCertPasswordPolicy",PROPERTY_VALUE:"0"},{PROPERTY_KEY:"CertPasswordPolicy",PROPERTY_VALUE:a("issue")}],i(s,t);var g=t.serviceInfo.getParameter("CERTIFICATE");g=e.Factory.Util.certPemTagAdd(g),s.CERT=encodeURIComponent(g);var I=t.serviceInfo.getParameter("PRIVATE_KEY");I=e.Factory.Util.privateKeyPemTagRemove(I).trim(),s.PRIVATE_KEY=encodeURIComponent(I);var p=t.serviceInfo.getParameter("KM_CERTIFICATE");p&&(p=e.Factory.Util.certPemTagAdd(p).trim(),s.KM_CERT=encodeURIComponent(p));var _=t.serviceInfo.getParameter("KM_PRIVATE_KEY");_&&(_=e.Factory.Util.privateKeyPemTagRemove(_),s.KM_PRIVATE_KEY=encodeURIComponent(_));var C=t.requestInfo.getParameter("SESSIONID"),v=t.serviceInfo.getParameter("ENCRYPTED"),R=c("SAVE_CERT",s,r,v,C,o);return s=0,R},y=function(e,t,r){var n={};n.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),n.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub()),e.serviceInfo.getParameter("PIN")?(n.DEVICE_PIN=encodeURIComponent(u(e,"PIN")),e.serviceInfo.getParameter("PWD")?n.PASSWORD=encodeURIComponent(u(e,"PWD")):n.PASSWORD=encodeURIComponent(u(e,"PIN")),e.serviceInfo.getParameter("PWD_CNF")?n.CONFIRM_PASSWORD=encodeURIComponent(u(e,"PWD_CNF")):n.CONFIRM_PASSWORD=encodeURIComponent(u(e,"PIN"))):(n.DEVICE_PIN=encodeURIComponent(""),n.PASSWORD=encodeURIComponent(u(e,"PWD")),n.CONFIRM_PASSWORD=encodeURIComponent(u(e,"PWD_CNF"))),n.PROPERTY_LIST=[{PROPERTY_KEY:"UseCertMode",PROPERTY_VALUE:"1"},{PROPERTY_KEY:"USIMServiceCertViewToPhone",PROPERTY_VALUE:"1"},{PROPERTY_KEY:"USIMServiceDriverList",PROPERTY_VALUE:"USIM_0002|USIM_0001"},{PROPERTY_KEY:"USIMServiceDownloadURL",PROPERTY_VALUE:"driver^USIM_0002$url^http://download.smartcert.kr$width^520$height^650|driver^USIM_0001$url^http://www.usimcert.com/popup/pop_install.html$width^530$height^430"},{PROPERTY_KEY:"USIMServiceSiteCode",PROPERTY_VALUE:"307020002"},{PROPERTY_KEY:"USIMServiceUnsupportedMsgURL",PROPERTY_VALUE:"url^http:///popup/pop_install.html$width^300$height^400"},{PROPERTY_KEY:"USIMServiceServerInfo",PROPERTY_VALUE:"driver^USIM_0002$addr^service.smartcert.kr$port^443"},{PROPERTY_KEY:"USIMSiteDomainURL",PROPERTY_VALUE:"www.kjbank.com"},{PROPERTY_KEY:"certmanui_mobiVer",PROPERTY_VALUE:"5.0.2.14"},{PROPERTY_KEY:"certmanui_mobiURL",PROPERTY_VALUE:"http://www.mobisign.kr/mobisigndll.htm"},{PROPERTY_KEY:"certmanui_mobiClientCode",PROPERTY_VALUE:"0100001"},{PROPERTY_KEY:"certmanui_mobiOIDFilter",PROPERTY_VALUE:"2;yessignCA;1.2.410.200005.1.1.4;yessignCA;1.2.410.200005.1.1.2;"},{PROPERTY_KEY:"certmanui_phone",PROPERTY_VALUE:f()},{PROPERTY_KEY:"certmanui_phoneURL",PROPERTY_VALUE:l()},{PROPERTY_KEY:"certmanui_phoneVer",PROPERTY_VALUE:d()},{PROPERTY_KEY:"certmanui_language",PROPERTY_VALUE:""},{PROPERTY_KEY:"YessignCertPasswordPolicy",PROPERTY_VALUE:"0"},{PROPERTY_KEY:"CertPasswordPolicy",PROPERTY_VALUE:a("issue")}],i(n,e);var o=e.serviceInfo.getParameter("ENC_P12_CERT");n.CERT_P12=encodeURIComponent(o),n.TYPE=encodeURIComponent("P12");var s=e.requestInfo.getParameter("SESSIONID"),E=e.serviceInfo.getParameter("ENCRYPTED"),g=c("SAVE_CERT",n,t,E,s,r);return n=0,g},A=function(e,t,r){var n={};n.DEVICE_ID=encodeURIComponent(e.serviceInfo.getDeviceId()),n.DEVICE_SUB=encodeURIComponent(e.serviceInfo.getDeviceSub());var o="";e.serviceInfo.getParameter("PIN")&&(o=u(e,"PIN")),n.DEVICE_PIN=encodeURIComponent(o),n.CERT_ID=encodeURIComponent(e.serviceInfo.getParameter("CERT_ID")),n.PASSWORD=encodeURIComponent(u(e,"PWD")),i(n,e);var a=e.requestInfo.getParameter("SESSIONID"),s=e.serviceInfo.getParameter("ENCRYPTED"),f=c("LOAD_CERT",n,t,s,a,r);return n=0,f},O=function(e,t){var r={},n=e.requestInfo.getParameter("SESSIONID"),o=e.serviceInfo.getParameter("ENCRYPTED"),i=c("GET_PUBLIC_KEY",r,t,o,n);return r=0,i},b=function(e,t){var r={},n=e.requestInfo.getParameter("SESSIONID"),o=e.serviceInfo.getParameter("ENCRYPTED"),i=c("GET_PUBLIC_KEY_FOR_KEYBOARD_SECURITY",r,t,o,n);return r=0,i};return{getReqVersion:E,getReqSetProperty:g,getReqDeviceList:I,getReqCertificateList:p,getReqSignature:_,getReqDeleteCertificate:C,getReqChangeCertificate:v,getReqCopyCertificate:R,getReqIssueCertificate:m,getReqUpdateCertificate:S,getReqReIssueCertificate:T,getReqRevokeCertificate:h,getReqExportCertificate:P,getReqSaveCertificate:N,getReqSaveCertificate12:y,getReqLoadCertificate:A,getReqExchangeMasterKey:function(e,t){var r={};r.MASTER_KEY=encodeURIComponent(e.serviceInfo.getParameter("MASTER_KEY"));var n=e.requestInfo.getParameter("SESSIONID"),o=e.serviceInfo.getParameter("ENCRYPTED"),i=c("EXCHANGE_MASTER_KEY",r,t,o,n);return r=0,i},getReqGatterPCInfo:function(e,t){var r={};r.SITE_NAME=encodeURIComponent(e.serviceInfo.getParameter("SITE_NAME")),r.PC_INFO_USE=encodeURIComponent(e.serviceInfo.getParameter("PC_INFO_USE")),r.SERVER_IP=encodeURIComponent(e.serviceInfo.getParameter("SERVER_IP")),r.SERVER_PORT=encodeURIComponent(e.serviceInfo.getParameter("SERVER_PORT")),r.RETRY_CNT=encodeURIComponent(e.serviceInfo.getParameter("RETRY_CNT")),r.REPLACE=encodeURIComponent(e.serviceInfo.getParameter("REPLACE")),r.FDS_USE=encodeURIComponent(e.serviceInfo.getParameter("FDS_USE"));var n=c("REQUEST_PC_INFO",r,t);return r=0,n},getReqGetPCInfo:function(e,t,r){var n={};n.SECURE_NONCE=encodeURIComponent(e.serviceInfo.getParameter("SECURE_NONCE")),n.USER_AGENT=encodeURIComponent(e.serviceInfo.getParameter("USER_AGENT"));var o=e.requestInfo.getParameter("SESSIONID"),i=e.serviceInfo.getParameter("ENCRYPTED"),a=c("GET_PC_INFO",n,t,i,o,r);return n=0,a},getReqPublicKey:O,getReqPublicKeyE2E:b,getReqResult:function(e){var t={};return t.PROTOCOLVER=n.System.PROTOCOl,t.PRODUCTID=n.System.VERSION,t.DOMAIN=location.host,t.SESSIONID=e.SESSIONID,t.ENCRYPTED=e.ENCRYPTED,t.COMMAND="GET_RESULT",t.TRANS_SEQ=e.TRANS_SEQ,t},getReqcheckDeviceConnect:function(e,t){var r,n,o={};r=e.serviceInfo.getParameter("TARGET_DEVICE_ID")&&"SECURITY_TOKEN"===e.serviceInfo.getParameter("TARGET_DEVICE_ID")?e.serviceInfo.getParameter("TARGET_DEVICE_ID"):e.serviceInfo.getDeviceId(),n=e.serviceInfo.getParameter("TARGET_DEVICE_SUB_ID")&&"SECURITY_TOKEN"===e.serviceInfo.getParameter("TARGET_DEVICE_ID")?e.serviceInfo.getParameter("TARGET_DEVICE_SUB_ID"):e.serviceInfo.getDeviceSub(),o.DEVICE_ID=encodeURIComponent(r),o.DEVICE_SUB=encodeURIComponent(n);var i=e.requestInfo.getParameter("SESSIONID"),a=e.serviceInfo.getParameter("ENCRYPTED"),s=c("CHECK_DEVICE_CONNECT",o,t,a,i);return o=0,s}}}(),IniResponse:function(){function t(t,o){var i=t.PARAMS;if(o){var a=i.SESSION_DATA;if(void 0===o.sessionSeed)throw r.Log.error("Please try again in a few seconds.[#8]"),new Error("Please try again in a few seconds.[#8]");var s=o.sessionSeed.substring(0,32),c=o.sessionSeed.substring(32);i=e.Factory.Cipher.symmetricDecrypt(n.Cipher.SYMM_SEED_CBC,e.Factory.Util.hexToBytes(s),e.Factory.Util.hexToBytes(c),e.Factory.Util.createBuffer(e.Factory.Util.decode64(decodeURIComponent(a)))).data,i=JSON.parse(i)}return i}var o=function(e){return t(e).VERSION_LIST},i=function(e){return t(e).DEVICE_LIST},a=function(n){var o=t(n).CERT_LIST,i={},a={},s={};for(key in o)try{var c=o[key],u=decodeURIComponent(c.CERT_ID),f=decodeURIComponent(c.CERT),l=e.Factory.Certs.parseCertAttributes(f);i[u]=l,a[u]=f}catch(e){r.Log.error("not suppot : "+f)}return s.certAttrs=i,s.certPem=a,s},s=function(e,r){var n=t(e,r),o={};return o.SIGNATURE=decodeURIComponent(n.SIGN_DATA),o.VID_CERTIFICATE=decodeURIComponent(n.CERT),o.VID_PRIVATE_KEY=decodeURIComponent(n.PRIVATE_KEY),o.VID_RANDOM=decodeURIComponent(n.VID_RANDOM),n.OPTION&&(o.PKCS1_SIGNATURE=decodeURIComponent(n.OPTION.P1SIGN_SECURE_NONCE)),o},c=function(e){var r=t(e);return r.CERT&&(r.CERT=decodeURIComponent(r.CERT),r.PRIVATE_KEY=decodeURIComponent(r.PRIVATE_KEY),r.KM_CERT&&(r.KM_CERT=decodeURIComponent(r.KM_CERT)),r.KM_PRIVATE_KEY&&(r.KM_PRIVATE_KEY=decodeURIComponent(r.KM_PRIVATE_KEY))),r},u=function(e){var r=t(e);return r.CERT&&(r.CERT=decodeURIComponent(r.CERT),r.PRIVATE_KEY=decodeURIComponent(r.PRIVATE_KEY),r.KM_CERT&&(r.KM_CERT=decodeURIComponent(r.KM_CERT)),r.KM_PRIVATE_KEY&&(r.KM_PRIVATE_KEY=decodeURIComponent(r.KM_PRIVATE_KEY))),r};return{getResVersion:o,getResSignature:s,getResCertificateList:a,getResDeviceList:i,getResIssueCertificate:c,getResUpdateCertificate:function(e){var r=t(e);return r.CERT&&(r.CERT=decodeURIComponent(r.CERT),r.PRIVATE_KEY=decodeURIComponent(r.PRIVATE_KEY),r.KM_CERT&&(r.KM_CERT=decodeURIComponent(r.KM_CERT)),r.KM_PRIVATE_KEY&&(r.KM_PRIVATE_KEY=decodeURIComponent(r.KM_PRIVATE_KEY))),r},getResReIssueCertificate:u,getResLoadCertificate:function(r){var n=t(r);if(n.PRIVATE_KEY){var o=decodeURIComponent(n.PRIVATE_KEY);o=e.Factory.Util.privateKeyPemTagAdd(o),n.PRIVATE_KEY=o;var i=decodeURIComponent(n.CERT);if(i=e.Factory.Util.certPemTagAdd(i),n.CERT=i,n.KM_PRIVATE_KEY){var a=decodeURIComponent(n.KM_PRIVATE_KEY);a=e.Factory.Util.privateKeyPemTagAdd(a),n.KM_PRIVATE_KEY=a}if(n.KM_CERT){var s=decodeURIComponent(n.KM_CERT);s=e.Factory.Util.certPemTagAdd(s),n.KM_CERT=s}}return n},getResPublicKey:function(e){var r,n=t(e);return n.PUBLIC_KEY&&(r=decodeURIComponent(n.PUBLIC_KEY)),r}}}()}}.apply(t,n))&&(e.exports=o)},67:function(e,t,r){(function(n){var o,i;o=[r(8),r(68),r(10),r(65),r(34),r(129)],void 0!==(i=function(e,t,r,o,i,a){function s(e,t){G.Log.debug(B,"setCertListToCache: start:",e,t),e.serviceInfo.setCertlist(t),G.Log.debug(B,"setCertListToCache: succeeded")}function c(e){return G.Log.debug(B,"readCertListFromCache: start:",e),new Promise(function(t,r){var n=e.serviceInfo.getCertlist();n?(G.Log.debug(B,"readCertListFromCache: succeeded:",e,n),t(n)):u(e).then(function(r){G.Log.debug(B,"readCertListFromCache: succeeded:",e,r),t(r)})})}function u(e){var t=function(e){try{var t=g(e);for(writeCert in t)G.Log.debug("Write Cert:"+writeCert),"object"==typeof t[writeCert].XSTORAGE_MERGE_INFO&&!1===t[writeCert].XSTORAGE_MERGE_INFO.valid?(delete t[writeCert],S(writeCert)):(q.writeStorage(t[writeCert],!1),H.setItem(t[writeCert]));return e[0].CROSS_LOCAL={},e[1]=t,e}catch(t){return G.Log.error("apply CrossLocal write error",t),e}};return new Promise(function(r,n){var o=null;f(e).then(function(r){return o=!0===K.System.CROSS_DOMAIN_STORAGE_USE?t(r):r,l(e,o)}).then(function(t){s(e,t),G.Log.debug("local storage resolve"),r(t)}).catch(function(t){s(e,o),G.Log.debug("local storage resolve"),r(o)})})}function f(e){G.Log.debug(B,"readLocalStorage: start",e);var t=e.serviceInfo.getParameter("CERT_CACHE"),r=e.serviceInfo.getReadOnlyOpen(),n=sessionStorage.getItem("cloud_cert");return G.Log.debug(B,"readLocalStorage: cert_cache",t),G.Log.debug(B,"readLocalStorage: readOnlyOpen",r),G.Log.debug(B,"readLocalStorage: checkcloudcert",n),new Promise(function(o,i){var a;if(r)s=[null,null],G.Log.debug(B,"readLocalStorage: do not read from localStorage (read only openStorage)",s),o(s);else if("TRUE"==t&&V()&&"true"===n){G.Log.debug(B,"readLocalStorage: read from sessionStorage"),a=q.readStorage(!0);var s=[null,a];G.Log.debug(B,"readLocalStorage: end",s),o(s)}else{G.Log.debug(B,"readLocalStorage: read from localStorage"),a=q.readStorage(!1);var c={};c.CROSS_LOCAL=a,c.transactionId=e.getTransactionId(),H.getItem(c).then(function(e){var t=[c,e];G.Log.debug(B,"readLocalStorage: end",t),o(t)})}})}function l(e,t){return G.Log.debug(B,"readOpenStorage: start",e,t),new Promise(function(r,n){var o=e.serviceInfo.getBehavior(),a=e.serviceInfo.getAction(),s=e.serviceInfo.getReadOnlyLocal();if(G.Log.debug(B,"readOpenStorage: behavior",o),G.Log.debug(B,"readOpenStorage: action",a),G.Log.debug(B,"readOpenStorage: readOnlyLocal",s),s)return G.Log.debug(B,"readOpenStorage: do not read from openStorage (read only localStorage)"),void n();if(INI_getPlatformInfo().Mobile&&Y.WebForm.ACTION_CERT_UPDATE==o&&Y.WebForm.ACTION_CERT_CMP==a)return G.Log.debug(B,"readOpenStorage: do not read from openStorage",a),void n();if(V()&&a!==Y.WebForm.ACTION_CERT_NOVIEWSIGN){var c=E(t),u=N(c);if(M=i.getOpenstorageObject()){var f=e.serviceInfo.getOpenStorageDisplayMode();M.merge(u,e,f).then(function(n){G.Log.debug(B,"readOpenStorage: merge",n);var o=I(t,n,e);p(o,n);var i=[t[0],o];G.Log.debug(B,"readOpenStorage: end",i),r(i)}).catch(function(e){G.Log.debug(B,"readOpenStorage: failed to merge",e),n(e)})}else G.Log.debug(B,"readOpenStorage: openStorage's object does not exist"),n()}else G.Log.debug(B,"readOpenStorage: do not use OPEN_CERT"),n()})}function d(e,t){var r=[];for(var n in t)r.push(n);var o=[];for(var i in e)o.push(i);if(null===t||0===r.length)return e;if(null===e||0===o.length)return t;var a={};for(src in e)a[src]=e[src];for(over in t)a[over]=t[over];return a}function E(e){var t,r,n;return null!==e[0]&&(t=e[0].CROSS_LOCAL),r=e[1],n=d(t,r),G.Log.debug("localCertList",t),G.Log.debug("crossCertList",r),G.Log.debug("mergeCertList",n),n}function g(e){var t,r,n;if(null!==e[0]&&(t=e[0].CROSS_LOCAL),r=e[1],!0===K.System.CROSS_DOMAIN_STORAGE_USE){var o={};for(lcert in t){var i={crosscert:K.System.CROSS_DOMAIN_STORAGE_USE,dns:K.System.UrlAddress.CrossDomainStorageURL.dns,valid:!0},a={crosscert:!1,valid:!1},s=t[lcert].XSTORAGE_MERGE_INFO;"object"==typeof s?!0===s.crosscert&&s.dns==K.System.UrlAddress.CrossDomainStorageURL.dns&&!0===function(e,t){for(cCert in t)if(cCert==e)return!0;return!1}(lcert,r)?(o[lcert]=t[lcert],o[lcert].XSTORAGE_MERGE_INFO=i):(o[lcert]=t[lcert],o[lcert].XSTORAGE_MERGE_INFO=a):(o[lcert]=t[lcert],o[lcert].XSTORAGE_MERGE_INFO=i)}n=d(o,r)}else n=d(t,r);return G.Log.debug("localCertList",t),G.Log.debug("crossCertList",r),G.Log.debug("mergeCertList",n),n}function I(e,t,r){var n=E(e),o=P(t),i=T(n,o.remove),a=_(i,o.create,r);return G.Log.debug("parseOpenCertList",o),G.Log.debug("finalCertList ",a),a}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];for(merge_cert in e)if(e[merge_cert]){var o=e[merge_cert].OPEN_CERT;if(n.fingerprint===o.fingerprint){if(o.source!=n.source||o.status!=n.status||o.cloud!=n.cloud){o.source=n.source,o.status=n.status;var i=sessionStorage.getItem("OPENCERT");"true"===i?q.writeStorage(e[merge_cert],!0):(q.writeStorage(e[merge_cert],!1),H.setItem(e[merge_cert]))}"OPENCERT"==n.source&&n.timestamp>o.timestamp&&q.writeStorage(e[merge_cert],!0)}}}}function _(e,t,r){var n=0,o=e;for(cert_id in e)for(var i=0;i<t.length;i++){if(G.Log.debug("Local cert list:",o[cert_id]),o[cert_id]&&o[cert_id].OPEN_CERT.fingerprint==t[i].fingerprint){var a=r.serviceInfo.getAction();t[i].cloud&&"OPENCERT"===t[i].source&&a!==Y.WebForm.ACTION_CERT_NOVIEWSIGN?(delete o[cert_id],S(cert_id),o[t[i].fingerprint]=C(t[i])):o[cert_id]=C(t[i])}else o[t[i].fingerprint]=C(t[i]);n++}if(0==n)for(var i=0;i<t.length;i++)o[t[i].fingerprint]=C(t[i]);return o}function C(t){var r=R(t.issuer,"C");G.String.isNull(r)&&(r=R(t.issuer,"c"));var n=R(t.issuer,"O");G.String.isNull(n)&&(n=R(t.issuer,"o"));var o=R(t.issuer,"OU");G.String.isNull(o)&&(o=R(t.issuer,"ou"));var i=R(t.issuer,"CN");G.String.isNull(i)&&(i=R(t.issuer,"cn"));var a=R(t.subject,"C");G.String.isNull(a)&&(a=R(t.subject,"c"));var s=R(t.subject,"O");G.String.isNull(s)&&(s=R(t.subject,"o"));var c=R(t.subject,"OU");G.String.isNull(c)&&(c=R(t.subject,"ou"));var u=R(t.subject,"CN");G.String.isNull(u)&&(u=R(t.subject,"cn"));var f=v(t.subject),l=u.indexOf(")"),d=l>0&&u.length>=l+4?u.substring(l+3,l+5):"",E="",g=!1,I=e.Factory.Util.setBrowserOU(c);return I&&(g=!0),E=Y.System.LANGUAGE_ENG===K.System.Language?g?I:e.Factory.Util.getOid("ENG_"+t.policyOID)+(""!=d?" - "+e.Factory.Util.getBankCD("ENG_"+d):""):g?I:e.Factory.Util.getOid(t.policyOID)+(""!=d?" - "+e.Factory.Util.getBankCD(d):""),{IS_SESSION:!1,INHERENT_D:void 0,INHERENT_S:void 0,INHERENT_P:void 0,INHERENT_C:void 0,INHERENT_F:void 0,INHERENT_A:{AFTER_DT:t.notAfter,BEFORE_DT:t.notBefore,EXPIRE:t.notAfter,EXPIRE_DATE:m(t.notAfter),EXPIRE_STATUS:"",HASH_ALG:"",ISSUER:n,ISSUER_C:r,ISSUER_O:n,ISSUER_OU:o,ISSUER_CN:i,ISSUER_HASH:"",SIMPLE_ISSUER:n,SIMPLE_OIDNAME:E,SIMPLE_SUBJECT:f,SUBJECT:f,SUBJECT_C:a,SUBJECT_O:s,SUBJECT_OU:c,SUBJECT_CN:u,OID:t.policyOID,OID_NAME:E,SERIAL:t.serial,fingerprint:t.fingerprint,SUBJECT_CERTINFO:t.subject,ISSUER_CERTINFO:t.issuer},OPEN_CERT:t}}function v(e){var t=R(e,"CN");if(void 0!=t&&t||(t=R(e,"cn")),t){var r=t.indexOf(")");return r>0?t.substring(0,r+1):t}return e}function R(e,t){for(var r=e.split(","),n={},o=0;o<r.length;o++){var i=r[o].trim().split("=");n[i[0]]=i[1]}return n[t]}function m(e){return e.split(" ")[0]}function T(e,t){var r={};for(var n in e)h(e[n],t)?(G.Log.debug("removeMergeOpenCert",e[n]),S(n)):r[n]=e[n];return r}function S(e){H.removeItem(e),q.removeStorage(e,!1)}function h(e,t){for(var r=0;r<t.length;r++)if(e.OPEN_CERT&&e.OPEN_CERT.fingerprint==t[r].fingerprint)return!0;return!1}function P(e){var t={};t.create=[],t.remove=[],G.Log.debug("parseOpenCertInfoList",e);for(var r=0;r<e.length;r++)"REMOVE"===e[r].status?t.remove.push(e[r]):"OPENCERT"===e[r].source&&t.create.push(e[r]);return t}function N(e){var t=[];for(var r in e){var n=e[r];if(void 0==n.OPEN_CERT){var o=y(n);void 0!=o&&t.push(o)}else t.push(n.OPEN_CERT)}return t}function y(t){if(!G.String.isNull(t)){var r={};try{var n=e.Factory.Certs.parseCertAttributes(t),t=e.Factory.Certs.certificateFromPem(t);r.fingerprint=k(t),r.timestamp=Date.now(),r.status="SAVE",r.subject=F(t.subject.attributes),r.issuer=F(t.issuer.attributes),r.notAfter=n.AFTER_DT,r.notBefore=n.BEFORE_DT,r.policyOID=n.OID,r.source="LOCAL"}catch(e){return}finally{return r}}}function A(e,t,n){try{if(void 0===e.INHERENT_D){G.Log.debug("get from open storage"),sessionStorage.setItem("OPENCERT",!0);var o=n.serviceInfo.getBehavior();return Y.WebForm.ACTION_CERT_UPDATE!==o&&(e.OPEN_CERT.cloud?sessionStorage.setItem("cloud_cert",!0):sessionStorage.setItem("cloud_cert",!1)),O(e,t,n)}G.Log.debug("get from local storage");var i=n.serviceInfo.getAction();return G.Log.debug("action:",i),i!==Y.WebForm.ACTION_SIGN&&i!==Y.WebForm.ACTION_CERT_NOVIEWSIGN&&i!==Y.WebForm.ACTION_CERT_CMP&&(sessionStorage.setItem("OPENCERT",!1),sessionStorage.setItem("cloud_cert",!1)),b(e,t,n)}catch(e){new r.Error.newThrow(e,"ERR_1045")}}function O(t,n,o){return new Promise(function(a,s){var c;c=o.serviceInfo.getParameter("FINGERPRINT")?o.serviceInfo.getParameter("FINGERPRINT"):t.OPEN_CERT.fingerprint,void 0===c&&(c=o.serviceInfo.getParameter("FINGERPRINT")),G.Log.debug("finger1:",c),M=i.getOpenstorageObject(),M?M.get(c,n).then(function(t){return t.pkcs12=e.Factory.PriKey.makeCertPriP12(t.pkcs12,n),t}).then(function(e){try{o.serviceInfo.getParameter("FINGERPRINT")?a(e.pkcs12):D(e.pkcs12,n,t.OPEN_CERT.timestamp,o,t.OPEN_CERT.cloud,function(t){o&&o.serviceInfo.setDecryptedBrowserCert(t),a(e.pkcs12)})}catch(e){try{G.Log.error("Get error:",e),new r.Error.newThrow(e,"ERR_7008")}catch(e){s(e)}}}).catch(function(e){try{3e3==e.code||3209==e.code?new r.Error.newThrow(e,"ERR_1041"):2211==e.code?(o&&(o.serviceInfo.setParameter("failCount",e.failCount),o.serviceInfo.setParameter("maxFailCount",e.maxFailCount)),"true"==sessionStorage.getItem("cloud_cert")?new r.Warn.newThrow(e,"WARN_1002_2",e.code):new r.Warn.newThrow(e,"WARN_1002_3",e.code)):2212==e.code?"true"==sessionStorage.getItem("cloud_cert")?new r.Error.newThrow(e,"ERR_1042",null,e.maxFailCount):new r.Error.newThrow(e,"ERR_1042_1",null,e.maxFailCount):new r.Error.newThrow(e,"ERR_1044",null,e.code)}catch(e){s(e)}}):a()})}function b(e,t,n){return new Promise(function(i,a){var s,c,u,f,l,d={};e.INHERENT_F?(s=o.integrityDecryptfinger(e,t),l=parseInt(s),c=e.INHERENT_D,u=e.INHERENT_V,f=o.integrityDecryptSalt(e,l),f=o.integrityDecryptSalt2(f,t,u)):(c=e.INHERENT_D,f=o.integrityDecryptSalt(e,t)),L(c,t,f).then(function(r){var a=r.substring(0,r.length-8);if(d.certificate=o.integrityDecryptCert(e)+"",d.privateKey=o.integrityDecryptPrivateKey(e,a,f)+"","undefined"===d.privateKey)return G.Log.warn(B,"Password is incorrect"),void i("pwderror");e.INHERENT_KC&&(d.kmCertificate=o.integrityDecryptKMCert(e)+"",d.kmPrivateKey=o.integrityDecryptKMPrivateKey(e,a,f)+""),d.privateKey&&"3.1.0.23"!==e.INHERENT_V&&U(d.privateKey,d.certificate,t,n),n&&n.serviceInfo.setDecryptedBrowserCert(e),i(d)}).catch(function(e){try{new r.Warn.newThrow(e,"WARN_1000")}catch(e){a(e)}})})}function D(t,r,n,o,i,a){var s=t.privateKey,c=t.certificate,u=e.Factory.Util.getRandomBytesSync(128);L(e.Factory.Util.bytesToHex(new Uint8Array([0,0,0,0])),r,u).then(function(e){return x(e,r,s,c,"","",u,"OPENCERT",n,i)}).then(function(e){var t=sessionStorage.getItem("cloud_cert");G.Log.debug("Is Cloud cert:",t);var r;"true"==t?r=q.writeStorage(e,!0):(r=q.writeStorage(e,!1),H.setItem(e)),a(r)})}function U(t,r,n,o){var a=e.Factory.Util.certPemTagAdd(r),s=e.Factory.Util.privateKeyPemTagAdd(t),c=e.Factory.Util.getRandomBytesSync(128),u=e.Factory.Util.bytesToHex(new Uint8Array([0,0,0,0])),f={};f.privateKey=s,f.certificate=a,G.Log.debug("reSavePrivateCertificate"),L(u,n,c).then(function(e){return x(e,n,s,a,"","",c,"LOCAL")}).then(function(e){var t=w(e);return o.serviceInfo.setParameter("CERT_ID",t),e}).then(function(t){if(G.Log.debug("cert_info - make",t),q.writeStorage(t,!1),H.setItem(t),M=i.getOpenstorageObject()){var r=e.Factory.PriKey.makeP12CertPri(f,n);return M.set(r,t.OPEN_CERT,n)}return t}).then(function(e){M?G.Log.debug("open_cert_info - save",e):G.Log.debug("local_cert_info - save",e)}).catch(function(e){G.Log.error("err",e)}).finally(function(){G.Log.debug(" - save finally")})}function L(t,r,o){var i=e.Factory.Cipher.doDigest(Y.Cipher.HASH_SHA256,r),a=e.Factory.Cipher.doDigest(Y.Cipher.HASH_SHA512,o),s=e.Factory.Util.createBuffer();s.putBytes(i),s.putBytes(a);var c=e.Factory.Cipher.doDigest(Y.Cipher.HASH_SHA256,s.getBytes()),u=t+e.Factory.Util.bytesToHex(c),f="random="+u,l=K.System.UrlAddress.DERIVED_KEY;return new Promise(function(e,t){n.ajax({method:"POST",url:l,data:f,contentType:"application/x-www-form-urlencoded; charset=UTF-8"}).done(function(t){var r=t.toString(),n=r.replace(/\r/g,"").replace(/\n/g,"");e(n)}).fail(function(e,r,n){G.Log.debug("data",e),G.Log.debug("textStatus",r),G.Log.debug("jqXHR",n),t(r)})})}function w(e){return(e.INHERENT_A[Y.Certs.ATTR_ISSUER]+"-"+e.INHERENT_A[Y.Certs.ATTR_SERIAL]).replace(/ /gi,"_")}function x(t,r,n,i,s,c,u,f,l,d){var E,g,I=t.substring(t.length-8,t.length),p=t.substring(0,t.length-8),_=e.Factory.Util.createBuffer(n),C=e.Factory.Util.createBuffer(i),v=e.Factory.Util.createBuffer(u),R=e.Factory.Util.createBuffer(s),m=e.Factory.Util.createBuffer(c),T=e.integrityEncrypt(_,p,u),S=e.integrityEncrypt(v,r),h=new a({canvas:!0}),P=h.get(),N=P.toString(),y=e.Factory.Util.createBuffer(N),A=e.integrityEncrypt(y,r),O=e.Factory.Util.bytesToHex(A),b=e.integrityEncrypt(S,P),D=e.Factory.Util.bytesToHex(b),U=e.integrityEncrypt(C,D),L="",w="";""!==s&&(w=e.integrityEncrypt(R,p,u),E=e.Factory.Util.bytesToHex(w)),""!==c&&(L=e.integrityEncrypt(m,D),g=e.Factory.Util.bytesToHex(L));var x=e.Factory.Util.bytesToHex(T),M=e.Factory.Util.bytesToHex(U),K=e.Factory.Certs.parseCertAttributes(i),Y=e.Factory.Certs.certificateFromPem(i),W=K.SERIAL;W&&/^[a-fA-F0-9]+/.test(W)&&(G.Log.debug("Serial hex to decimal"),W=parseInt("0x"+K.SERIAL),W=W.toString(),G.Log.debug("serial decimal:",W)),G.Log.debug("Serial:",W);var B={};return B.fingerprint=k(i),B.timestamp=G.String.isNull(l)?Date.now():parseInt(l),B.status="SAVE",B.subject=F(Y.subject.attributes),B.issuer=F(Y.issuer.attributes),B.notAfter=K.AFTER_DT,B.notBefore=K.BEFORE_DT,B.policyOID=K.OID,B.serial=W,B.source=G.String.isNull(f)?"LOCAL":f,B.cloud=!G.String.isNull(d)&&d,{IS_SESSION:!1,INHERENT_D:I,INHERENT_S:D,INHERENT_P:x,INHERENT_C:M,INHERENT_KP:E,INHERENT_KC:g,INHERENT_A:K,INHERENT_V:o.version,INHERENT_F:O,OPEN_CERT:B}}function F(t){for(var r="",n=t.length-1;n>=0;n--)r+=t[n].shortName+"="+t[n].value,n>0&&(r+=",");return e.Factory.Util.decodeUtf8(r)}function k(t){var r=e.Factory.Util.pemToDer(t),n=e.Factory.Cipher.doDigest("sha1",r.getBytes());return e.Factory.Util.bytesToHex(n)}var M,K=cwui_conf.defaultConf,G=cwui_conf.utils,Y=cwui_conf.constants,W=cwui_conf.msgFactory,B="[PRIVATE_STORAGE]",H=t.Repository(),V=function(){return!(!K.OpenStorage||"Y"!==K.OpenStorage.USE)},q=function(){function e(e){e?sessionStorage.removeItem(Y.System.INI_PRIVATE_STORAGE):localStorage.removeItem(Y.System.INI_PRIVATE_STORAGE)}var t=function(e,t){e?sessionStorage.setItem(Y.System.INI_PRIVATE_STORAGE,JSON.stringify(t)):localStorage.setItem(Y.System.INI_PRIVATE_STORAGE,JSON.stringify(t))},n=function(e){var t=null;return t=e?sessionStorage.getItem(Y.System.INI_PRIVATE_STORAGE):localStorage.getItem(Y.System.INI_PRIVATE_STORAGE),t&&(t=JSON.parse(t)),t};return{readStorage:n,writeStorage:function(o,i){try{var a=(o.INHERENT_A[Y.Certs.ATTR_ISSUER]+"-"+o.INHERENT_A[Y.Certs.ATTR_SERIAL]).replace(/ /gi,"_"),s=o,c=n(i);if(null==c){var u={};u[a]=o,t(i,u)}else{var f={},l=!1;for(certKey in c){var d=c[certKey];if(o.INHERENT_A.SUBJECT_CN===d.INHERENT_A.SUBJECT_CN)try{var E=G.Convert.stringToDate(d.INHERENT_A.BEFORE_DT);G.Convert.stringToDate(o.INHERENT_A.BEFORE_DT)>=E?(f[a]=o,l=!0):f[certKey]=d}catch(e){f[a]=o,l=!0}else f[certKey]=d}l||(f[a]=o),e(i),t(i,f)}return s}catch(e){new r.Error.newThrow(e,"ERR_3010")}},removeStorage:function(o,i){try{G.Log.debug("remove certificate id : "+o);var a=n(i);null!==a&&(delete a[o],e(i),t(i,a))}catch(e){new r.Error.newThrow(e,"ERR_3011")}}}}(),j=function(e,t){u(e).then(function(e){G.Log.debug("getCertAttributeList Result:",e);var r=e[1],n={};for(cert in r){var o=r[cert];n[cert]=o.INHERENT_A,V()&&(n[cert].CLOUD=o.OPEN_CERT.cloud,n[cert].SOURCE=o.OPEN_CERT.source)}G.Log.debug("Final getCertAttributeList Result:",n),t(n)}).catch(function(e){G.Log.error(e)})},X=function(t,n){var o=function(r,n){var o=t.requestInfo.getParameter("ORG_DATA"),i=o.split("|"),a="";if(i.length<=0)return"";for(var s=0;s<i.length;s++){var c="",u=t.optionInfo,f=decodeURIComponent(i[s]),l=f.split("=",2);if(!(l.length<2)){var d=l[0],E=f.substr(d.length+1,f.length-(d.length+1));"HD"===d?(E=decodeURIComponent(atob(E)),u.setParameter("IN_VID","TRUE"),u.setParameter("CONTENT_HASH","TRUE"),u.setParameter("REMOVE_CONTENT","FALSE")):(u.setParameter("IN_VID","FALSE"),u.setParameter("CONTENT_HASH","FALSE"),u.setParameter("REMOVE_CONTENT","TRUE")),c=e.Factory.Signature.pkcs7Sign(r,"NONCE",E,t.optionInfo.getParameter("SERVER_TIME"),n,u),c=c.replace(/(\r\n|\n|\r)/gm,""),c=c.replace("-----BEGIN PKCS7-----",""),c=c.replace("-----END PKCS7-----",""),a+=encodeURIComponent(d+"="+c),a+="|"}}n[Y.Login.SIGNATURE]=a},i=t.optionInfo.getParameter("SIGN_KIND"),a=t.requestInfo.getParameter("ADD_PKCS1"),s=t.requestInfo.getParameter("ORG_DATA"),u=t.optionInfo.getParameter("SERVER_TIME");t.optionInfo.setParameter("indicatorText","Progressing"),c(t).then(function(e){var r=e[1],n=r[t.serviceInfo.getParameter("CERT_ID")];return t.serviceInfo.setDecryptedBrowserCert(n),A(n,GINI_ProtectMgr.extract("NONCE"),t)}).then(function(c){if("error"===c)return void INI_HANDLE.warnMessage(W.getMessageFactory().Error.ERR_1043);"pwderror"===c&&new r.Warn.newThrow(c,"WARN_1001");var f={};if("TRUE"==t.requestInfo.getParameter("MULTI_SIGN")){var l=t.requestInfo.getParameter("MULTI_INDEX"),d=t.requestInfo.getParameter("MULTI_ORG_DATA");s=d[l],l++,t.requestInfo.setParameter("MULTI_INDEX",l)}"MULTI"===t.optionInfo.getParameter("PDF_SIGN_TYPE")?signedData=o(c,f):Y.Signature.SIGN_PKCS7===i?"TRUE"===t.optionInfo.getParameter("ADD_PKCS7_SIGN")?signedData=e.Factory.Signature.pkcs7AddSign(c,"NONCE",u,t.optionInfo,f):signedData=e.Factory.Signature.pkcs7Sign(c,"NONCE",s,u,f,t.optionInfo):signedData=e.Factory.Signature.pkcs1Sign(c,"NONCE",s,f,t.optionInfo.getParameter("P1_CHAR_SET"),t.optionInfo.getParameter("HASH_ALG"));var E;a&&(E=e.Factory.Signature.pkcs1Sign(c,pwd,a,null,t.optionInfo.getParameter("P1_CHAR_SET"),t.optionInfo.getParameter("HASH_ALG")),f[Y.Login.PKCS1_SIGNATURE]=E),s="",n(f,c)}).catch(function(e){t.serviceInfo.getExceptionCallback()?t.serviceInfo.getExceptionCallback()(e):INI_HANDLE.handleMessage(e)})},$=function(t,r){var n=t.serviceInfo.getParameter("CERT_ID");t.serviceInfo.setUseOpenStorage(!0),c(t).then(function(e){var t=e[1];for(cert in t)if(cert==n)return G.Log.debug("getCertificateInfo1 - make",t[cert]),t[cert]}).then(function(n){var i;if(void 0!==n.INHERENT_C){var a=(e.Factory.Util.hexToBytes(n.INHERENT_C),o.integrityDecryptCert(n));i=t.optionInfo.getParameter("CERT_VIEW_TYPE")==Y.Certs.CERTIFICATE_DETAIL_ATTR?e.Factory.Certs.certificateDetail(a):e.Factory.Certs.parseCertAttributes(a)}else{var s=n.INHERENT_A;if(t.optionInfo.getParameter("CERT_VIEW_TYPE")==Y.Certs.CERTIFICATE_DETAIL_ATTR)s.SUBJECT=s.SUBJECT_CERTINFO,s.ISSUER=s.ISSUER_CERTINFO;else{var c=R(s.SUBJECT_CERTINFO,"CN");void 0!=c&&c||(c=R(s.SUBJECT_CERTINFO,"cn"));var u=c.lastIndexOf(")"),f=u>0?c.substring(0,u+1):c,l=R(s.ISSUER_CERTINFO,"O");G.String.isNull(l)&&(l=R(s.ISSUER_CERTINFO,"o")),s.SUBJECT=f,s.ISSUER=l}G.Log.debug("detail",s),i=s}i.fingerprint=void 0,i.source=void 0,n.OPEN_CERT&&(n.OPEN_CERT.fingerprint&&(i.fingerprint=n.OPEN_CERT.fingerprint),n.OPEN_CERT.source&&(i.source=n.OPEN_CERT.source)),V()&&(void 0===n.OPEN_CERT.cloud?i.CLOUD=!1:n.OPEN_CERT.cloud&&(i.CLOUD=n.OPEN_CERT.cloud)),G.Log.debug("getCertificateInfo2 - make",i),r(i)})},J=function(t,r,n){G.Log.debug(B,"savePrivateCertificate: start:",t);var o=t.serviceInfo.getParameter("PRIVATE_KEY");o&&(o=e.Factory.Util.privateKeyPemTagAdd(o));var a=t.serviceInfo.getParameter("CERTIFICATE");a=e.Factory.Util.certPemTagAdd(a);var s="";t.serviceInfo.getParameter("KM_PRIVATE_KEY")&&(s=t.serviceInfo.getParameter("KM_PRIVATE_KEY"),s=e.Factory.Util.privateKeyPemTagAdd(s));var c="";t.serviceInfo.getParameter("KM_CERTIFICATE")&&(c=t.serviceInfo.getParameter("KM_CERTIFICATE"),c=e.Factory.Util.certPemTagAdd(c));var u={};u.privateKey=o,u.certificate=a,u.kmprivateKey=s,u.kmcertificate=c;var f=t.serviceInfo.getAction(),l=t.serviceInfo.getBehavior();n||(n=Y.WebForm.ACTION_CERT_ISSUE===f||Y.WebForm.ACTION_CERT_REISSUE===f||Y.WebForm.ACTION_CERT_UPDATE===l?"NEW_NONCE":"NONCE"),e.Factory.PriKey.extractRsaPrivateKey(o,n);var d=GINI_ProtectMgr.extract(n),E=e.Factory.Util.getRandomBytesSync(128);L(e.Factory.Util.bytesToHex(new Uint8Array([0,0,0,0])),d,E).then(function(e){return x(e,d,o,a,s,c,E,"LOCAL")}).then(function(e){var r=w(e);return t.serviceInfo.setParameter("CERT_ID",r),e}).then(function(r){return new Promise(function(n,o){var a=(sessionStorage.getItem("OPENCERT"),sessionStorage.getItem("cloud_cert"));if(Y.WebForm.ACTION_CHANGE_PWD===l&&"true"==a||Y.WebForm.ACTION_CERT_UPDATE===l&&"true"==a?q.writeStorage(r,!0):(q.writeStorage(r,!1),H.setItem(r)),Y.WebForm.ACTION_CERT_COPY!==l&&Y.WebForm.ACTION_CERT_ISSUE!==l&&Y.WebForm.ACTION_CERT_REISSUE!==l&&Y.WebForm.ACTION_CERT_UPDATE!==l&&Y.WebForm.ACTION_CERT_IMPORT_CLOUD!==f){M=i.getOpenstorageObject();var s=r.INHERENT_A[Y.Certs.ATTR_ISSUER];if(M&&"yessign"===s){var c=e.Factory.PriKey.makeP12CertPri(u,d);G.Log.debug("Before set timestamp:",r.OPEN_CERT.timestamp),M.set(c,r.OPEN_CERT,d,"window").then(function(e){G.Log.debug(B,"savePrivateCertificate: succeeded"),n(e)}).catch(function(e){t.serviceInfo.getExceptionCallback()&&t.serviceInfo.getExceptionCallback()(e)})}else G.Log.debug(B,"savePrivateCertificate: succeeded"),n()}else t.serviceInfo.setParameter("OPEN_CERT",r.OPEN_CERT),G.Log.debug(B,"savePrivateCertificate: succeeded"),n()})}).catch(function(e){G.Log.error("err",e),t.serviceInfo.getExceptionCallback()&&t.serviceInfo.getExceptionCallback()(e)}).finally(function(){G.Log.debug(" - save finally"),r()})},z=function(t,r,n){if(M=i.getOpenstorageObject())try{GINI_LoadingIndicatorStart("Progressing");var o=t.serviceInfo.getAction(),a=t.serviceInfo.getBehavior();n||(n=Y.WebForm.ACTION_CERT_ISSUE===o||Y.WebForm.ACTION_CERT_REISSUE===o||Y.WebForm.ACTION_CERT_UPDATE===a?"NEW_NONCE":"NONCE");var s=GINI_ProtectMgr.extract(n);s||(s=t.serviceInfo.getParameter("PWD"));var c=t.serviceInfo.getParameter("PRIVATE_KEY");typeof String==c&&(c=e.Factory.Util.privateKeyPemTagAdd(c));var u=t.serviceInfo.getParameter("CERTIFICATE");typeof String==u&&(u=e.Factory.Util.certPemTagAdd(u));var f="";t.serviceInfo.getParameter("KM_PRIVATE_KEY")&&(f=t.serviceInfo.getParameter("KM_PRIVATE_KEY"),typeof String==f&&(f=e.Factory.Util.privateKeyPemTagAdd(f)));var l="";t.serviceInfo.getParameter("KM_CERTIFICATE")&&(l=t.serviceInfo.getParameter("KM_CERTIFICATE"),typeof String==l&&(l=e.Factory.Util.certPemTagAdd(l)));var d={};d.privateKey=c,d.certificate=u,d.kmprivateKey=f,d.kmcertificate=l;var E=e.Factory.PriKey.makeP12CertPri(d,s),g=t.serviceInfo.getParameter("OPEN_CERT");t.serviceInfo.setParameter("OPEN_CERT",null);t.serviceInfo.getParameter("CERT_ISSURE");M.set(E,g,s,"window").then(function(e){GINI_LoadingIndicatorStop(),r&&r()}).catch(function(e){t.serviceInfo.getExceptionCallback()?t.serviceInfo.getExceptionCallback()(e):INI_HANDLE.handleMessage(e)})}catch(e){G.Log.error("openStorageSet catch : ",e),r&&r()}else GINI_LoadingIndicatorStop(),r&&r()},Q=function(e,t){c(e).then(function(t){return A(t[1][e.serviceInfo.getParameter("CERT_ID")],GINI_ProtectMgr.extract("NONCE"),e)}).then(function(e){"pwderror"===e?new r.Warn.newThrow(e,"WARN_1010"):t(e)}).catch(function(t){e.serviceInfo.getExceptionCallback()?e.serviceInfo.getExceptionCallback()(t):INI_HANDLE.handleMessage(t)})},Z=function(e){return new Promise(function(t,r){if(K.DeleteOption&&"Y"==K.DeleteOption.USE){var n=sessionStorage.getItem("SELECTED_CERT_INFO");void 0!==n&&n?(n=JSON.parse(n),G.Log.debug("Session val cert id:",e),e===n.certId?r():e===n.openCert.fingerprint?r():t()):t()}else t()})};return{getCertificateInfo:$,getCertAttributeList:j,selectedSignature:X,savePrivateCertificate:J,openStorageSet:z,exportCertPriP12:function(t,r){var n;c(t).then(function(e){var r=e[1];n=r[t.serviceInfo.getParameter("CERT_ID")];var o=GINI_ProtectMgr.extract("NONCE");return A(n,o,t)}).then(function(t){var o=e.Factory.PriKey.rebuildCertPriP12(t,"NONCE"),i=n.INHERENT_A,a=i[Y.Certs.ATTR_SUBJECT],s={};s.fileName=a,s.p12b64=o,r(s)}).catch(function(e){t.serviceInfo.getExceptionCallback()&&t.serviceInfo.getExceptionCallback()(t),INI_HANDLE.handleMessage(e)})},exportCertPriP12File:Q,removeCertificate:function(e,t){var r=e.serviceInfo.getParameter("CERT_ID");e.serviceInfo.setUseOpenStorage(!0),c(e).then(function(n){var o=n[1],a=o[r];a.OPEN_CERT&&a.OPEN_CERT.cloud&&a.OPEN_CERT.cloud?e.serviceInfo.setParameter("IS_CLOUD",!0):e.serviceInfo.setParameter("IS_CLOUD",!1),Z(r).then(function(){H.removeItem(r),q.removeStorage(r,!0),q.removeStorage(r,!1),M=i.getOpenstorageObject(),M?a&&a.OPEN_CERT&&a.OPEN_CERT.fingerprint?M.remove(a.OPEN_CERT.fingerprint).then(function(e){G.Log.debug("remove cert : ",e)}).finally(function(){"OPENCERT"==a.OPEN_CERT.source&&1==a.OPEN_CERT.cloud&&e.serviceInfo.setParameter("OPEN_CERT",a.OPEN_CERT),t(e)}):t(e):t&&t(e)}).catch(function(r){INI_ALERT&&K.DeleteOption&&"Y"==K.DeleteOption.USE&&INI_ALERT(K.DeleteOption.MSG),e.serviceInfo.setParameter("NOT_DISPLAY_DELETE_POPUP","TRUE"),t&&t(e)})}).catch(function(r){G.Log.error(r),t(e)})},changePassword:function(t,r){t.serviceInfo.setUseOpenStorage(!0),c(t).then(function(n){A(n[1][t.serviceInfo.getParameter("CERT_ID")],GINI_ProtectMgr.extract("NONCE"),t).then(function(n){var o=e.Factory.Certs.changePassword(n,"NONCE","NEW_NONCE");t.serviceInfo.setParameter("PRIVATE_KEY",o.privateKey),t.serviceInfo.setParameter("CERTIFICATE",o.certificate),t.serviceInfo.setParameter("PWD",t.serviceInfo.getParameter("NEW_PWD")),t.optionInfo.setParameter("USE_SESSION",!1),J(t,r,"NEW_NONCE")}).catch(function(e){t.serviceInfo.getExceptionCallback()?t.serviceInfo.getExceptionCallback()(e):INI_HANDLE.handleMessage(e)})})},checkPassword:function(t){return new Promise(function(r,n){c(t).then(function(n){var o=n[1],i=o[t.serviceInfo.getParameter("CERT_ID")];if(void 0===i){var a=sessionStorage.getItem("UPDATE_CERT_INFO");a&&(a=JSON.parse(a));var s=a.fingerprint;t.serviceInfo.setParameter("FINGERPRINT",s),i=s}A(i,GINI_ProtectMgr.extract("NONCE"),t).then(function(t){if(null===t.privateKey||void 0===t.privateKey||"pwderror"===t)r(!1);else{var n=e.Factory.Certs.checkPassword(t,"NONCE");r(n)}}).catch(function(e){t.serviceInfo.getExceptionCallback()?t.serviceInfo.getExceptionCallback()(e):INI_HANDLE.handleMessage(e)})})})},copyCertificateInfo:function(e,t){c(e).then(function(n){A(n[1][e.serviceInfo.getParameter("CERT_ID")],GINI_ProtectMgr.extract("NONCE"),e).then(function(n){"pwderror"===n?new r.Warn.newThrow(n,"WARN_1010"):(e.serviceInfo.setParameter("CERTIFICATE",n.certificate),e.serviceInfo.setParameter("PRIVATE_KEY",n.privateKey),e.serviceInfo.setParameter("KM_CERTIFICATE",n.kmCertificate),e.serviceInfo.setParameter("KM_PRIVATE_KEY",n.kmPrivateKey),e.optionInfo.setParameter("USE_SESSION",!1),t(n))}).catch(function(t){e.serviceInfo.getExceptionCallback()?e.serviceInfo.getExceptionCallback()(t):INI_HANDLE.handleMessage(t)})})},issueCertificate:function(t,r){var n=e.Factory.Util.encode64(e.Factory.Util.getRandomBytesSync(32)),o="CA_NAME="+t.requestInfo.getParameter("CA_NAME");o=o+"&CA_IP="+t.requestInfo.getParameter("CA_IP"),o=o+"&CA_PORT="+t.requestInfo.getParameter("CA_PORT"),o=o+"&REF_VALUE="+t.requestInfo.getParameter("REF_VALUE"),o=o+"&AUTH_CODE="+t.requestInfo.getParameter("AUTH_CODE"),o=o+"&RND="+encodeURIComponent(n);var i=K.System.UrlAddress.CERT_CMP_ISSUE,a=G.Transfer.xmlHttpRequest(i,o);a=a.toString().trim(),a=a.split("||");var s={};s.privateKey=a[0],s.certificate=a[1];var c=e.Factory.Certs.changePassword(s,n,t.serviceInfo.getParameter("PWD")),u={};u.PARAMS={PRIVATE_KEY:c.privateKey,CERT:c.certificate},r(u)},reIssueCertificate:function(t,r){var n=e.Factory.Util.encode64(e.Factory.Util.getRandomBytesSync(32)),o="CA_NAME="+t.requestInfo.getParameter("CA_NAME");o=o+"&CA_IP="+t.requestInfo.getParameter("CA_IP"),o=o+"&CA_PORT="+t.requestInfo.getParameter("CA_PORT"),o=o+"&REF_VALUE="+t.requestInfo.getParameter("REF_VALUE"),o=o+"&AUTH_CODE="+t.requestInfo.getParameter("AUTH_CODE"),o=o+"&RND="+encodeURIComponent(n);var i=K.System.UrlAddress.CERT_CMP_REISSUE,a=G.Transfer.xmlHttpRequest(i,o);a=a.trim(),a=a.split("||");var s={};s.privateKey=a[0],s.certificate=a[1];var c=e.Factory.Certs.changePassword(s,n,t.serviceInfo.getParameter("PWD")),u={};u.PARAMS={PRIVATE_KEY:c.privateKey,CERT:c.certificate},r(u)},updateCertificate:function(t,r){var n=e.Factory.Util.encode64(e.Factory.Util.getRandomBytesSync(32)),o={};o.privateKey=t.serviceInfo.getParameter("PRIVATE_KEY"),o.certificate=t.serviceInfo.getParameter("CERTIFICATE");var i=e.Factory.Certs.changePassword(o,t.serviceInfo.getParameter("PWD"),n),a="CA_NAME="+t.requestInfo.getParameter("CA_NAME");a=a+"&CA_IP="+t.requestInfo.getParameter("CA_IP"),a=a+"&CA_PORT="+t.requestInfo.getParameter("CA_PORT"),a=a+"&USER_PRI="+encodeURIComponent(e.Factory.Util.privateKeyPemTagRemove(i.privateKey).replace(/\r/g,"").replace(/\n/g,"").trim()),a=a+"&USER_CERT="+encodeURIComponent(e.Factory.Util.certPemTagRemove(i.certificate).replace(/\r/g,"").replace(/\n/g,"").trim()),a=a+"&RND="+encodeURIComponent(n);var s=K.System.UrlAddress.CERT_CMP_UPDATE,c=G.Transfer.xmlHttpRequest(s,a);c=c.trim(),c=c.split("||");var u={};u.privateKey=c[0],u.certificate=c[1];var i=e.Factory.Certs.changePassword(u,n,t.serviceInfo.getParameter("NEW_PWD")),f={};f.PARAMS={PRIVATE_KEY:i.privateKey,CERT:i.certificate},r(f)},revokeCertificate:function(e,t){var r=K.System.UrlAddress.CERT_CMP_REVOKE;G.Transfer.xmlHttpRequest(r,"")},decryptedCertPri:A,getCertificate:function(t){var r=t.serviceInfo.getParameter("CERT_ID"),n=q.readStorage(!0),o=q.readStorage(!1),i=d(n,o),a=void 0;return new Promise(function(n,o){if(i&&i[r])if(a=i[r],a.INHERENT_C&&a.INHERENT_S){var s=e.Factory.Util.hexToBytes(a.INHERENT_C),u=e.Factory.Util.createBuffer(s),f=e.integrityDecrypt(u,a.INHERENT_S);n(f)}else a.OPEN_CERT&&n(a.OPEN_CERT.subject);else c(t).then(function(e){var t=e[1];t[r]&&n(t[r].OPEN_CERT.subject)}).catch(function(e){G.Log.error(e),n(void 0)})})},OpenCertClose:function(e){M=i.getOpenstorageObject(),G.Log.debug("Close Openstorage Handleinfo:",e),M&&M.close()},getCertificateWithCache:function(e){return new Promise(function(t,r){c(e).then(function(r){var n=r[1],o=e.serviceInfo.getParameter("CERT_ID");for(cert in n)cert==o&&t(n[cert]);t(void 0)}).catch(function(e){G.Log.error(e),t(void 0)})})}}}.apply(t,o))&&(e.exports=i)}).call(t,r(0))},68:function(e,t,r){(function(n,o){var i,a;i=[r(10)],void 0!==(a=function(e){return{Repository:function(){var t=cwui_conf.defaultConf,r=cwui_conf.utils,i=t.System.CrossDomainStorageURL,a=i.dns||"",s=i.path||"",c="WhiteList="+encodeURIComponent(JSON.stringify(t.WhiteList)),u={},f=null,l=!1,d=a,E=s+"?"+c,g=[],I={},p=0,_=function(){var t=!1;try{if(!(t=window.postMessage&&window.JSON&&"localStorage"in window&&null!==window.localStorage))throw"Not support cross domain repository";if(!window.jQuery)throw"Not support jQuery"}catch(t){new e.Error.newThrow(t,"ERR_1001")}return t}(),C=function(e){f&&(null!=f.contentWindow?(I[e.request.id]=e,f.contentWindow.postMessage(JSON.stringify(e.request),d)):(l=!1,m(),g.push(e)))},v=function(){if(l=!0,g.length){for(var e=0,t=g.length;e<t;e++)C(g[e]);g=[]}},R=function(e){if(e.origin===d&&e.data){var t;if(e.data.constructor==="string".constructor){if(!e.data||-1===e.data.indexOf("CROSS_LOCAL"))return;t=JSON.parse(e.data)}else t=e.data;if(void 0!==I[t.id]){if(void 0!==I[t.id].deferred&&I[t.id].deferred.resolve(t.value),"function"==typeof I[t.id].callback){r.Log.debug("[101]Cross Domain callback data"),r.Log.debug(t.param),r.Log.debug(t.value),r.Log.debug("[101]------------------------------------------------");var n=t.value;I[t.id].callback(t.param,n)}delete I[t.id]}}};u.getItem=function(e,t){if(_){var r={id:++p,type:"get",param:e},o={request:r,callback:t};if(window.jQuery&&(o.deferred=n.Deferred()),l?C(o):g.push(o),window.jQuery)return o.deferred.promise()}else t(void 0,e.CROSS_LOCAL)};var m=function(){document.body.appendChild(f),window.addEventListener?(f.addEventListener("load",function(){v()},!1),window.addEventListener("message",function(e){R(e)},!1)):f.attachEvent&&(f.attachEvent("onload",function(){v()},!1),window.attachEvent("onmessage",function(e){R(e)})),r.Log.debug("Cross Domain : "+d+E),f.src=d+E};return u.setItem=function(e){if(_){var t={id:++p,type:"set",value:e},r={request:t};if(window.jQuery&&(r.deferred=n.Deferred()),l?C(r):g.push(r),window.jQuery)return r.deferred.promise()}},u.removeItem=function(e){if(_){var t={id:++p,type:"unset",certId:e},r={request:t};if(window.jQuery&&(r.deferred=n.Deferred()),l?C(r):g.push(r),window.jQuery)return r.deferred.promise()}},u.clearItem=function(){if(_){var e={id:++p,type:"clear"},t={request:e};if(window.jQuery&&(t.deferred=n.Deferred()),l?C(t):g.push(t),window.jQuery)return t.deferred.promise()}},u.refresh=function(e,t){if(e){var r={id:++p,type:"refresh",param:t},o={request:r};if(window.jQuery&&(o.deferred=n.Deferred()),l?C(o):g.push(o),window.jQuery)return o.deferred.promise()}},o(document).ready(function(){!f&&_?(f=document.createElement("iframe"),f.style.cssText="position:absolute;width:1px;height:1px;left:-9999px;top:-9999px",f.title="Cross Domain Process",document.body.appendChild(f),window.addEventListener?(f.addEventListener("load",function(){v()},!1),window.addEventListener("message",function(e){R(e)},!1)):f.attachEvent&&(f.attachEvent("onload",function(){v()},!1),window.attachEvent("onmessage",function(e){R(e)})),r.Log.debug("Cross Domain : "+d+E),f.src=d+E):(f=void 0,f=document.createElement("iframe"),f.style.cssText="position:absolute;width:1px;height:1px;left:-9999px;",f.title="Cross Domain Process",m())}),u}}}.apply(t,i))&&(e.exports=a)}).call(t,r(0),r(0))},69:function(e,t,r){(function(n){var o,a;o=[r(25),r(66),r(70),r(67),r(8),r(10),r(34)],void 0!==(a=function(e,t,r,o,a,s,c){function u(e){try{p.System.ExternalType==C.System.EXTERNAL_CROSSWEB_EX?(e.GET_RESULT="FALSE",INIWEBEX.requestCmd({params:encodeURIComponent(JSON.stringify(e)),processCallback:"GINI_External_Response_Factory.proc"})):p.System.ExternalType==C.System.EXTERNAL_MOASIGN_EX&&(e.GET_RESULT="TRUE",_.Transfer.iframeLocalPostSend(e,GINI_External_Response_Factory.proc))}catch(e){_.Log.error("[ERROR]",e)}}function f(e){var t=a.Factory.Util.getRandomBytesSync(e);do{var r=a.Factory.Util.getRandomBytesSync(e)}while(t==r);return a.Factory.Util.bytesToHex(r)}function l(e,t,r,n,o){if(void 0!=r&&e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER)r(e,t);else{var i=f(16);if(GINI_StandbyCallBack.setCallback(i,t),GINI_StandbyCallBack.setExceptionCallback(i,e.serviceInfo.getExceptionCallback()),o)n(e,t,g);else{var a=e.serviceInfo.getParameter("ENCRYPTED");if(a&&"FALSE"!==a){(function(){return new Promise(function(e,t){if(g&&g.isComplete)e();else{var r=function(){g&&g.isComplete?e():setTimeout(function(){r()},100)};r()}})})().then(function(){u(n(e,i,g))})}else u(n(e,i,g))}}}function d(e){function t(t,r){var n=e.serviceInfo.getParameter(t);if(n){if(!n.GetInputLength)return n;var o=n.GetInputLength(),i="",a=0;for(a=0;a<o;a++)i+=n.GetInputData(a);GINI_ProtectMgr.keep(r,i),i=0}}var r,n,o,i,a,s;try{if("TRUE"==e.serviceInfo.getParameter("ENCRYPTED"))r=e.serviceInfo.getParameter("PWD"),n=e.serviceInfo.getParameter("PWD_CNF"),o=e.serviceInfo.getParameter("NEW_PWD"),i=e.serviceInfo.getParameter("NEW_PWD_CNF"),e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_TOKEN||e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_DEVICE||e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SCARD?a=e.serviceInfo.getParameter("PIN"):e.serviceInfo.getParameter("TARGET_DEVICE_ID")!==C.Certs.STORAGE_SECURITY_TOKEN&&e.serviceInfo.getDeviceId()!==C.Certs.STORAGE_SECURITY_DEVICE&&e.serviceInfo.getDeviceId()!==C.Certs.STORAGE_SCARD||(s=e.serviceInfo.getParameter("TARGET_PIN"));else{p.KeyStrokeSecurity.KeyStrokeSecurityList?(t("PWD","NONCE"),t("PWD_CNF","NONCE_CNF"),t("NEW_PWD","NEW_NONCE"),t("NEW_PWD_CNF","NEW_NONCE_CNF"),t("PIN","SECURE"),t("TARGET_PIN","TARGET_SECURE"),r=GINI_ProtectMgr.extract("NONCE"),n=GINI_ProtectMgr.extract("NONCE_CNF"),o=GINI_ProtectMgr.extract("NEW_NONCE"),i=GINI_ProtectMgr.extract("NEW_NONCE_CNF"),a=GINI_ProtectMgr.extract("SECURE"),s=GINI_ProtectMgr.extract("TARGET_SECURE")):(r=e.serviceInfo.getParameter("PWD"),n=e.serviceInfo.getParameter("PWD_CNF"),o=e.serviceInfo.getParameter("NEW_PWD"),i=e.serviceInfo.getParameter("NEW_PWD_CNF"),a=e.serviceInfo.getParameter("PIN"),s=e.serviceInfo.getParameter("TARGET_PIN"),GINI_ProtectMgr.keep("NONCE",r),GINI_ProtectMgr.keep("NONCE_CNF",n),GINI_ProtectMgr.keep("NEW_NONCE",o),GINI_ProtectMgr.keep("NEW_NONCE_CNF",i),GINI_ProtectMgr.keep("SECURE",a),GINI_ProtectMgr.keep("TARGET_SECURE",s))}return!0}catch(t){if(e.serviceInfo.setParameter("PWD",""),e.serviceInfo.setParameter("PWD_CNF",""),e.serviceInfo.setParameter("NEW_PWD",""),e.serviceInfo.setParameter("NEW_PWD_CNF",""),e.serviceInfo.setParameter("PIN",""),e.serviceInfo.setParameter("TARGET_PIN",""),e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),e.serviceInfo.getDeviceId()!=C.Certs.STORAGE_BROWSER||e.serviceInfo.getDeviceId()==C.Certs.STORAGE_BROWSER&&C.WebForm.ACTION_CERT_EXPORT_FILE===e.serviceInfo.getBehavior())return INI_ALERT(R.getMessageFactory().Warn[t.name],"WARN"),!1;throw t}finally{r=0,n=0,o=0,i=0,a=0,s=0}}function E(e){function t(t,r){var n=e.serviceInfo.getParameter(t);if(n){if(!n.GetInputLength)return n;var o=n.GetInputLength(),i=0,a="";for(i=0;i<o;i++)a+=n.GetInputData(i);GINI_ProtectMgr.keep(r,a),a=0}}if(e.serviceInfo.getDeviceId()==C.Certs.STORAGE_USIM||e.serviceInfo.getDeviceSub()==C.Certs.STORAGE_PHONE_MOBISIGN||e.serviceInfo.getDeviceId()==C.Certs.SMART_CERTIFY||e.serviceInfo.getDeviceId()==C.Certs.STORAGE_SECURITY_TOKEN)return!0;var r,o,i,a,c,u;try{if("TRUE"==e.serviceInfo.getParameter("ENCRYPTED"))r=e.serviceInfo.getParameter("PWD"),o=e.serviceInfo.getParameter("PWD_CNF"),i=e.serviceInfo.getParameter("NEW_PWD"),a=e.serviceInfo.getParameter("NEW_PWD_CNF"),e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_TOKEN||e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_DEVICE||e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SCARD?c=e.serviceInfo.getParameter("PIN"):e.serviceInfo.getDeviceId()!==C.Certs.STORAGE_SECURITY_TOKEN&&e.serviceInfo.getDeviceId()!==C.Certs.STORAGE_SECURITY_DEVICE&&e.serviceInfo.getDeviceId()!==C.Certs.STORAGE_SCARD&&e.serviceInfo.getParameter("TARGET_DEVICE_ID")!==C.Certs.STORAGE_SECURITY_TOKEN||(u=e.serviceInfo.getParameter("TARGET_PIN"));else{p.KeyStrokeSecurity.KeyStrokeSecurityList?(t("PWD","NONCE"),t("PWD_CNF","NONCE_CNF"),t("NEW_PWD","NEW_NONCE"),t("NEW_PWD_CNF","NEW_NONCE_CNF"),t("PIN","SECURE"),t("TARGET_PIN","TARGET_SECURE"),r=GINI_ProtectMgr.extract("NONCE"),o=GINI_ProtectMgr.extract("NONCE_CNF"),i=GINI_ProtectMgr.extract("NEW_NONCE"),a=GINI_ProtectMgr.extract("NEW_NONCE_CNF"),c=GINI_ProtectMgr.extract("SECURE"),u=GINI_ProtectMgr.extract("TARGET_SECURE")):(r=e.serviceInfo.getParameter("PWD"),o=e.serviceInfo.getParameter("PWD_CNF"),i=e.serviceInfo.getParameter("NEW_PWD"),a=e.serviceInfo.getParameter("NEW_PWD_CNF"),c=e.serviceInfo.getParameter("PIN"),u=e.serviceInfo.getParameter("TARGET_PIN"),GINI_ProtectMgr.keep("NONCE",r),GINI_ProtectMgr.keep("NONCE_CNF",o),GINI_ProtectMgr.keep("NEW_NONCE",i),GINI_ProtectMgr.keep("NEW_NONCE_CNF",a),GINI_ProtectMgr.keep("SECURE",c),GINI_ProtectMgr.keep("TARGET_SECURE",u))}if(!r&&"TRUE"!==e.serviceInfo.getParameter("ENCRYPTED")&&e.serviceInfo.getBehavior()==C.WebForm.ACTION_CERT_UPDATE){var f=O.getSelectedReNewCertInfo();GINI_ProtectMgr.keep("NONCE",f.ep&&f.ep.epText)}if(e.serviceInfo.getDeviceId()!==C.Certs.STORAGE_SECURITY_TOKEN||e.serviceInfo.getParameter("TARGET_DEVICE_ID")||e.serviceInfo.getBehavior()==C.WebForm.ACTION_CERT_COPY||c&&""!==c||(e.serviceInfo.setParameter("PIN",""),new s.Warn.newThrow(null,"WARN_1030")),e.serviceInfo.getParameter("TARGET_DEVICE_ID")===C.Certs.STORAGE_SECURITY_TOKEN&&e.serviceInfo.getBehavior()===C.WebForm.ACTION_CERT_COPY&&(u&&""!==u||(e.serviceInfo.setParameter("TARGET_PIN",""),new s.Warn.newThrow(null,"WARN_1030"))),!r){var l=e.serviceInfo.getBehavior(),d=e.serviceInfo.getAction();C.WebForm.ACTION_CERT_ISSUE==l||C.WebForm.ACTION_CERT_REISSUE==l||C.WebForm.ACTION_CERT_UPDATE==l||C.WebForm.ACTION_CERT_REMOVE==l||C.WebForm.ACTION_CERT_NOVIEWSIGN==l||C.WebForm.ACTION_CERT_SAVE==l&&C.WebForm.ACTION_CERT_ISSUE==d||C.WebForm.ACTION_CERT_SAVE==l&&C.WebForm.ACTION_CERT_REISSUE==d||new s.Warn.newThrow(null,"WARN_1012")}if(e.serviceInfo.getBehavior()!=C.WebForm.ACTION_CERT_ISSUE&&e.serviceInfo.getBehavior()!=C.WebForm.ACTION_CERT_REISSUE&&e.serviceInfo.getBehavior()!=C.WebForm.ACTION_CERT_UPDATE||e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_TOKEN){if(e.serviceInfo.getBehavior()==C.WebForm.ACTION_CHANGE_PWD&&(i&&a&&""!=i&&""!=a||new s.Warn.newThrow(null,"WARN_1016"),"TRUE"!==e.serviceInfo.getParameter("ENCRYPTED")))if(i!=a)new s.Warn.newThrow(null,"WARN_1017");else{var E=O.checkComplexPassword(i);if(!E.check){var g={};return g.OK=function(){e.serviceInfo.getParameter("SEL_KEYSTROKE_TYPE")===C.KeyStrokeSecurity.TYPE.KEYPAD?(n("#ini_cert_pwd").focus(),n("#ini_cert_pwd").click()):n("#ini_cert_pwd").focus()},INI_ALERT(E.message,"WARN",g),!1}}}else if(i&&a&&""!=i&&""!=a||new s.Warn.newThrow(null,"WARN_1058"),"TRUE"!==e.serviceInfo.getParameter("ENCRYPTED"))if(i!=a)new s.Warn.newThrow(null,"WARN_1018");else{var E=O.checkComplexPassword(i);if(!E.check){var g={};return g.OK=function(){e.serviceInfo.getParameter("SEL_KEYSTROKE_TYPE")===C.KeyStrokeSecurity.TYPE.KEYPAD?(n("#ini_cert_new_pwd").focus(),n("#ini_cert_new_pwd").click()):n("#ini_cert_new_pwd").focus()},INI_ALERT(E.message,"WARN",g),!1}}return!0}catch(t){if(e.serviceInfo.setParameter("PWD",""),e.serviceInfo.setParameter("PWD_CNF",""),e.serviceInfo.setParameter("NEW_PWD",""),e.serviceInfo.setParameter("NEW_PWD_CNF",""),e.serviceInfo.setParameter("PIN",""),e.serviceInfo.setParameter("TARGET_PIN",""),e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(t),e.serviceInfo.getDeviceId()==C.Certs.STORAGE_BROWSER&&e.serviceInfo.getBehavior()==C.WebForm.ACTION_CERT_UPDATE&&e.serviceInfo.getAction()==C.WebForm.ACTION_CERT_CMP)return!1;if(e.serviceInfo.getDeviceId()!=C.Certs.STORAGE_BROWSER||e.serviceInfo.getDeviceId()==C.Certs.STORAGE_BROWSER&&C.WebForm.ACTION_CERT_EXPORT_FILE===e.serviceInfo.getBehavior()){if("WARN_1018"==t.name||"WARN_1012"==t.name||"WARN_1017"==t.name||"WARN_1058"==t.name||"WARN_1016"==t.name){var g={};g.OK=function(){var t=e.serviceInfo.getBehavior();if(t==C.WebForm.ACTION_CERT_ISSUE||t==C.WebForm.ACTION_CERT_REISSUE){var r=e.serviceInfo.getParameter("SEL_KEYSTROKE_TYPE");r===C.KeyStrokeSecurity.TYPE.KEYPAD?(n("#ini_cert_new_pwd").focus(),n("#ini_cert_new_pwd").click()):n("#ini_cert_new_pwd").focus()}else if(t==C.WebForm.ACTION_CERT_UPDATE||t==C.WebForm.ACTION_CHANGE_PWD||t==C.WebForm.ACTION_CERT_COPY||t==C.WebForm.ACTION_LOGIN||t==C.WebForm.ACTION_SIGN||t==C.WebForm.ACTION_CERT_SAVE||t==C.WebForm.ACTION_CERT_EXPORT_FILE||t==C.WebForm.ACTION_CERT_CMP){var o=n("#ini_cert_pwd").attr("disabled");o&&(n("#ini_cert_pwd").removeAttr("disabled"),n("#ini_cert_pwd").next(".keyboard").css("pointer-events","auto"));var r=e.serviceInfo.getParameter("SEL_KEYSTROKE_TYPE");r===C.KeyStrokeSecurity.TYPE.KEYPAD?(n("#ini_cert_pwd").focus(),n("#ini_cert_pwd").click()):n("#ini_cert_pwd").focus()}},INI_ALERT(R.getMessageFactory().Warn[t.name],"WARN",g)}else INI_ALERT(R.getMessageFactory().Warn[t.name],"WARN");return!1}throw t}finally{r=0,o=0,i=0,a=0,c=0,u=0}}var g,I,p=cwui_conf.defaultConf,_=cwui_conf.utils,C=cwui_conf.constants,v=cwui_conf.unihan,R=cwui_conf.msgFactory,m=e.forge,T="[MIDDLE_CHANNEL]",S=function(){return{initialize:function(){sessionStorage.removeItem("UPDATE_CERT_INFO")},setUpdateCertInfo:function(e,t){var r={};if(r.deviceId=e.serviceInfo.getDeviceId(),r.deviceSub=e.serviceInfo.getDeviceSub(),e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER){var n=e.serviceInfo.getDecryptedBrowserCert(),o=(n.INHERENT_A[C.Certs.ATTR_ISSUER]+"-"+n.INHERENT_A[C.Certs.ATTR_SERIAL]).replace(/ /gi,"_");if("OPENCERT"==n.OPEN_CERT.source){var i=n.OPEN_CERT.fingerprint;r.fingerprint=i,sessionStorage.setItem("OPENCERT",!0)}r.certId=o}else r.certId=e.serviceInfo.getParameter("CERT_ID");var a;a=e.serviceInfo.getDeviceId()==C.Certs.STORAGE_SCARD||e.serviceInfo.getDeviceId()==C.Certs.STORAGE_SECURITY_DEVICE||e.serviceInfo.getDeviceId()==C.Certs.STORAGE_SECURITY_TOKEN?e.serviceInfo.getParameter("PIN"):e.serviceInfo.getParameter("PWD"),a&&(r.ep={},r.ep.epText=h(r.certId,a)),void 0!==t&&(r.certificate=t.certificate,r.privateKey=t.privateKey,t.kmCertificate&&(r.kmCertificate=t.kmCertificate),t.kmPrivateKey&&(r.kmPrivateKey=t.kmPrivateKey)),sessionStorage.removeItem("UPDATE_CERT_INFO"),sessionStorage.setItem("UPDATE_CERT_INFO",JSON.stringify(r)),r=0},getUpdateCertInfo:function(){try{var e=sessionStorage.UPDATE_CERT_INFO;return e?(e=JSON.parse(e),e&&e.ep&&e.ep.epText&&(e.ep.epText=P(e.certId,e.ep.epText)),e):""}catch(e){_.Log.error("ë³µí¸í ì¤ë¥",e),new s.Error.newThrow(e,"ERR_1006")}}}}(),h=function(e,t){var r=a.Factory.Cipher.doDigest(C.Cipher.HASH_SHA256,e,"UTF-8");if(void 0===r)throw _.Log.error("Please try again in a few seconds.[#3]"),new Error("Please try again in a few seconds.[#3]");var n=r.substring(0,16),o=r.substring(16),i="01"+a.Factory.Util.getBytes(16)+t,s=a.Factory.Util.createBuffer(i),c=a.Factory.Cipher.symmetricEncrypt(C.Cipher.SYMM_AES_CBC,n,o,s),u=c.getBytes();return a.Factory.Util.encode64(u)},P=function(e,t){var r=a.Factory.Cipher.doDigest(C.Cipher.HASH_SHA256,e,"UTF-8");if(void 0===r)throw _.Log.error("Please try again in a few seconds.[#4]"),new Error("Please try again in a few seconds.[#4]");var n=r.substring(0,16),o=r.substring(16),i=a.Factory.Util.decode64(t),s=a.Factory.Util.createBuffer(i),c=a.Factory.Cipher.symmetricDecrypt(C.Cipher.SYMM_AES_CBC,n,o,s);if(void 0===c.data)throw _.Log.error("Please try again in a few seconds.[#5]"),new Error("Please try again in a few seconds.[#5]");return"01"!==c.data.substring(0,2)?null:c.data.substring(18)},N=function(){var e=function(e,t,r,n,o,i){try{var a={};a.deviceId=e,a.deviceSub=t,a.certId=r,n&&(a.clientPushId=n),o&&(a.ep={},a.ep.epText=h(r,o)),i&&(a.openCert=i),sessionStorage.removeItem("SELECTED_CERT_INFO"),sessionStorage.setItem("SELECTED_CERT_INFO",JSON.stringify(a))}catch(e){new s.Error.newThrow(e,"ERR_1005")}},t=function(){try{var e=sessionStorage.SELECTED_CERT_INFO;return e?(e=JSON.parse(e),e&&e.ep&&e.ep.epText&&(e.ep.epText=P(e.certId,e.ep.epText)),e):""}catch(e){_.Log.error("ë³µí¸í ì¤ë¥",e),new s.Error.newThrow(e,"ERR_1006")}};return{initialize:function(e){sessionStorage.removeItem("SELECTED_CERT_INFO"),"function"==typeof e&&e()},setSelectedCert:e,getSelectedCert:t}}(),y=function(){function e(e){try{_.Log.debug(T,"filterCache: start",e);var t=N.getSelectedCert();if(void 0!==t){var r={};for(attr in e){if(_.Log.debug(T,"filterCache: certId:",attr),t.certId===attr)return r[attr]=e[attr],_.Log.debug(T,"filterCache: succeeded",r),r;_.Log.debug(T,"filterCache: filtered",attr)}}return _.Log.debug(T,"filterCache: did not filtered",e),e}catch(t){_.Log.error(T,"filterCache: failed",t),new s.Error.newThrow(t,"ERR_2001",e)}}function t(e){try{_.Log.debug(T,"filterExpire: start",e);var t={};for(attr in e){var r=e[attr][C.Certs.ATTR_EXPIRE];_.Log.debug(T,"filterExpire: certId",attr);new Date(r.replace(/-/g,"/")).valueOf()/864e5-(new Date).valueOf()/864e5>0?t[attr]=e[attr]:_.Log.debug(T,"filterExpire: filtered",attr)}return _.Log.debug(T,"filterExpire: succeeded",t),t}catch(t){_.Log.error(T,"filterExpire: failed",t),new s.Error.newThrow(t,"ERR_2002",e)}}function n(e,t){try{if(_.Log.debug(T,"filterOid: start",t,e),e.length>0){var r={};for(attr in t){_.Log.debug(T,"filterOid: certId",attr);var n=t[attr][C.Certs.ATTR_OID];_.Collection.exist(e,n)?r[attr]=t[attr]:_.Log.debug(T,"filterOid: filtered",attr)}return _.Log.debug(T,"filterOid: succeeded",r),r}return _.Log.debug(T,"filterOid: did not filtered",t),t}catch(e){_.Log.error(T,"filterOid: failed",e),new s.Error.newThrow(e,"ERR_2003",t)}}function o(e,t){try{if(_.Log.debug(T,"filterIssuerO: start",t,e),e.length>0){var r={};for(attr in t){_.Log.debug(T,"filterIssuerO: certId",attr);var n=t[attr][C.Certs.ATTR_ISSUER];_.Collection.exist(e,n)?r[attr]=t[attr]:_.Log.debug(T,"filterIssuerO: filtered",attr)}return _.Log.debug(T,"filterIssuerO: succeeded",r),r}return _.Log.debug(T,"filterIssuerO: did not filtered",t),t}catch(e){_.Log.error(T,"filterIssuerO: failed",e),new s.Error.newThrow(e,"ERR_2004",t)}}function i(e,t){try{if(_.Log.debug(T,"filterIssuerCN: start",t,e),e.length>0){var r={};for(attr in t){_.Log.debug(T,"filterIssuerCN: certId",attr);var n=t[attr][C.Certs.ATTR_ISSUER_CN];_.Collection.exist(e,n)?r[attr]=t[attr]:_.Log.debug(T,"filterIssuerCN: filtered",attr)}return _.Log.debug(T,"filterIssuerCN: succeeded",r),r}return _.Log.debug(T,"filterIssuerCN: did not filtered",t),t}catch(e){_.Log.error(T,"filterIssuerCN: failed",e),new s.Error.newThrow(e,"ERR_2005",t)}}function a(e){try{_.Log.debug(T,"filterIssuerHash: start",e);var t={},n=[],o=p.System.OperationMode;if(o===C.System.REAL_MODE||o===C.System.REAL_TEST_MODE)for(var i=0;i<r.realCaCerts.length;i++)n.push(r.realCaCerts[i]);if(o===C.System.TEST_MODE||o===C.System.REAL_TEST_MODE)for(var i=0;i<r.testCaCerts.length;i++)n.push(r.testCaCerts[i]);for(attr in e){_.Log.debug(T,"filterIssuerHash: certId",attr);for(var a=e[attr][C.Certs.ATTR_ISSUER_C],c=e[attr][C.Certs.ATTR_ISSUER_O],u=e[attr][C.Certs.ATTR_ISSUER_OU],f=e[attr][C.Certs.ATTR_ISSUER_CN],l=!1,i=0;i<n.length;i++){for(var d="",E="",g="",I="",v=n[i].subject.attributes,R=0;R<v.length;R++)switch(v[R].shortName){case"C":d=v[R].value;break;case"O":E=v[R].value;break;case"OU":g=v[R].value;break;case"CN":I=v[R].value}if(a===d&&c===E&&u===g&&f===I){t[attr]=e[attr],l=!0;break}}l||_.Log.debug(T,"filterIssuerHash: filtered",attr)}return _.Log.debug(T,"filterIssuerHash: succeeded",t),t}catch(t){_.Log.error(T,"filterIssuerHash: failed",t),new s.Error.newThrow(t,"ERR_2006",e)}}function c(e,t){try{var r=[];if(t?r.push(t):r=JSON.parse(sessionStorage.getItem("FILTER_SERIALNO")),_.Log.debug(T,"filterSerialNo: start",e,r),r&&r.length>0){var n={};for(attr in e){_.Log.debug(T,"filterSerialNo: certId",attr);for(var o=!1,i=0;i<r.length;i++)if(e[attr].SERIAL.toUpperCase()===r[i].toUpperCase()){n[attr]=e[attr],o=!0;break}o||_.Log.debug(T,"filterSerialNo: filtered",attr)}return _.Log.debug(T,"filterSerialNo: succeeded",n),n}return _.Log.debug(T,"filterSerialNo: did not filtered",e),e}catch(t){_.Log.error(T,"filterSerialNo: failed",t),new s.Error.newThrow(t,"ERR_2007",e)}}function u(e){try{var t=JSON.parse(sessionStorage.getItem("FILTER_OU"));if(_.Log.debug(T,"filterOU: start",e,t),null!==t&&t.length>0){var r={};for(attr in e){_.Log.debug(T,"filterOU: certId",attr);for(var n=e[attr][C.Certs.ATTR_SUBJECT_OU],o=0;o<t.length;o++)if(void 0!==n){if(n.toUpperCase()===t[o].toUpperCase()){r[attr]=e[attr];break}_.Log.debug(T,"filterOU: filtered",attr)}}return _.Log.debug(T,"filterOU: succeeded",r),r}return _.Log.debug(T,"filterOU: did not filtered",e),e}catch(t){_.Log.error(T,"filterOU: failed",t),new s.Error.newThrow(t,"ERR_2007",e)}}function f(e){_.Log.debug(T,"sortCerfiticate: start",e);var t=p.Certs.SortObject;if(t){var r="ASC"==p.Certs.SortType,n=[];for(attr in e)n.push(e[attr]);for(var o=1;o<n.length;o++)for(var i=0;i<n.length-o;i++)if(r){if(n[i][t]>n[i+1][t]){var a=n[i],s=n[i+1];n[i]=s,n[i+1]=a}}else if(n[i][t]<n[i+1][t]){var a=n[i],s=n[i+1];n[i]=s,n[i+1]=a}for(var c={},o=0;o<n.length;o++){var u=l(n[o]);for(attr in e){if(u==l(e[attr])){c[attr]=n[o];break}}}return _.Log.debug(T,"sortCerfiticate: succeeded",c),c}return _.Log.debug(T,"sortCerfiticate: did not sorted",e),e}function l(e){return void 0==e[C.Certs.ATTR_SERIAL]&&e.fingerprint?e.fingerprint:e[C.Certs.ATTR_ISSUER]+"-"+e[C.Certs.ATTR_SERIAL]}function d(e,t){try{var r=JSON.parse(sessionStorage.getItem("FILTER_ISSUER_DN"));if(_.Log.debug(T,"filterIssuerDN: start",e,r),null!==r&&r.length>0){var n={};for(attr in e){_.Log.debug(T,"filterIssuerDN: certId",attr);var o=v.convertEucKrToUtf8(unescape(attr),!1);if(void 0===o)throw new Error("Please try again in a few seconds.[#7]");o=o.substring(3,o.length);var i="";if(t.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER){e[attr][C.Certs.ATTR_ISSUER_CN]&&(i+="cn="+e[attr][C.Certs.ATTR_ISSUER_CN]),e[attr][C.Certs.ATTR_ISSUER_OU]&&(i+=",ou="+e[attr][C.Certs.ATTR_ISSUER_OU]),e[attr][C.Certs.ATTR_ISSUER_O]&&(i+=",o="+e[attr][C.Certs.ATTR_ISSUER_O]),e[attr][C.Certs.ATTR_ISSUER_C]&&(i+=",c="+e[attr][C.Certs.ATTR_ISSUER_C]);","===i.charAt(0)&&(i=i.substring(1,i.length))}else i=o.split("&")[0];for(var a=!1,c=0;c<r.length;c++)if(r[c].toUpperCase()===i.toUpperCase()){n[attr]=e[attr],a=!0;break}a||_.Log.debug(T,"filterIssuerDN: filtered",attr)}return _.Log.debug(T,"filterIssuerDN: succeeded",n),n}return _.Log.debug(T,"filterIssuerDN: did not filtered",e),e}catch(t){_.Log.error(T,"filterIssuerDN: failed",t),new s.Error.newThrow(t,"ERR_2008",e)}}function E(e){try{var t=JSON.parse(sessionStorage.getItem("FILTER_OID"));if(_.Log.debug(T,"filterOIDAlias: start",e,t),null!==t&&t.length>0){var r={};for(attr in e){_.Log.debug(T,"filterOIDAlias: certId",attr);for(var n=!1,o=0;o<t.length;o++)if(t[o]===e[attr].OID){r[attr]=e[attr],n=!0;break}n||_.Log.debug(T,"filterOIDAlias: filtered",attr)}return _.Log.debug(T,"filterOIDAlias: succeeded",r),r}return _.Log.debug(T,"filterOIDAlias: did not filtered",e),e}catch(t){_.Log.error(T,"filterOIDAlias: failed",t),new s.Error.newThrow(t,"ERR_2009",e)}}function g(e){try{_.Log.debug(T,"filterBrowserOnlyLocal: start",e);var t={};for(attr in e){_.Log.debug(T,"filterBrowserOnlyLocal: certId",attr);"OPENCERT"!==e[attr][C.Certs.ATTR_SOURCE]?t[attr]=e[attr]:_.Log.debug(T,"filterBrowserOnlyLocal: filtered",attr)}return _.Log.debug(T,"filterBrowserOnlyLocal: succeeded",t),t}catch(t){_.Log.error(T,"filterBrowserOnlyLocal: failed",t),new s.Error.newThrow(t,"ERR_2005",e)}}function I(e){try{_.Log.debug(T,"filterBrowserOnlyOpen: start",e);var t={};for(attr in e){_.Log.debug(T,"filterBrowserOnlyOpen: certId",attr);var r=e[attr][C.Certs.ATTR_SOURCE],n=e[attr][C.Certs.ATTR_CLOUD];"OPENCERT"===r&&!1!==n?t[attr]=e[attr]:_.Log.debug(T,"filterBrowserOnlyOpen: filtered",attr)}return _.Log.debug(T,"filterBrowserOnlyOpen: succeeded",t),t}catch(t){_.Log.error(T,"filterBrowserOnlyOpen: failed",t),new s.Error.newThrow(t,"ERR_2005",e)}}function R(e,t){try{if(_.Log.debug(T,"filterBankCode: start",t,e),null!==e&&e.length>0){var r={};for(attr in t){_.Log.debug(T,"filterBankCode: certId",attr);for(var n=t[attr].SUBJECT_CN,o=n.indexOf(")"),i=o>0&&n.length>=o+4?n.substring(o+3,o+5):"",a=0;a<e.length;a++){if(i===e[a]){r[attr]=t[attr];break}_.Log.debug(T,"filterBankCode: filtered",attr)}}return _.Log.debug(T,"filterBankCode: succeeded",r),r}return _.Log.debug(T,"filterBankCode: did not filtered",t),t}catch(e){_.Log.error(T,"filterBankCode: failed",e),new s.Error.newThrow(e,"ERR_2007",t)}}function m(e,t){try{_.Log.debug(T,"filterRemainExpireDate: start",t);var r={};e<=0&&_.Log.debug(T,"filterRemainExpireDate: not filtered remainDate",e);for(attr in t){var n=t[attr][C.Certs.ATTR_EXPIRE];_.Log.debug(T,"filterRemainExpireDate: certId",attr);var o=new Date(n.replace(/-/g,"/")),i=o.valueOf()/864e5-(new Date).valueOf()/864e5;i>0&&i<e?r[attr]=t[attr]:_.Log.debug(T,"filterRemainExpireDate: filtered",attr)}return _.Log.debug(T,"filterRemainExpireDate: succeeded",r),r}catch(e){_.Log.error(T,"filterRemainExpireDate: failed",e),new s.Error.newThrow(e,"ERR_2007",t)}}function S(r,l,v,R,m){try{if(_.Log.debug(T,"filterCertificates: start",v,r,l,R),l===C.WebForm.ACTION_CERT_UPDATE&&void 0!==R)v=c(v,R);else if(r===C.WebForm.ACTION_CERT_IMPORT_CLOUD)v=I(v);else if(r===C.WebForm.ACTION_CERT_EXPORT_CLOUD)v=g(v);else if(r!==C.WebForm.ACTION_MANAGE){var S=p.Certs.FilterList;_.Log.debug(T,"filterCertificates: filterList",S);for(filter in S){if(filter===C.Certs.FILTER_CACHE&&S[filter]&&l===C.WebForm.ACTION_SIGN){v=e(v);var P=[];for(var N in v)P.push(N);if(null!==v&&1===P.length)break}filter===C.Certs.FILTER_EXPIRE&&S[filter]&&(v=t(v)),filter===C.Certs.FILTER_OID&&S[filter].length>0&&(v=n(S[filter],v)),filter===C.Certs.FILTER_ISSUER&&S[filter].length>0&&(v=o(S[filter],v)),filter===C.Certs.FILTER_ISSUER_CN&&S[filter].length>0&&(v=i(S[filter],v)),filter===C.Certs.FILTER_ISSUER_HASH&&S[filter]&&(v=a(v))}var y=m.optionInfo.getParameter("SUBACTION");r===C.WebForm.ACTION_LOGIN&&l===C.WebForm.ACTION_CERT_CMP&&"update"==y&&(v=h(v)),v=d(v,m),v=E(v),v=c(v)}return INI_getPlatformInfo().Mobile&&(v=u(v)),_.Log.debug(T,"filterCertificates: action",r),_.Log.debug(T,"filterCertificates: succeeded",v),f(v)}catch(e){_.Log.error(T,"filterCertificates: failed",e),new s.Error.newThrow(e,"ERR_2007",v)}}var h=function(e){try{var t=e,r=p.Certs.FilterCertUpdate;if(void 0===r)return e;for(filter in r)filter===C.Certs.FILTER_UPDATE_OP_BANKCD&&r[filter].length>0&&(t=R(r[filter],t)),filter===C.Certs.FILTER_UPDATE_OP_REMAIN_DATE&&r[filter]&&(t=m(r[filter],t));return t}catch(t){_.Log.error(T,"filterCertUpdate: failed",t),new s.Error.newThrow(t,"ERR_2007",e)}};return{get_cert_key:l,filterCertificates:S}}(),A=function(){function e(e,t){try{t.getParameter("CONTENT_ENCODE")||t.setParameter("CONTENT_ENCODE",p.Signature.UrlEncodeCharSet),_.String.isNull(t.getParameter("RSA_PSS_SIGN"))&&t.setParameter("RSA_PSS_SIGN",p.Signature.SignatureAlg===C.Cipher.SIGN_PSS),_.String.isNull(t.getParameter("YESSIGN_TYPE"))&&t.setParameter("YESSIGN_TYPE",p.Signature.KftcSignFormat),_.String.isNull(t.getParameter("IN_VID"))&&t.setParameter("IN_VID",p.Signature.IncludeRandomSignFormat),_.String.isNull(t.getParameter("REMOVE_CONTENT"))&&t.setParameter("REMOVE_CONTENT",p.Signature.RemoveContentSignFormat),_.String.isNull(t.getParameter("USE_MULTISIGN_EXTAND_OPTION"))&&t.setParameter("USE_MULTISIGN_EXTAND_OPTION","FALSE"),_.String.isNull(t.getParameter("PDF_SIGN_TYPE"))&&t.setParameter("PDF_SIGN_TYPE","FALSE"),_.String.isNull(t.getParameter("REMOVE_TIME_STAMP"))&&t.setParameter("REMOVE_TIME_STAMP","FALSE"),_.String.isNull(t.getParameter("REMOVE_SIGNED_ATTRIBUTE"))&&t.setParameter("REMOVE_SIGNED_ATTRIBUTE","FALSE"),_.String.isNull(t.getParameter("BASE64_DEC"))&&t.setParameter("BASE64_DEC","FALSE")}catch(e){handleInfo.serviceInfo.getExceptionCallback()&&handleInfo.serviceInfo.getExceptionCallback()(handleInfo),INI_HANDLE.handleMessage(e)}}return{selectedSignature:function(r){if(e(r.serviceInfo.getAction(),r.optionInfo),E(r)){var n=function(e,n,o){function i(e){e&&(S.initialize(),S.setUpdateCertInfo(r,e)),n&&(n={});var t=r.serviceInfo.getCallback();void 0!=t&&(r.serviceInfo.getBehavior()==C.WebForm.ACTION_CERT_NOVIEWSIGN?t(!0,r.responseInfo.getParameter()):t())}if(r.serviceInfo.getAction()===C.WebForm.ACTION_LOGIN||r.serviceInfo.getAction()===C.WebForm.ACTION_SIGN)if(N.initialize(),r.serviceInfo.getDeviceId()==C.Certs.STORAGE_BROWSER){var s=r.serviceInfo.getDecryptedBrowserCert(),u=(s.INHERENT_A[C.Certs.ATTR_ISSUER]+"-"+s.INHERENT_A[C.Certs.ATTR_SERIAL]).replace(/ /gi,"_");N.setSelectedCert(r.serviceInfo.getDeviceId(),r.serviceInfo.getDeviceSub(),u,null,r.serviceInfo.getParameter("PWD"),s.OPEN_CERT)}else r.serviceInfo.getDeviceId()==C.Certs.STORAGE_SCARD||r.serviceInfo.getDeviceId()==C.Certs.STORAGE_SECURITY_DEVICE||r.serviceInfo.getDeviceId()==C.Certs.STORAGE_SECURITY_TOKEN?N.setSelectedCert(r.serviceInfo.getDeviceId(),r.serviceInfo.getDeviceSub(),r.serviceInfo.getParameter("CERT_ID"),null,r.serviceInfo.getParameter("PIN"),null):N.setSelectedCert(r.serviceInfo.getDeviceId(),r.serviceInfo.getDeviceSub(),r.serviceInfo.getParameter("CERT_ID"),null,r.serviceInfo.getParameter("PWD"),null);var f=r.optionInfo.getParameter("SUBACTION");if(C.WebForm.ACTION_CERT_CMP===r.serviceInfo.getBehavior()||"update"===f||"revoke"===f)if(r.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER){var d={};d.certificate=n.certificate,d.privateKey=n.privateKey,n.kmCertificate&&(d.kmCertificate=n.kmCertificate),n.kmPrivateKey&&(d.kmPrivateKey=n.kmPrivateKey),i(d)}else if(r.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_TOKEN)try{var E=t.IniResponse.getResSignature(e),g={};g.certificate="undefined"!==E.VID_CERTIFICATE&&void 0!==E.VID_CERTIFICATE?E.VID_CERTIFICATE:o.VID_CERTIFICATE,function(e){e&&(S.initialize(),S.setUpdateCertInfo(r,e));var t=r.serviceInfo.getCallback();void 0!=t&&t()}(g)}catch(e){r.serviceInfo.getExceptionCallback()&&r.serviceInfo.getExceptionCallback()(r),INI_HANDLE.handleMessage(e)}else l(r,function(e){try{var n=t.IniResponse.getResLoadCertificate(e),o={};o.privateKey=n.PRIVATE_KEY,o.certificate=n.CERT,o.kmPrivateKey=n.KM_PRIVATE_KEY,o.kmCertificate=n.KM_CERT,i(o)}catch(e){r.serviceInfo.getExceptionCallback()&&r.serviceInfo.getExceptionCallback()(r),INI_HANDLE.handleMessage(e)}},void 0,t.IniRequest.getReqLoadCertificate);else if(r.serviceInfo.getAction()===C.WebForm.ACTION_LOGIN||r.serviceInfo.getAction()===C.WebForm.ACTION_SIGN)if("Y"==p.OpenStorage.USE&&r.serviceInfo.getDeviceId()==C.Certs.STORAGE_BROWSER){var I=s.OPEN_CERT.source,v=r.serviceInfo.getParameter("PWD"),R=s.INHERENT_A[C.Certs.ATTR_ISSUER];if(_.Log.debug("issure:",R),_.Log.debug("source:",I),"LOCAL"===I&&"yessign"===R){var m={};m.privateKey=n.privateKey,m.certificate=n.certificate;var T=c.getOpenstorageObject(),h=a.Factory.PriKey.makeP12CertPri(m,v);T?(_.Log.debug("Local cert set to Opencert"),T.set(h,s.OPEN_CERT,v,"tray").then(function(){i()}).catch(function(e){_.Log.error("Opencert Set Error",e),r.serviceInfo.getExceptionCallback()&&r.serviceInfo.getExceptionCallback()(e)})):(_.Log.debug("Opencert Set not operate because Opencert object Empty"),i())}else _.Log.debug("Opencert Set not operate because Select Cert Status is not Local"),i()}else _.Log.debug("Opencert Set not operate because not Use Openstorage"),i();else _.Log.debug("finalExcute"),i()};if(r.serviceInfo.getDeviceId()==C.Certs.STORAGE_USIM&&1==p.Login.SMARTCertificationMode)return r.responseInfo.setParameter("SIGNATURE","SMARTCertificationSelected"),void n(null,null,null);var i,s=function(e,o){var i={};i=r.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER?e:t.IniResponse.getResSignature(e,g);for(key in i){var s=i[key].replace(/\r+/g,"");s=s.replace("-----BEGIN PKCS7-----",""),s=s.replace("-----END PKCS7-----",""),r.responseInfo.setParameter(key,s)}var c,u;r.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER?(c=r.serviceInfo.getDecryptedBrowserCert(),u=c.INHERENT_A):I&&(c=I[r.serviceInfo.getParameter("CERT_ID")],u=a.Factory.Certs.certificateDetail(c)),u&&u.ISSUER_O&&r.responseInfo.setParameter("ISSUER_O",u.ISSUER_O),n(e,o,i)},u="",f="",d="",v="",R="",m=o.selectedSignature,T=function(e,t){if(h(e,t),r.requestInfo.getParameter("MULTI_INDEX")==y.length){r.responseInfo.setParameter("SIGNATURE",u),r.responseInfo.setParameter("VID_RANDOM",f),r.responseInfo.setParameter("KISA_VID",d),r.responseInfo.setParameter("VID_CERTIFICATE",v),r.responseInfo.setParameter("PKCS1_SIGNATURE",R);var o,i;r.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER?(o=r.serviceInfo.getDecryptedBrowserCert(),i=o.INHERENT_A):I&&(o=I[r.serviceInfo.getParameter("CERT_ID")],i=a.Factory.Certs.certificateDetail(o)),i&&i.ISSUER_O&&r.responseInfo.setParameter("ISSUER_O",i.ISSUER_O),GINI_LoadingIndicatorStop(),n(e,t)}},h=function(e,n){var o={};o=r.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER?e:t.IniResponse.getResSignature(e,g);for(key in o){var a=o[key].replace(/\r+/g,"");a=a.replace("-----BEGIN PKCS7-----",""),a=a.replace("-----END PKCS7-----","");var s=function(e,t,r){var n="";return e===key&&(""!==t&&(n+=p.Signature.MultiDelimiter),n+=r.trim()),n};u+=s("SIGNATURE",u,a),f+=s("VID_RANDOM",f,a),d+=s("KISA_VID",d,a),v+=s("VID_CERTIFICATE",v,a),R+=s("PKCS1_SIGNATURE",R,a),r.responseInfo.setParameter(key,a)}var c=r.requestInfo.getParameter("MULTI_INDEX");c<y.length-1?(i=h,l(r,i,m,t.IniRequest.getReqSignature)):c==y.length-1&&(i=T,l(r,i,m,t.IniRequest.getReqSignature))},P=r.requestInfo.getParameter("ORG_DATA"),y=P.split(p.Signature.MultiDelimiter);y.push(P),r.serviceInfo.getBehavior()!=C.WebForm.ACTION_CERT_NOVIEWSIGN&&GINI_LoadingIndicatorStart("Progressing"),y.length>2?(r.requestInfo.setParameter("MULTI_SIGN","TRUE"),r.requestInfo.setParameter("MULTI_INDEX",0),r.requestInfo.setParameter("MULTI_ORG_DATA",y),i=h,l(r,i,m,t.IniRequest.getReqSignature)):(i=s,l(r,i,m,t.IniRequest.getReqSignature))}},rebuildSignOption:e}}(),O=function(){function e(e){var t={};t.check=!1;try{var r=/[ã±-ãã-ã£ê°-í£]/,n=/[\ \{\}\[\]\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/gi,o=/[a-z]/,i=/[A-Z]/,a=/[0-9]/,c=/[\'\"\\|]/gi;_.String.isNull(e)?new s.Warn.newThrow(null,"WARN_1003"):r.test(e)?new s.Warn.newThrow(null,"WARN_1004"):c.test(e)&&new s.Warn.newThrow(null,"WARN_1056");for(var u=p.WebForm.PasswordLimit[C.WebForm.LIMIT_MIN_CHAR_TYPE].split(","),f=0;f<u.length;f++){var l=!0,d=u[f];d.indexOf("A")>-1&&!n.test(e)?l=!1:d.indexOf("N")>-1&&!o.test(e)&&!i.test(e)?l=!1:d.indexOf("S")>-1&&!a.test(e)&&(l=!1)}l||new s.Warn.newThrow(null,"WARN_1005",3,3);var E=1,g=1,I=1,v=0,R=0,m=e.split(""),T=m.length,S=p.WebForm.PasswordLimit[C.WebForm.LIMIT_MIN_LENGTH];T<S&&new s.Warn.newThrow(null,"WARN_1006",T,S);var h=p.WebForm.PasswordLimit[C.WebForm.LIMIT_MAX_LENGTH];h<T&&new s.Warn.newThrow(null,"WARN_1007",T,h),R=m[0].charCodeAt(0);for(var P=1;P<T;P++){v=m[P].charCodeAt(0);var N=v-R;if(0==N?(E++,g=1,I=1):1==N?(E=1,g++,I=1):(E=1,g=1,I=1),R=v,3==E||3==g||3==I)break}p.WebForm.PasswordLimit[C.WebForm.LIMIT_DENY_SAME_CHAR3]&&3==E&&new s.Warn.newThrow(null,"WARN_1008",E),p.WebForm.PasswordLimit[C.WebForm.LIMIT_DENY_SERIAL_CHAR3]&&(3!=g&&3!=I||new s.Warn.newThrow(null,"WARN_1009")),t.check=!0}catch(e){_.Log.error(e),t.message=e.message,t.check=!1,t.name=e.name,new s.Error.newThrow(e,"ERR_6003")}finally{return e=0,t}}var r=function(e){l(e,function(r){var n={};if(e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER){if(void 0!=Object.keys(r)[0]){var o=r[Object.keys(r)[0]].OID;C.System.LANGUAGE_ENG===p.System.Language&&(o="ENG_"+r[Object.keys(r)[0]].OID),void 0!=r[Object.keys(r)[0]].OID_NAME&&""!=r[Object.keys(r)[0]].OID_NAME&&null!=r[Object.keys(r)[0]].OID_NAME||(r[Object.keys(r)[0]].OID_NAME=m.pki.oids[o])}n=r,_.Log.debug("getCertAttributeList cert:",n)}else{var i=t.IniResponse.getResCertificateList(r);n=i.certAttrs,I=i.certPem}var a=y.filterCertificates(e.serviceInfo.getAction(),e.serviceInfo.getBehavior(),n,e.serialNo,e),s=[];for(var c in a)s.push(c);if(e.serviceInfo.setParameter("DrawCertCount",s.length),_.Log.debug("getCertAttributeList filter cert:",a),e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER&&"Y"==p.OpenStorage.USE){var u=[],f=[],l=[];for(cert in a){var d=a[cert];1==d.CLOUD?u.push(d):f.push(d)}l=u.concat(f),_.Log.debug("CLOUD_Sort_cert:",l),fiterAttr={};for(var E={},g=0;g<l.length;g++){var v=y.get_cert_key(l[g]);1==l[g].CLOUD&&l[g].fingerprint&&(v=l[g].fingerprint),"OPENCERT"===l[g].SOURCE&&l[g].fingerprint&&(v=l[g].fingerprint),E[v]=l[g]}a=E,_.Log.debug("Sort_cert:",a),e.serviceInfo.getCallback()(a,e)}else e.serviceInfo.getCallback()(a,e)},o.getCertAttributeList,t.IniRequest.getReqCertificateList)},n=function(e,t){if(t)o.getCertificateInfo(e,function(t){e.serviceInfo.getCallback()(t)});else{var r=function(e,t){var r,n;if(I)n=I[e.serviceInfo.getParameter("CERT_ID")];else{n=S.getUpdateCertInfo().certificate}r=e.optionInfo.getParameter("CERT_VIEW_TYPE")==C.Certs.CERTIFICATE_DETAIL_ATTR?a.Factory.Certs.certificateDetail(n):a.Factory.Certs.parseCertAttributes(n),t(r)};l(e,function(t){e.serviceInfo.getCallback()(t,e.serviceInfo.getParameter("INI_Modal_Id"),e.serviceInfo.getParameter("INI_Is_DetailView"))},"CMP"===e.serviceInfo._action&&"REVOKE"===e.serviceInfo._behavior?r:o.getCertificateInfo,r,!0)}},u=function(e,t){var r=function(e,t){var r,n;if(I)n=I[e.serviceInfo.getParameter("CERT_ID")];else{n=S.getUpdateCertInfo().certificate}r=a.Factory.Certs.certificateDetail(n),t(r)};l(e,function(e){var r="OWCI_Serial="+e.SERIAL_INT+"&OWCI_SubjectDN="+e.SUBJECT_DN;t(r)},o.getCertificateInfo,r,!0)},f=function(){return N.getSelectedCert()},d=function(e,t,r,n,o,i){return N.setSelectedCert(e,t,r,n,o,i)},E=function(){return S.getUpdateCertInfo()},g=function(e){var t=S.getUpdateCertInfo(),r=t.fingerprint,n=t.ep.epText;_.Log.debug("Fingerprint:",r);var o=[],i=c.getOpenstorageObject();i.merge(o,e).then(function(){_.Log.debug("merge sucess"),i.get(r,n).then(function(e){return S.getUpdateCertInfo()})})},v=function(e){sessionStorage.removeItem(e)},R=function(e){return N.initialize(e)},T=function(e,t){var r=e.split("|"),n=[];for(i=0;i<r.length;i++){if(void 0===r[i])throw _.Log.error("Please try again in a few seconds.[#6]"),new Error("Please try again in a few seconds.[#6]");var o=r[i].substring(9,r[i].length);n.push(o)}sessionStorage.setItem("FILTER_ISSUER_DN",JSON.stringify(n)),"function"==typeof t&&t()},h=function(e,t){for(var r=e.split("|"),n=[],o=0,i=r.length;o<i;o++){var a=p.Certs.OID_Alias[r[o]];if(void 0!==a&&""!==a)for(var s=a.split("|"),c=0,u=s.length;c<u;c++)n.push(s[c])}sessionStorage.setItem("FILTER_OID",JSON.stringify(n)),"function"==typeof t&&t()},P=function(e,t){var r=e.split("|");sessionStorage.setItem("FILTER_OID",JSON.stringify(r)),"function"==typeof t&&t()},O=function(e,t){var r=e.split("|"),n=[];for(i=0;i<r.length;i++){var o=r[i].substring(13,r[i].length);n.push(o)}sessionStorage.setItem("FILTER_SERIALNO",JSON.stringify(n)),"function"==typeof t&&t()},b=function(e,t){var r=e.split("|");sessionStorage.setItem("FILTER_OU",JSON.stringify(r)),"function"==typeof t&&t()};return{getSelectedCertInfo:f,setSelectedCertInfo:d,getSelectedReNewCertInfo:E,getCertAttributeList:r,getCertificateInfo:n,getOverRetryCertInfo:u,checkComplexPassword:e,initCertInfo:R,removeStorageItem:v,setIssuerDNFilterInfo:T,setOIDAliasFilterInfo:h,setOIDFilterInfo:P,setSerialNoFilterInfo:O,isYessSignWebCert:function(e){return new Promise(function(t,r){e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER?o.getCertificate(e).then(function(e){t(a.Factory.Certs.isYessSignWebCert(e))}):t(!1)})},getSelectedOpencertInfo:g,setOUFilterInfo:b,getCertificate:function(e){return new Promise(function(t,r){e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER?o.getCertificateWithCache(e).then(function(e){t(e)}):t(void 0)})},checkPassword:function(e,r){return new Promise(function(n,i){function s(e){e&&(e=decodeURIComponent(e),e=e.replace(/\+/g," "),e=JSON.parse(e),e.EXTERNAL&&"NOT_SUPPORT"===e.EXTERNAL?INI_HANDLE.infoMessage("This service is not supported."):e.EXTERNAL&&"NOT_INSTALL"===e.EXTERNAL?GINI_3rd_Party_Control.extensionPKI.showInstallPage():(decodeURIComponent(e.PARAMS.STATE),GINI_StandbyCallBack.getCallback(e.TRANS_SEQ)(e)))}function c(e){n((void 0!==e||null!==e||null!==e.PARAMS||void 0!==e.PARAMS)&&"SUCCEEDED"===e.PARAMS.STATE)}var u=e.serviceInfo.getDeviceId();if(GINI_ProtectMgr.keep("NONCE",r),u===C.Certs.STORAGE_BROWSER)o.checkPassword(e).then(function(e){n(e)}).catch(function(t){e.serviceInfo.getExceptionCallback()?e.serviceInfo.getExceptionCallback()(t):INI_HANDLE.handleMessage(t)});else if(u===C.Certs.STORAGE_HDD||u===C.Certs.STORAGE_USB){var f=cwui_core.handleManager.newHandleInfo();A.rebuildSignOption(C.WebForm.ACTION_LOGIN,f.optionInfo),f.serviceInfo.setDeviceSub(e.serviceInfo.getDeviceSub()),f.serviceInfo.setDeviceId(u),f.serviceInfo.setParameter("CERT_ID",e.serviceInfo.getParameter("CERT_ID")),f.serviceInfo.setParameter("PWD",e.serviceInfo.getParameter("PWD")),f.serviceInfo.setAction(C.WebForm.ACTION_SIGN),f.optionInfo.setParameter("SIGN_KIND",C.Signature.SIGN_PKCS7),f.optionInfo.setParameter("SHOW_PLAIN_TEXT","FALSE"),f.requestInfo.setParameter("ORG_DATA",_.String.dateTimeToString(new Date)),f.optionInfo.setParameter("IN_VID",!1);var l=p.System.UrlAddress[C.System.URL_SYNCHRONISE_TIME];if(l){var d=function(e){function t(){var n=_.Transfer.xmlHttpRequest(e,"");return _.Log.debug("["+r+"]Server Time : "+n),r<5?!n||n.trim().length<5?(r++,t()):n:(_.Log.debug("["+r+"]Server Time Fail : "+n),(new Date).getTime()/1e3)}var r=0;return t()}(l);if(d.match("rawstime://")){var E=d.split("rawstime://");if(E.length>=2){var g=a.Factory.Util.decode64(E[1]),I=g.split("_");I.length>=2?(f.optionInfo.setParameter("REPLAY_ATTACK_CHECK_ORG_DATA",d),d=I[0],f.optionInfo.setParameter("REPLAY_ATTACK_CHECK_DATA",I[1])):d=g,f.optionInfo.setParameter("SERVER_TIME",d)}else f.optionInfo.setParameter("SERVER_TIME",_.String.dateTimeToString(new Date))}}else f.optionInfo.setParameter("SERVER_TIME",_.String.dateTimeToString(new Date));var v=a.Factory.Util.bytesToHex(a.Factory.Util.getRandomBytesSync(16)),R=t.IniRequest.getReqSignature(f,v);GINI_StandbyCallBack.setCallback(v,c),GINI_StandbyCallBack.setExceptionCallback(v,e.serviceInfo.getExceptionCallback()),R.GET_RESULT="FALSE",INIWEBEX.requestCmd({params:encodeURIComponent(JSON.stringify(R)),processCallback:s})}else n(!0)})},getSubjectDNWithPem:function(e,t){return new Promise(function(t,r){t(a.Factory.Certs.parseCertAttributes(e).SUBJECT_DN)}).catch(function(e){INI_HANDLE.handleMessage(e)})}}}(),b=function(){var e=function(e){l(e,function(e){},void 0,t.IniRequest.getReqSetProperty)},r=function(e){l(e,function(r){var n=t.IniResponse.getResPublicKey(r);e.serviceInfo.getCallback()(n)},void 0,t.IniRequest.getReqPublicKeyE2E)};return{getExteralVersion:function(e){var r=sessionStorage.getItem("CWEX_VERSION"),n=function(r){if(g){var n=function(){g.isComplete?e.serviceInfo.getCallback()(r):setTimeout(function(){n()},100)};n()}else p.System.EncryptedPacketMode&&GINI_supportEncryptHtml5()?(g={},g.isComplete=!1,l(e,function(n){g.publicKey=t.IniResponse.getResPublicKey(n),g.sessionSeed=f(32),g.isComplete=!0,e.serviceInfo.getCallback()(r)},void 0,t.IniRequest.getReqPublicKey)):e.serviceInfo.getCallback()(r)};null!==r&&"NOT_INSTALL"!==r?n(r):l(e,function(r,o){var i="NOT_INSTALL";if(o)e.serviceInfo.getCallback()(i,o);else{var a=t.IniResponse.getResVersion(r);for(var s in a){var c=a[s];if("1"===c.TYPE){i=decodeURIComponent(c.VERSION);break}}"NOT_INSTALL"!=i&&n(i)}sessionStorage.setItem("CWEX_VERSION",i)},void 0,t.IniRequest.getReqVersion)},getDeviceList:function(e){l(e,function(r){var n=t.IniResponse.getResDeviceList(r),o=[],a=e.serviceInfo.getParameter("subListFilters");for(storage in n){var s=n[storage],c=decodeURIComponent(s.DEVICE_ID),u=decodeURIComponent(s.DEVICE_SUB);void 0!==a&&a&&a[c]?void 0!==a[c][u]&&a[c][u]&&null!=a[c][u]&&!a[C.Certs.STORAGE_PHONE]||(u===C.Certs.STORAGE_PHONE_MOBISIGN?e.serviceInfo.getAction()!==C.WebForm.ACTION_LOGIN&&e.serviceInfo.getAction()!==C.WebForm.ACTION_SIGN||o.push(s):o.push(s)):u===C.Certs.STORAGE_PHONE_MOBISIGN?e.serviceInfo.getAction()!==C.WebForm.ACTION_LOGIN&&e.serviceInfo.getAction()!==C.WebForm.ACTION_SIGN||o.push(s):o.push(s)}if(C.Certs.STORAGE_PHONE===c&&o.length>0){var f=p.SubMediaControl.SubMediaMobilePosition;if(f){var l=[];for(i in o){var d=f.indexOf(o[i].DEVICE_SUB);d>=0&&(l[d]=o[i])}o=l}}e.serviceInfo.getCallback()(o,e.serviceInfo.getParameter("TargetParentNode")),GINI_LoadingIndicatorStop()},void 0,t.IniRequest.getReqDeviceList)},setProperties:e,gatterPCInfo:function(e){l(e,function(t){e.serviceInfo.getCallback()(t)},void 0,t.IniRequest.getReqGatterPCInfo)},getPCInfo:function(e){l(e,function(t){e.serviceInfo.getCallback()(t)},void 0,t.IniRequest.getReqGetPCInfo)},getE2EPublicKey:r,OpenCertClose:function(e){o.OpenCertClose(e)}}}(),D=function(){var e=function(e,r){if(E(e))try{l(e,function(t){r&&r(),e.serviceInfo.getCallback()(e),0!=e.optionInfo.getParameter("USE_SESSION")||INI_getPlatformInfo().Mobile||GINI_ProtectMgr.destroy()},o.savePrivateCertificate,t.IniRequest.getReqSaveCertificate)}catch(t){throw e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),t}},r=function(e,r){E(e);try{e.serviceInfo.getDeviceId(),C.Certs.STORAGE_SECURITY_TOKEN,e.serviceInfo.getParameter("TARGET_DEVICE_ID")===C.Certs.STORAGE_SECURITY_TOKEN&&e.serviceInfo.setParameter("PWD_CNF",e.serviceInfo.getParameter("PWD")),e.serviceInfo.setEventDeviceId(e.serviceInfo.getParameter("TARGET_DEVICE_ID")),e.serviceInfo.setDeviceSub(e.serviceInfo.getParameter("TARGET_DEVICE_SUB_ID")),l(e,function(t){r&&r(),e.serviceInfo.getCallback()(e),0!=e.optionInfo.getParameter("USE_SESSION")||INI_getPlatformInfo().Mobile||GINI_ProtectMgr.destroy()},o.savePrivateCertificate,t.IniRequest.getReqSaveCertificate)}catch(t){throw e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),t}},n=function(e){if(E(e))try{var r=e.serviceInfo.getParameter("ENC_P12_CERT");if(e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER){_.Log.debug("PKCS#12 : "+r);var n=a.Factory.PriKey.extractP12PriCert(r,"NONCE");_.Log.debug("Private key : "+n.privateKey),_.Log.debug("Certificate : "+n.certificate),_.Log.debug("KMPrivate key : "+n.KMprivateKey),_.Log.debug("KMCertificate : "+n.KMcertificate),e.serviceInfo.setParameter("PRIVATE_KEY",n.privateKey),e.serviceInfo.setParameter("CERTIFICATE",n.certificate),n.KMprivateKey&&e.serviceInfo.setParameter("KM_PRIVATE_KEY",n.KMprivateKey),n.KMcertificate&&e.serviceInfo.setParameter("KM_CERTIFICATE",n.KMcertificate),D.savePrivateCertificate(e)}else{var o=function(t){e.serviceInfo.getCallback()(e)},i=a.Factory.Util.bytesToHex(a.Factory.Util.getRandomBytesSync(16)),s=t.IniRequest.getReqSaveCertificate12(e,i);GINI_StandbyCallBack.setCallback(i,o),GINI_StandbyCallBack.setExceptionCallback(i,e.serviceInfo.getExceptionCallback()),s.GET_RESULT="FALSE",INIWEBEX.requestCmd({params:encodeURIComponent(JSON.stringify(s)),processCallback:"GINI_External_Response_Factory.proc"})}}catch(t){throw e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),t}},i=function(e){try{E(e),o.savePrivateCertificate(e,e.serviceInfo.getCallback(),"NONCE")}catch(t){throw e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),t}},s=function(e){e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_TOKEN&&E(e),l(e,function(t){e.serviceInfo.getCallback()&&e.serviceInfo.getCallback()(t)},o.removeCertificate,t.IniRequest.getReqDeleteCertificate)},u=function(e){try{E(e)&&l(e,function(t){e.serviceInfo.getCallback()(t),GINI_ProtectMgr.destroy()},o.changePassword,t.IniRequest.getReqChangeCertificate)}catch(t){throw e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),t}},f=function(e){E(e)&&l(e,function(r){try{e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER?(e.serviceInfo.setParameter("CERTIFICATE",r.certificate),e.serviceInfo.setParameter("KM_CERTIFICATE",r.kmCertificate),e.serviceInfo.setParameter("PRIVATE_KEY",r.privateKey),e.serviceInfo.setParameter("KM_PRIVATE_KEY",r.kmPrivateKey),l(e,e.serviceInfo.getCallback(),null,t.IniRequest.getReqExportCertificate)):e.serviceInfo.getCallback()(r),GINI_ProtectMgr.destroy()}catch(t){e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),INI_HANDLE.handleMessage(t)}},o.exportCertPriP12File,t.IniRequest.getReqExportCertificate)};return{changePassword:u,removeCertificate:s,savePrivateCertificate:e,saveAnotherCertificate:r,saveP12Certificate:n,saveCertPriV11:i,exportCertPriP12:function(e){function r(e){var t=document.createElement("a");t.download=e.fileName+".p12",t.setAttribute("download",e.fileName+".p12"),t.setAttribute("href","data:application/x-pkcs12;base64,"+e.p12b64),t.style.display="none",t.appendChild(document.createTextNode("Download")),document.body.appendChild(t),t.click()}E(e),l(e,function(n){try{if(e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER)r(n);else{var o=t.IniResponse.getResLoadCertificate(n),i={};i.privateKey=o.PRIVATE_KEY,i.certificate=o.CERT,i.kmPrivateKey=o.KM_PRIVATE_KEY,i.kmCertificate=o.KM_CERT;var s=a.Factory.PriKey.rebuildCertPriP12(i,"NONCE"),c=a.Factory.PriKey.extractP12Cert(s);c=a.Factory.Certs.parseCertAttributes(c);var u={};u.fileName=c.SUBJECT,u.p12b64=s,r(u)}e.serviceInfo.getCallback()(n),GINI_ProtectMgr.destroy()}catch(e){INI_HANDLE.handleMessage(e)}},o.exportCertPriP12,t.IniRequest.getReqLoadCertificate)},exportCertPriP12File:f,issueCertificate:function(e,t){return t?d(e):E(e)},reIssueCertificate:function(e){return E(e)},updateCertificate:function(e){return new Promise(function(r,n){if(e.serviceInfo.getEventDeviceId()===C.Certs.STORAGE_SECURITY_TOKEN)E(e),l(e,function(t){e.serviceInfo.getCallback()(t)},void 0,t.IniRequest.getReqUpdateCertificate);else if(E(e))if(e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER){var i=e.serviceInfo.getBehavior(),a=e.serviceInfo.getAction();C.WebForm.ACTION_CERT_UPDATE==i&&C.WebForm.ACTION_CERT_CMP==a&&o.checkPassword(e).then(function(e){r(e)})}else r(!0);else r(!1)})},revokeCertificate:function(e){e.serviceInfo.getDeviceId()===C.Certs.STORAGE_SECURITY_TOKEN&&E(e),l(e,function(t){e.serviceInfo.getCallback()(t)},o.revokeCertificate,t.IniRequest.getReqRevokeCertificate)},copyCertificate:function(e){if(E(e)){var r;r=e.serviceInfo.getParameter("TARGET_DEVICE_ID")===C.Certs.STORAGE_BROWSER?t.IniRequest.getReqLoadCertificate:t.IniRequest.getReqCopyCertificate,l(e,function(r){try{var n=e.serviceInfo.getAction(),i=e.serviceInfo.getBehavior(),s=e.serviceInfo.getParameter("PWD"),u=e.serviceInfo.getParameter("keyStrokeList"),f=e.serviceInfo.getParameter("SEL_KEYSTROKE_TYPE");if(u&&"KEYBOARD"===f){var l=u.KEYBOARD;l&&l.KEYPAD_NAME===C.KeyStrokeSecurity.KEYPAD_NAME.AHNLAB_KEY&&(s=a.Factory.Util.decode64(decodeURIComponent(r.PARAMS.NONCE)),e.serviceInfo.setParameter("PWD",s))}if(e.serviceInfo.getParameter("TARGET_DEVICE_ID")===C.Certs.STORAGE_BROWSER&&"MANAGE"===n&&"COPY"===i&&"Y"===p.OpenStorage.USE&&e.serviceInfo.getParameter("SOURCE_DEVICE_ID")===C.Certs.STORAGE_BROWSER||n==C.WebForm.ACTION_CERT_EXPORT_CLOUD){var d=e.serviceInfo.getDecryptedBrowserCert(),E=d.OPEN_CERT.source,g=d.INHERENT_A[C.Certs.ATTR_ISSUER];_.Log.debug("issure:",g);var I=sessionStorage.getItem("cloud_cert");if("false"===I&&"LOCAL"===E){var v={};v.privateKey=r.privateKey,v.certificate=r.certificate;var R=c.getOpenstorageObject(),m=a.Factory.PriKey.makeP12CertPri(v,s);R&&(_.Log.debug("Local cert set to Opencert"),R.set(m,d.OPEN_CERT,s,"window").then(function(t){_.Log.debug("Local Cert set sucess"),_.Log.debug("cloud status:",t.status.cloud),t&&t.status&&t.status.cloud&&("cancel"==t.status.cloud||"off"==t.status.cloud?(_.Log.debug("copyCertificate cancel"),sessionStorage.setItem("OPENCERT",!1)):sessionStorage.setItem("OPENCERT",!0));var r=e.serviceInfo.getCallback();void 0!=r&&r(t&&t.status.cloud)}).catch(function(t){_.Log.error("Local Cert set to opencert Error",t),e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(t)}))}else if("true"===I)e.serviceInfo.setParameter("CERTIFICATE",r.certificate),e.serviceInfo.setParameter("PRIVATE_KEY",r.privateKey),e.serviceInfo.setParameter("KM_CERTIFICATE",r.kmcertificate),e.serviceInfo.setParameter("KM_PRIVATE_KEY",r.kmprivateKey),sessionStorage.setItem("OPENCERT",!1),o.savePrivateCertificate(e,function(t){var r=e.serviceInfo.getCallback();void 0!=r&&r(t&&t.status.cloud)},"NONCE");else{var T=e.serviceInfo.getCallback();void 0!=T&&T()}}else if(n==C.WebForm.ACTION_CERT_IMPORT_CLOUD)e.serviceInfo.setParameter("CERTIFICATE",r.certificate),e.serviceInfo.setParameter("PRIVATE_KEY",r.privateKey),e.serviceInfo.setParameter("KM_CERTIFICATE",r.kmcertificate),e.serviceInfo.setParameter("KM_PRIVATE_KEY",r.kmprivateKey),sessionStorage.setItem("OPENCERT",!1),o.savePrivateCertificate(e,function(t){var r=e.serviceInfo.getCallback();void 0!=r&&r(t&&t.status.cloud)},"NONCE");else if(e.serviceInfo.getParameter("TARGET_DEVICE_ID")===C.Certs.STORAGE_BROWSER){var S=t.IniResponse.getResLoadCertificate(r);e.serviceInfo.setParameter("CERTIFICATE",S.CERT),e.serviceInfo.setParameter("PRIVATE_KEY",S.PRIVATE_KEY),e.serviceInfo.setParameter("KM_CERTIFICATE",S.KM_CERT),e.serviceInfo.setParameter("KM_PRIVATE_KEY",S.KM_PRIVATE_KEY),r.PARAMS.NONCE&&GINI_ProtectMgr.keepx("NONCE",a.Factory.Util.decode64(decodeURIComponent(r.PARAMS.NONCE))),o.savePrivateCertificate(e,function(t){var r=e.serviceInfo.getCallback();void 0!=r&&r(t&&t.status.cloud)},"NONCE")}else e.serviceInfo.getCallback()()}catch(t){e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),INI_HANDLE.handleMessage(t)}finally{GINI_ProtectMgr.destroy()}},o.copyCertificateInfo,r)}},makeExportData:function(e){E(e)&&l(e,function(r){try{if(e.serviceInfo.getDeviceId()===C.Certs.STORAGE_BROWSER)e.serviceInfo.getCallback()(r.p12b64);else{var n=t.IniResponse.getResLoadCertificate(r),o={};o.privateKey=n.PRIVATE_KEY,o.certificate=n.CERT,o.kmPrivateKey=n.KM_PRIVATE_KEY,o.kmCertificate=n.KM_CERT,r.PARAMS.NONCE&&GINI_ProtectMgr.keepx("NONCE",a.Factory.Util.decode64(decodeURIComponent(r.PARAMS.NONCE)));var i=a.Factory.PriKey.rebuildCertPriP12(o,"NONCE");GINI_ProtectMgr.destroy("NONCE"),e.serviceInfo.destroy("PWD"),e.serviceInfo.getCallback()(i)}}catch(t){e.serviceInfo.getExceptionCallback()&&e.serviceInfo.getExceptionCallback()(e),INI_HANDLE.handleMessage(t)}},o.exportCertPriP12,t.IniRequest.getReqLoadCertificate)},openStorageSet:function(e,t){o.openStorageSet(e,t)}}}();return{Signature:A,Certs:O,Manager:D,Configure:b}}.apply(t,o))&&(e.exports=a)}).call(t,r(0))},70:function(e,t,r){var n,o;n=[r(8),r(10)],void 0!==(o=function(e,t){var r=[],n=[];return function(){try{for(caCert in window.realCA){var o=window.realCA[caCert];for(cert in o){var i=e.Factory.Certs.certificateFromPem(o[cert]);r.push(i)}}for(caCert in window.testCA){var o=window.testCA[caCert];for(cert in o){var i=e.Factory.Certs.certificateFromPem(o[cert]);n.push(i)}}}catch(e){new t.Error.newThrow(e,"ERR_1007")}}(),{SCert:SCert,realCaCerts:r,testCaCerts:n}}.apply(t,n))&&(e.exports=o)},8:function(e,t,r){var n,o;n=[r(25)],void 0!==(o=function(e){function t(e,t,r){return o.Cipher.symmetricEncrypt(s.Cipher.SYMM_AES_CBC,e,t,r)}function r(e,t,r){return o.Cipher.symmetricDecrypt(s.Cipher.SYMM_AES_CBC,e,t,r)}function n(e,t){var r="";a.String.isNull(e)||(r+=o.Cipher.doDigest(s.Cipher.HASH_SHA256,e));for(var n=0;n<7;n++)a.String.isNull(t)||(r+=o.Cipher.doDigest(s.Cipher.HASH_SHA256,t)),r=o.Cipher.doDigest(s.Cipher.HASH_SHA512,r);return r}var o,i=cwui_conf.defaultConf,a=cwui_conf.utils,s=cwui_conf.constants;return s.System.CRYPTO_TYPE_INITECH,i.System.Core,o=e,{Factory:o,integrityEncrypt:function(e,r,o){var i=n(r,o);return t(i.slice(0,32),i.slice(32,64),e)},integrityDecrypt:function(e,t,o){var i=n(t,o);return r(i.slice(0,32),i.slice(32,64),e)}}}.apply(t,n))&&(e.exports=o)}})});